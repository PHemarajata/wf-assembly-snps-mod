Unable to find image 'staphb/snippy:4.6.0' locally
4.6.0: Pulling from staphb/snippy
423ae2b273f4: Pulling fs layer
de83a2304fa1: Pulling fs layer
f9a83bce3af0: Pulling fs layer
b6b53be908de: Pulling fs layer
1175f7dbfb8b: Pulling fs layer
f94ceef5c05d: Pulling fs layer
b6b53be908de: Waiting
f94ceef5c05d: Waiting
1175f7dbfb8b: Waiting
f9a83bce3af0: Verifying Checksum
f9a83bce3af0: Download complete
de83a2304fa1: Verifying Checksum
423ae2b273f4: Verifying Checksum
423ae2b273f4: Download complete
423ae2b273f4: Pull complete
de83a2304fa1: Pull complete
f9a83bce3af0: Pull complete
b6b53be908de: Verifying Checksum
b6b53be908de: Download complete
b6b53be908de: Pull complete
f94ceef5c05d: Verifying Checksum
f94ceef5c05d: Download complete
1175f7dbfb8b: Verifying Checksum
1175f7dbfb8b: Download complete
1175f7dbfb8b: Pull complete
f94ceef5c05d: Pull complete
Digest: sha256:6a9db00665caa081d9ba4da13aca8ab9568814ebb98f1a0d66bff93e740b0ab4
Status: Image is up to date for staphb/snippy:4.6.0
/home/cdcadmin/wf-assembly-snps-mod/work/3f/decd4a6f8e5f61daed0fc8bd5f2633/.command.sh: line 87: warning: here-document at line 2 delimited by end-of-file (wanted `EOF')
[05:39:39] This is snippy 4.6.0
[05:39:39] Written by Torsten Seemann
[05:39:39] Obtained from https://github.com/tseemann/snippy
[05:39:39] Detected operating system: linux
[05:39:39] Enabling bundled linux tools.
[05:39:39] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:39:39] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:39:39] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:39:39] Found java - /usr/bin/java
[05:39:39] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:39:39] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:39:39] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:39:39] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:39:39] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:39:39] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:39:39] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:39:39] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:39:39] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:39:39] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:39:39] Found gzip - /bin/gzip
[05:39:39] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:39:39] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:39:39] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:39:39] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:39:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:39:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:39:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:39:39] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:39:39] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:39:39] Treating reference as 'fasta' format.
[05:39:39] Will use 16 CPU cores.
[05:39:39] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/9f/3d95f3d92e971278d315e4dd354996/inputfiles/IE-0003_S8_L001-SPAdes.fasta
[05:39:39] Creating folder: snippy_work/IE-0003_S8_L001-SPAdes
[05:39:39] Changing working directory: snippy_work/IE-0003_S8_L001-SPAdes
[05:39:39] Creating reference folder: reference
[05:39:39] Extracting FASTA and GFF from reference.
[05:39:39] Wrote 205 sequences to ref.fa
[05:39:39] Wrote 0 features to ref.gff
[05:39:39] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/9f/3d95f3d92e971278d315e4dd354996/inputfiles/IE-0003_S8_L001-SPAdes.fasta into pseudo-reads
[05:39:43] Wrote 569784 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:39:43] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:39:43] Using BAM RG (Read Group) ID: IE-0003_S8_L001-SPAdes
[05:39:43] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:39:43] Running: bwa index reference/ref.fa 2>> snps.log
[05:39:47] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:39:47] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:39:47] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:39:47] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:39:47] Running: bwa mem  -Y -M -R '@RG\tID:IE-0003_S8_L001-SPAdes\tSM:IE-0003_S8_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 569784 sequences (142446000 bp)...
[M::mem_process_seqs] Processed 569784 reads in 89.155 CPU sec, 5.758 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0003_S8_L001-SPAdes\tSM:IE-0003_S8_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq[samclip] Total SAM records 574828, removed 12460, allowed 8379, passed 562368

[main] Real time: 8.165 sec; CPU: 90.541 sec
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:39:57] Running: samtools index snps.bam 2>> snps.log
[05:39:57] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:39:57] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:40:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 113
          no. right trimmed                     : 1324
          no. left and right trimmed            : 91
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1528

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1528
       total no. variants observed              : 20448
       total no. reference observed             : 0

Time elapsed: 0.22s

[05:40:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:40:01] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:40:01] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:40:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:40:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:40:02] Running: bcftools consensus --sample IE-0003_S8_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:40:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:40:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:40:03] Running: bcftools consensus --sample IE-0003_S8_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:40:04] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:40:04] Running: rm -f fake_reads\.fq 2>> snps.log
[05:40:04] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:40:10] Marked 4543 heterozygous sites with 'n'
[05:40:10] Creating extra output files: BED GFF CSV TXT HTML
[05:40:11] Identified 20448 variants.
[05:40:11] Result folder: snippy_work/IE-0003_S8_L001-SPAdes
[05:40:11] Result files:
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.aligned.fa
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.bam
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.bam.bai
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.bed
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.consensus.fa
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.consensus.subs.fa
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.csv
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.filt.vcf
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.gff
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.html
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.log
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.raw.vcf
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.subs.vcf
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.tab
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.txt
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.vcf
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.vcf.gz
[05:40:11] * snippy_work/IE-0003_S8_L001-SPAdes/snps.vcf.gz.csi
[05:40:11] Walltime used: 32 seconds
[05:40:11] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[05:40:11] Done.
[05:40:11] This is snippy 4.6.0
[05:40:11] Written by Torsten Seemann
[05:40:11] Obtained from https://github.com/tseemann/snippy
[05:40:11] Detected operating system: linux
[05:40:11] Enabling bundled linux tools.
[05:40:11] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:40:11] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:40:11] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:40:11] Found java - /usr/bin/java
[05:40:11] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:40:11] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:40:11] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:40:11] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:40:11] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:40:11] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:40:11] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:40:11] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:40:11] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:40:11] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:40:11] Found gzip - /bin/gzip
[05:40:11] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:40:11] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:40:11] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:40:11] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:40:11] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:40:11] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:40:11] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:40:11] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:40:11] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:40:11] Treating reference as 'fasta' format.
[05:40:11] Will use 16 CPU cores.
[05:40:11] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/03/101f184375082e36b7d2debc399801/inputfiles/IE-0004_S9_L001-SPAdes.fasta
[05:40:11] Creating folder: snippy_work/IE-0004_S9_L001-SPAdes
[05:40:11] Changing working directory: snippy_work/IE-0004_S9_L001-SPAdes
[05:40:11] Creating reference folder: reference
[05:40:11] Extracting FASTA and GFF from reference.
[05:40:11] Wrote 205 sequences to ref.fa
[05:40:11] Wrote 0 features to ref.gff
[05:40:11] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/03/101f184375082e36b7d2debc399801/inputfiles/IE-0004_S9_L001-SPAdes.fasta into pseudo-reads
[05:40:15] Wrote 567802 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:40:15] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:40:15] Using BAM RG (Read Group) ID: IE-0004_S9_L001-SPAdes
[05:40:15] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:40:15] Running: bwa index reference/ref.fa 2>> snps.log
[05:40:18] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:40:18] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:40:18] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:40:18] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:40:18] Running: bwa mem  -Y -M -R '@RG\tID:IE-0004_S9_L001-SPAdes\tSM:IE-0004_S9_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 567802 sequences (141950500 bp)...
[M::mem_process_seqs] Processed 567802 reads in 75.378 CPU sec, 4.920 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0004_S9_L001-SPAdes\tSM:IE-0004_S9_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 7.213 sec; CPU: 76.679 sec
[samclip] Total SAM records 571447, removed 10210, allowed 6697, passed 561237
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:40:27] Running: samtools index snps.bam 2>> snps.log
[05:40:27] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:40:27] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:40:30] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 94
          no. right trimmed                     : 1087
          no. left and right trimmed            : 82
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1263

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1263
       total no. variants observed              : 15948
       total no. reference observed             : 0

Time elapsed: 0.17s

[05:40:31] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:40:31] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:40:31] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:40:31] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:40:31] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:40:31] Running: bcftools consensus --sample IE-0004_S9_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:40:32] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:40:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:40:33] Running: bcftools consensus --sample IE-0004_S9_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:40:34] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:40:34] Running: rm -f fake_reads\.fq 2>> snps.log
[05:40:34] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:40:40] Marked 3836 heterozygous sites with 'n'
[05:40:40] Creating extra output files: BED GFF CSV TXT HTML
[05:40:40] Identified 15948 variants.
[05:40:40] Result folder: snippy_work/IE-0004_S9_L001-SPAdes
[05:40:40] Result files:
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.aligned.fa
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.bam
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.bam.bai
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.bed
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.consensus.fa
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.consensus.subs.fa
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.csv
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.filt.vcf
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.gff
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.html
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.log
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.raw.vcf
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.subs.vcf
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.tab
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.txt
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.vcf
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.vcf.gz
[05:40:40] * snippy_work/IE-0004_S9_L001-SPAdes/snps.vcf.gz.csi
[05:40:40] Walltime used: 29 seconds
[05:40:40] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[05:40:40] Done.
[05:40:40] This is snippy 4.6.0
[05:40:40] Written by Torsten Seemann
[05:40:40] Obtained from https://github.com/tseemann/snippy
[05:40:40] Detected operating system: linux
[05:40:40] Enabling bundled linux tools.
[05:40:40] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:40:40] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:40:40] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:40:40] Found java - /usr/bin/java
[05:40:40] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:40:40] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:40:40] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:40:40] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:40:40] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:40:40] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:40:40] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:40:40] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:40:40] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:40:40] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:40:40] Found gzip - /bin/gzip
[05:40:40] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:40:40] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:40:40] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:40:40] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:40:40] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:40:40] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:40:40] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:40:40] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:40:40] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:40:40] Treating reference as 'fasta' format.
[05:40:40] Will use 16 CPU cores.
[05:40:40] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/86/4c885ce3e4f7a05195c36183deab89/inputfiles/IE-0005_S10_L001-SPAdes.fasta
[05:40:40] Creating folder: snippy_work/IE-0005_S10_L001-SPAdes
[05:40:40] Changing working directory: snippy_work/IE-0005_S10_L001-SPAdes
[05:40:40] Creating reference folder: reference
[05:40:40] Extracting FASTA and GFF from reference.
[05:40:41] Wrote 205 sequences to ref.fa
[05:40:41] Wrote 0 features to ref.gff
[05:40:41] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/86/4c885ce3e4f7a05195c36183deab89/inputfiles/IE-0005_S10_L001-SPAdes.fasta into pseudo-reads
[05:40:45] Wrote 576868 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:40:45] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:40:45] Using BAM RG (Read Group) ID: IE-0005_S10_L001-SPAdes
[05:40:45] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:40:45] Running: bwa index reference/ref.fa 2>> snps.log
[05:40:48] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:40:48] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:40:48] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:40:48] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:40:48] Running: bwa mem  -Y -M -R '@RG\tID:IE-0005_S10_L001-SPAdes\tSM:IE-0005_S10_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 576868 sequences (144217000 bp)...
[M::mem_process_seqs] Processed 576868 reads in 83.031 CPU sec, 5.452 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0005_S10_L001-SPAdes\tSM:IE-0005_S10_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq[samclip] Total SAM records 581094, removed 10832, allowed 7572, passed 570262

[main] Real time: 7.944 sec; CPU: 84.474 sec
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:40:58] Running: samtools index snps.bam 2>> snps.log
[05:40:58] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:40:58] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:41:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 98
          no. right trimmed                     : 1245
          no. left and right trimmed            : 83
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1426

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1426
       total no. variants observed              : 17968
       total no. reference observed             : 0

Time elapsed: 0.19s

[05:41:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:41:01] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:41:02] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:41:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:41:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:41:02] Running: bcftools consensus --sample IE-0005_S10_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:41:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:41:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:41:03] Running: bcftools consensus --sample IE-0005_S10_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:41:04] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:41:04] Running: rm -f fake_reads\.fq 2>> snps.log
[05:41:05] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:41:11] Marked 3788 heterozygous sites with 'n'
[05:41:11] Creating extra output files: BED GFF CSV TXT HTML
[05:41:11] Identified 17968 variants.
[05:41:11] Result folder: snippy_work/IE-0005_S10_L001-SPAdes
[05:41:11] Result files:
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.aligned.fa
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.bam
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.bam.bai
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.bed
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.consensus.fa
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.consensus.subs.fa
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.csv
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.filt.vcf
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.gff
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.html
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.log
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.raw.vcf
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.subs.vcf
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.tab
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.txt
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.vcf
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.vcf.gz
[05:41:11] * snippy_work/IE-0005_S10_L001-SPAdes/snps.vcf.gz.csi
[05:41:11] Walltime used: 31 seconds
[05:41:11] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[05:41:11] Done.
[05:41:11] This is snippy 4.6.0
[05:41:11] Written by Torsten Seemann
[05:41:11] Obtained from https://github.com/tseemann/snippy
[05:41:11] Detected operating system: linux
[05:41:11] Enabling bundled linux tools.
[05:41:11] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:41:11] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:41:11] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:41:11] Found java - /usr/bin/java
[05:41:11] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:41:11] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:41:11] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:41:11] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:41:11] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:41:11] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:41:11] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:41:11] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:41:11] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:41:11] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:41:11] Found gzip - /bin/gzip
[05:41:11] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:41:11] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:41:11] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:41:11] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:41:11] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:41:11] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:41:11] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:41:11] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:41:11] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:41:11] Treating reference as 'fasta' format.
[05:41:11] Will use 16 CPU cores.
[05:41:11] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/d2/805c89c1c884e9f5729233fbc6037c/inputfiles/IE-0006_S11_L001-SPAdes.fasta
[05:41:11] Creating folder: snippy_work/IE-0006_S11_L001-SPAdes
[05:41:11] Changing working directory: snippy_work/IE-0006_S11_L001-SPAdes
[05:41:11] Creating reference folder: reference
[05:41:11] Extracting FASTA and GFF from reference.
[05:41:11] Wrote 205 sequences to ref.fa
[05:41:11] Wrote 0 features to ref.gff
[05:41:11] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/d2/805c89c1c884e9f5729233fbc6037c/inputfiles/IE-0006_S11_L001-SPAdes.fasta into pseudo-reads
[05:41:15] Wrote 582950 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:41:15] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:41:15] Using BAM RG (Read Group) ID: IE-0006_S11_L001-SPAdes
[05:41:15] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:41:15] Running: bwa index reference/ref.fa 2>> snps.log
[05:41:19] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:41:19] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:41:19] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:41:19] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:41:19] Running: bwa mem  -Y -M -R '@RG\tID:IE-0006_S11_L001-SPAdes\tSM:IE-0006_S11_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 582950 sequences (145737500 bp)...
[M::mem_process_seqs] Processed 582950 reads in 70.857 CPU sec, 4.702 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0006_S11_L001-SPAdes\tSM:IE-0006_S11_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 7.216 sec; CPU: 72.288 sec
[samclip] Total SAM records 587390, removed 12924, allowed 6852, passed 574466
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:41:28] Running: samtools index snps.bam 2>> snps.log
[05:41:28] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:41:28] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:41:31] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 101
          no. right trimmed                     : 1296
          no. left and right trimmed            : 79
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1476

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1476
       total no. variants observed              : 19226
       total no. reference observed             : 0

Time elapsed: 0.20s

[05:41:31] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:41:31] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:41:32] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:41:32] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:41:32] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:41:32] Running: bcftools consensus --sample IE-0006_S11_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:41:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:41:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:41:33] Running: bcftools consensus --sample IE-0006_S11_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:41:34] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:41:34] Running: rm -f fake_reads\.fq 2>> snps.log
[05:41:34] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:41:41] Marked 3616 heterozygous sites with 'n'
[05:41:41] Creating extra output files: BED GFF CSV TXT HTML
[05:41:41] Identified 19226 variants.
[05:41:41] Result folder: snippy_work/IE-0006_S11_L001-SPAdes
[05:41:41] Result files:
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.aligned.fa
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.bam
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.bam.bai
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.bed
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.consensus.fa
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.consensus.subs.fa
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.csv
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.filt.vcf
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.gff
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.html
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.log
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.raw.vcf
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.subs.vcf
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.tab
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.txt
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.vcf
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.vcf.gz
[05:41:41] * snippy_work/IE-0006_S11_L001-SPAdes/snps.vcf.gz.csi
[05:41:41] Walltime used: 30 seconds
[05:41:41] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[05:41:41] Done.
[05:41:41] This is snippy 4.6.0
[05:41:41] Written by Torsten Seemann
[05:41:41] Obtained from https://github.com/tseemann/snippy
[05:41:41] Detected operating system: linux
[05:41:41] Enabling bundled linux tools.
[05:41:41] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:41:41] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:41:41] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:41:41] Found java - /usr/bin/java
[05:41:41] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:41:41] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:41:41] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:41:41] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:41:41] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:41:41] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:41:41] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:41:41] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:41:41] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:41:41] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:41:41] Found gzip - /bin/gzip
[05:41:41] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:41:41] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:41:41] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:41:41] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:41:41] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:41:41] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:41:41] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:41:41] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:41:41] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:41:41] Treating reference as 'fasta' format.
[05:41:41] Will use 16 CPU cores.
[05:41:41] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/7b/b4b0c48c68d6f8475b6f07212ddb0e/inputfiles/IE-0007_S1_L001-SPAdes.fasta
[05:41:41] Creating folder: snippy_work/IE-0007_S1_L001-SPAdes
[05:41:41] Changing working directory: snippy_work/IE-0007_S1_L001-SPAdes
[05:41:41] Creating reference folder: reference
[05:41:41] Extracting FASTA and GFF from reference.
[05:41:41] Wrote 205 sequences to ref.fa
[05:41:41] Wrote 0 features to ref.gff
[05:41:41] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/7b/b4b0c48c68d6f8475b6f07212ddb0e/inputfiles/IE-0007_S1_L001-SPAdes.fasta into pseudo-reads
[05:41:46] Wrote 567326 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:41:46] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:41:46] Using BAM RG (Read Group) ID: IE-0007_S1_L001-SPAdes
[05:41:46] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:41:46] Running: bwa index reference/ref.fa 2>> snps.log
[05:41:49] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:41:49] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:41:49] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:41:49] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:41:49] Running: bwa mem  -Y -M -R '@RG\tID:IE-0007_S1_L001-SPAdes\tSM:IE-0007_S1_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 567326 sequences (141831500 bp)...
[M::mem_process_seqs] Processed 567326 reads in 69.548 CPU sec, 4.522 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0007_S1_L001-SPAdes\tSM:IE-0007_S1_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.996 sec; CPU: 70.969 sec
[samclip] Total SAM records 572460, removed 11977, allowed 8643, passed 560483
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:41:57] Running: samtools index snps.bam 2>> snps.log
[05:41:58] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:41:58] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:42:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 112
          no. right trimmed                     : 1326
          no. left and right trimmed            : 76
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1514

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1514
       total no. variants observed              : 19443
       total no. reference observed             : 0

Time elapsed: 0.20s

[05:42:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:42:01] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:42:01] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:42:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:42:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:42:02] Running: bcftools consensus --sample IE-0007_S1_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:42:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:42:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:42:03] Running: bcftools consensus --sample IE-0007_S1_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:42:04] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:42:04] Running: rm -f fake_reads\.fq 2>> snps.log
[05:42:04] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:42:10] Marked 3383 heterozygous sites with 'n'
[05:42:10] Creating extra output files: BED GFF CSV TXT HTML
[05:42:10] Identified 19443 variants.
[05:42:10] Result folder: snippy_work/IE-0007_S1_L001-SPAdes
[05:42:10] Result files:
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.aligned.fa
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.bam
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.bam.bai
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.bed
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.consensus.fa
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.consensus.subs.fa
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.csv
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.filt.vcf
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.gff
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.html
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.log
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.raw.vcf
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.subs.vcf
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.tab
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.txt
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.vcf
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.vcf.gz
[05:42:10] * snippy_work/IE-0007_S1_L001-SPAdes/snps.vcf.gz.csi
[05:42:10] Walltime used: 29 seconds
[05:42:10] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[05:42:10] Done.
[05:42:10] This is snippy 4.6.0
[05:42:10] Written by Torsten Seemann
[05:42:10] Obtained from https://github.com/tseemann/snippy
[05:42:10] Detected operating system: linux
[05:42:10] Enabling bundled linux tools.
[05:42:10] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:42:10] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:42:10] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:42:10] Found java - /usr/bin/java
[05:42:10] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:42:10] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:42:10] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:42:10] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:42:10] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:42:10] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:42:10] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:42:10] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:42:10] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:42:10] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:42:10] Found gzip - /bin/gzip
[05:42:10] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:42:10] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:42:10] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:42:10] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:42:10] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:42:10] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:42:11] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:42:11] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:42:11] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:42:11] Treating reference as 'fasta' format.
[05:42:11] Will use 16 CPU cores.
[05:42:11] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/76/798334dd5986a57f9bc7394c67ee5f/inputfiles/IE-0009_S3_L001-SPAdes.fasta
[05:42:11] Creating folder: snippy_work/IE-0009_S3_L001-SPAdes
[05:42:11] Changing working directory: snippy_work/IE-0009_S3_L001-SPAdes
[05:42:11] Creating reference folder: reference
[05:42:11] Extracting FASTA and GFF from reference.
[05:42:11] Wrote 205 sequences to ref.fa
[05:42:11] Wrote 0 features to ref.gff
[05:42:11] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/76/798334dd5986a57f9bc7394c67ee5f/inputfiles/IE-0009_S3_L001-SPAdes.fasta into pseudo-reads
[05:42:15] Wrote 571008 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:42:15] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:42:15] Using BAM RG (Read Group) ID: IE-0009_S3_L001-SPAdes
[05:42:15] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:42:15] Running: bwa index reference/ref.fa 2>> snps.log
[05:42:18] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:42:18] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:42:18] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:42:18] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:42:18] Running: bwa mem  -Y -M -R '@RG\tID:IE-0009_S3_L001-SPAdes\tSM:IE-0009_S3_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 571008 sequences (142752000 bp)...
[M::mem_process_seqs] Processed 571008 reads in 68.976 CPU sec, 4.649 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0009_S3_L001-SPAdes\tSM:IE-0009_S3_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq[samclip] Total SAM records 574955, removed 10947, allowed 8540, passed 564008
[samclip] Header contained 207 lines

[main] Real time: 6.892 sec; CPU: 70.250 sec
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:42:26] Running: samtools index snps.bam 2>> snps.log
[05:42:27] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:42:27] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:42:30] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 91
          no. right trimmed                     : 1267
          no. left and right trimmed            : 82
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1440

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1440
       total no. variants observed              : 18421
       total no. reference observed             : 0

Time elapsed: 0.19s

[05:42:30] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:42:30] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:42:30] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:42:31] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:42:31] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:42:31] Running: bcftools consensus --sample IE-0009_S3_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:42:32] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:42:32] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:42:32] Running: bcftools consensus --sample IE-0009_S3_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:42:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:42:33] Running: rm -f fake_reads\.fq 2>> snps.log
[05:42:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:42:39] Marked 3583 heterozygous sites with 'n'
[05:42:39] Creating extra output files: BED GFF CSV TXT HTML
[05:42:39] Identified 18421 variants.
[05:42:39] Result folder: snippy_work/IE-0009_S3_L001-SPAdes
[05:42:39] Result files:
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.aligned.fa
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.bam
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.bam.bai
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.bed
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.consensus.fa
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.consensus.subs.fa
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.csv
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.filt.vcf
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.gff
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.html
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.log
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.raw.vcf
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.subs.vcf
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.tab
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.txt
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.vcf
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.vcf.gz
[05:42:39] * snippy_work/IE-0009_S3_L001-SPAdes/snps.vcf.gz.csi
[05:42:39] Walltime used: 29 seconds
[05:42:39] Questionable SNP? Try the --report option to see the alignments.
[05:42:39] Done.
[05:42:40] This is snippy 4.6.0
[05:42:40] Written by Torsten Seemann
[05:42:40] Obtained from https://github.com/tseemann/snippy
[05:42:40] Detected operating system: linux
[05:42:40] Enabling bundled linux tools.
[05:42:40] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:42:40] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:42:40] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:42:40] Found java - /usr/bin/java
[05:42:40] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:42:40] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:42:40] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:42:40] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:42:40] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:42:40] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:42:40] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:42:40] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:42:40] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:42:40] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:42:40] Found gzip - /bin/gzip
[05:42:40] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:42:40] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:42:40] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:42:40] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:42:40] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:42:40] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:42:40] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:42:40] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:42:40] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:42:40] Treating reference as 'fasta' format.
[05:42:40] Will use 16 CPU cores.
[05:42:40] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/8b/568b3d1e231050182e775377629ae1/inputfiles/IE-0010_S4_L001-SPAdes.fasta
[05:42:40] Creating folder: snippy_work/IE-0010_S4_L001-SPAdes
[05:42:40] Changing working directory: snippy_work/IE-0010_S4_L001-SPAdes
[05:42:40] Creating reference folder: reference
[05:42:40] Extracting FASTA and GFF from reference.
[05:42:40] Wrote 205 sequences to ref.fa
[05:42:40] Wrote 0 features to ref.gff
[05:42:40] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/8b/568b3d1e231050182e775377629ae1/inputfiles/IE-0010_S4_L001-SPAdes.fasta into pseudo-reads
[05:42:44] Wrote 575560 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:42:44] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:42:44] Using BAM RG (Read Group) ID: IE-0010_S4_L001-SPAdes
[05:42:44] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:42:44] Running: bwa index reference/ref.fa 2>> snps.log
[05:42:47] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:42:47] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:42:47] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:42:47] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:42:47] Running: bwa mem  -Y -M -R '@RG\tID:IE-0010_S4_L001-SPAdes\tSM:IE-0010_S4_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 575560 sequences (143890000 bp)...
[M::mem_process_seqs] Processed 575560 reads in 68.831 CPU sec, 4.578 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0010_S4_L001-SPAdes\tSM:IE-0010_S4_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.972 sec; CPU: 70.156 sec
[samclip] Total SAM records 580746, removed 11539, allowed 7760, passed 569207
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:42:56] Running: samtools index snps.bam 2>> snps.log
[05:42:56] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:42:56] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:42:59] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 102
          no. right trimmed                     : 1199
          no. left and right trimmed            : 71
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1372

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1372
       total no. variants observed              : 17344
       total no. reference observed             : 0

Time elapsed: 0.21s

[05:42:59] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:42:59] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:42:59] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:43:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:43:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:43:00] Running: bcftools consensus --sample IE-0010_S4_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:43:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:43:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:43:01] Running: bcftools consensus --sample IE-0010_S4_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:43:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:43:02] Running: rm -f fake_reads\.fq 2>> snps.log
[05:43:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:43:08] Marked 3204 heterozygous sites with 'n'
[05:43:08] Creating extra output files: BED GFF CSV TXT HTML
[05:43:09] Identified 17344 variants.
[05:43:09] Result folder: snippy_work/IE-0010_S4_L001-SPAdes
[05:43:09] Result files:
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.aligned.fa
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.bam
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.bam.bai
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.bed
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.consensus.fa
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.consensus.subs.fa
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.csv
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.filt.vcf
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.gff
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.html
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.log
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.raw.vcf
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.subs.vcf
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.tab
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.txt
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.vcf
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.vcf.gz
[05:43:09] * snippy_work/IE-0010_S4_L001-SPAdes/snps.vcf.gz.csi
[05:43:09] Walltime used: 29 seconds
[05:43:09] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[05:43:09] Done.
[05:43:09] This is snippy 4.6.0
[05:43:09] Written by Torsten Seemann
[05:43:09] Obtained from https://github.com/tseemann/snippy
[05:43:09] Detected operating system: linux
[05:43:09] Enabling bundled linux tools.
[05:43:09] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:43:09] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:43:09] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:43:09] Found java - /usr/bin/java
[05:43:09] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:43:09] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:43:09] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:43:09] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:43:09] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:43:09] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:43:09] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:43:09] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:43:09] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:43:09] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:43:09] Found gzip - /bin/gzip
[05:43:09] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:43:09] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:43:09] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:43:09] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:43:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:43:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:43:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:43:09] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:43:09] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:43:09] Treating reference as 'fasta' format.
[05:43:09] Will use 16 CPU cores.
[05:43:09] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/cb/b2c8122b89b4c1316cb700f24ae652/inputfiles/IE-0011_S5_L001-SPAdes.fasta
[05:43:09] Creating folder: snippy_work/IE-0011_S5_L001-SPAdes
[05:43:09] Changing working directory: snippy_work/IE-0011_S5_L001-SPAdes
[05:43:09] Creating reference folder: reference
[05:43:09] Extracting FASTA and GFF from reference.
[05:43:09] Wrote 205 sequences to ref.fa
[05:43:09] Wrote 0 features to ref.gff
[05:43:09] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/cb/b2c8122b89b4c1316cb700f24ae652/inputfiles/IE-0011_S5_L001-SPAdes.fasta into pseudo-reads
[05:43:13] Wrote 567012 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:43:13] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:43:13] Using BAM RG (Read Group) ID: IE-0011_S5_L001-SPAdes
[05:43:13] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:43:13] Running: bwa index reference/ref.fa 2>> snps.log
[05:43:16] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:43:16] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:43:16] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:43:16] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:43:16] Running: bwa mem  -Y -M -R '@RG\tID:IE-0011_S5_L001-SPAdes\tSM:IE-0011_S5_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 567012 sequences (141753000 bp)...
[M::mem_process_seqs] Processed 567012 reads in 64.458 CPU sec, 4.263 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0011_S5_L001-SPAdes\tSM:IE-0011_S5_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.688 sec; CPU: 65.891 sec
[samclip] Total SAM records 572004, removed 11810, allowed 8336, passed 560194
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:43:24] Running: samtools index snps.bam 2>> snps.log
[05:43:25] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:43:25] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:43:28] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 104
          no. right trimmed                     : 1333
          no. left and right trimmed            : 87
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1524

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1524
       total no. variants observed              : 19901
       total no. reference observed             : 0

Time elapsed: 0.21s

[05:43:28] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:43:28] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:43:28] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:43:29] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:43:29] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:43:29] Running: bcftools consensus --sample IE-0011_S5_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:43:30] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:43:30] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:43:30] Running: bcftools consensus --sample IE-0011_S5_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:43:31] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:43:31] Running: rm -f fake_reads\.fq 2>> snps.log
[05:43:31] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:43:37] Marked 3946 heterozygous sites with 'n'
[05:43:37] Creating extra output files: BED GFF CSV TXT HTML
[05:43:37] Identified 19901 variants.
[05:43:37] Result folder: snippy_work/IE-0011_S5_L001-SPAdes
[05:43:37] Result files:
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.aligned.fa
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.bam
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.bam.bai
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.bed
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.consensus.fa
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.consensus.subs.fa
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.csv
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.filt.vcf
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.gff
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.html
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.log
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.raw.vcf
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.subs.vcf
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.tab
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.txt
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.vcf
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.vcf.gz
[05:43:37] * snippy_work/IE-0011_S5_L001-SPAdes/snps.vcf.gz.csi
[05:43:37] Walltime used: 28 seconds
[05:43:37] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[05:43:37] Done.
[05:43:38] This is snippy 4.6.0
[05:43:38] Written by Torsten Seemann
[05:43:38] Obtained from https://github.com/tseemann/snippy
[05:43:38] Detected operating system: linux
[05:43:38] Enabling bundled linux tools.
[05:43:38] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:43:38] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:43:38] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:43:38] Found java - /usr/bin/java
[05:43:38] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:43:38] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:43:38] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:43:38] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:43:38] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:43:38] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:43:38] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:43:38] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:43:38] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:43:38] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:43:38] Found gzip - /bin/gzip
[05:43:38] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:43:38] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:43:38] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:43:38] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:43:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:43:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:43:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:43:38] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:43:38] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:43:38] Treating reference as 'fasta' format.
[05:43:38] Will use 16 CPU cores.
[05:43:38] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/01/60826b649c049a49d1e18d49e4f6ee/inputfiles/IE-0012_S6_L001-SPAdes.fasta
[05:43:38] Creating folder: snippy_work/IE-0012_S6_L001-SPAdes
[05:43:38] Changing working directory: snippy_work/IE-0012_S6_L001-SPAdes
[05:43:38] Creating reference folder: reference
[05:43:38] Extracting FASTA and GFF from reference.
[05:43:38] Wrote 205 sequences to ref.fa
[05:43:38] Wrote 0 features to ref.gff
[05:43:38] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/01/60826b649c049a49d1e18d49e4f6ee/inputfiles/IE-0012_S6_L001-SPAdes.fasta into pseudo-reads
[05:43:42] Wrote 568506 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:43:42] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:43:42] Using BAM RG (Read Group) ID: IE-0012_S6_L001-SPAdes
[05:43:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:43:42] Running: bwa index reference/ref.fa 2>> snps.log
[05:43:45] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:43:45] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:43:45] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:43:45] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:43:45] Running: bwa mem  -Y -M -R '@RG\tID:IE-0012_S6_L001-SPAdes\tSM:IE-0012_S6_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 568506 sequences (142126500 bp)...
[M::mem_process_seqs] Processed 568506 reads in 64.598 CPU sec, 4.271 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0012_S6_L001-SPAdes\tSM:IE-0012_S6_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.455 sec; CPU: 65.811 sec
[samclip] Total SAM records 573882, removed 12278, allowed 8179, passed 561604
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:43:53] Running: samtools index snps.bam 2>> snps.log
[05:43:54] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:43:54] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:43:56] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 118
          no. right trimmed                     : 1353
          no. left and right trimmed            : 84
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1555

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1555
       total no. variants observed              : 20077
       total no. reference observed             : 0

Time elapsed: 0.21s

[05:43:57] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:43:57] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:43:57] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:43:57] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:43:57] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:43:57] Running: bcftools consensus --sample IE-0012_S6_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:43:59] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:43:59] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:43:59] Running: bcftools consensus --sample IE-0012_S6_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:44:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:44:00] Running: rm -f fake_reads\.fq 2>> snps.log
[05:44:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:44:06] Marked 3727 heterozygous sites with 'n'
[05:44:06] Creating extra output files: BED GFF CSV TXT HTML
[05:44:06] Identified 20077 variants.
[05:44:06] Result folder: snippy_work/IE-0012_S6_L001-SPAdes
[05:44:06] Result files:
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.aligned.fa
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.bam
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.bam.bai
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.bed
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.consensus.fa
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.consensus.subs.fa
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.csv
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.filt.vcf
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.gff
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.html
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.log
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.raw.vcf
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.subs.vcf
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.tab
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.txt
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.vcf
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.vcf.gz
[05:44:06] * snippy_work/IE-0012_S6_L001-SPAdes/snps.vcf.gz.csi
[05:44:06] Walltime used: 28 seconds
[05:44:06] Questionable SNP? Try the --report option to see the alignments.
[05:44:06] Done.
[05:44:06] This is snippy 4.6.0
[05:44:06] Written by Torsten Seemann
[05:44:06] Obtained from https://github.com/tseemann/snippy
[05:44:06] Detected operating system: linux
[05:44:06] Enabling bundled linux tools.
[05:44:06] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:44:06] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:44:06] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:44:06] Found java - /usr/bin/java
[05:44:06] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:44:06] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:44:06] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:44:06] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:44:06] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:44:06] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:44:06] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:44:06] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:44:06] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:44:06] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:44:06] Found gzip - /bin/gzip
[05:44:07] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:44:07] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:44:07] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:44:07] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:44:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:44:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:44:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:44:07] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:44:07] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:44:07] Treating reference as 'fasta' format.
[05:44:07] Will use 16 CPU cores.
[05:44:07] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/24/0c39446a042dfc5629f94419c3ff1d/inputfiles/IE-0013_S7_L001-SPAdes.fasta
[05:44:07] Creating folder: snippy_work/IE-0013_S7_L001-SPAdes
[05:44:07] Changing working directory: snippy_work/IE-0013_S7_L001-SPAdes
[05:44:07] Creating reference folder: reference
[05:44:07] Extracting FASTA and GFF from reference.
[05:44:07] Wrote 205 sequences to ref.fa
[05:44:07] Wrote 0 features to ref.gff
[05:44:07] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/24/0c39446a042dfc5629f94419c3ff1d/inputfiles/IE-0013_S7_L001-SPAdes.fasta into pseudo-reads
[05:44:11] Wrote 572722 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:44:11] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:44:11] Using BAM RG (Read Group) ID: IE-0013_S7_L001-SPAdes
[05:44:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:44:11] Running: bwa index reference/ref.fa 2>> snps.log
[05:44:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:44:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:44:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:44:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:44:14] Running: bwa mem  -Y -M -R '@RG\tID:IE-0013_S7_L001-SPAdes\tSM:IE-0013_S7_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 572722 sequences (143180500 bp)...
[M::mem_process_seqs] Processed 572722 reads in 53.392 CPU sec, 3.750 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0013_S7_L001-SPAdes\tSM:IE-0013_S7_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.042 sec; CPU: 54.843 sec
[samclip] Total SAM records 576043, removed 6423, allowed 6974, passed 569620
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:44:21] Running: samtools index snps.bam 2>> snps.log
[05:44:22] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:44:22] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:44:24] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 60
          no. right trimmed                     : 804
          no. left and right trimmed            : 52
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 916

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 916
       total no. variants observed              : 10831
       total no. reference observed             : 0

Time elapsed: 0.11s

[05:44:24] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:44:24] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:44:24] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:44:25] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:44:25] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:44:25] Running: bcftools consensus --sample IE-0013_S7_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:44:26] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:44:26] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:44:26] Running: bcftools consensus --sample IE-0013_S7_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:44:27] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:44:27] Running: rm -f fake_reads\.fq 2>> snps.log
[05:44:27] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:44:33] Marked 4040 heterozygous sites with 'n'
[05:44:33] Creating extra output files: BED GFF CSV TXT HTML
[05:44:33] Identified 10831 variants.
[05:44:33] Result folder: snippy_work/IE-0013_S7_L001-SPAdes
[05:44:33] Result files:
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.aligned.fa
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.bam
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.bam.bai
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.bed
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.consensus.fa
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.consensus.subs.fa
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.csv
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.filt.vcf
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.gff
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.html
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.log
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.raw.vcf
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.subs.vcf
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.tab
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.txt
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.vcf
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.vcf.gz
[05:44:33] * snippy_work/IE-0013_S7_L001-SPAdes/snps.vcf.gz.csi
[05:44:33] Walltime used: 27 seconds
[05:44:33] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[05:44:33] Done.
[05:44:33] This is snippy 4.6.0
[05:44:33] Written by Torsten Seemann
[05:44:33] Obtained from https://github.com/tseemann/snippy
[05:44:33] Detected operating system: linux
[05:44:33] Enabling bundled linux tools.
[05:44:33] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:44:33] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:44:33] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:44:33] Found java - /usr/bin/java
[05:44:33] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:44:33] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:44:33] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:44:33] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:44:33] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:44:33] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:44:33] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:44:33] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:44:33] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:44:33] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:44:33] Found gzip - /bin/gzip
[05:44:33] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:44:33] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:44:33] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:44:33] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:44:33] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:44:33] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:44:34] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:44:34] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:44:34] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:44:34] Treating reference as 'fasta' format.
[05:44:34] Will use 16 CPU cores.
[05:44:34] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/8b/5bccd941c217f11cd3c953234dcf59/inputfiles/IE-0014_S8_L001-SPAdes.fasta
[05:44:34] Creating folder: snippy_work/IE-0014_S8_L001-SPAdes
[05:44:34] Changing working directory: snippy_work/IE-0014_S8_L001-SPAdes
[05:44:34] Creating reference folder: reference
[05:44:34] Extracting FASTA and GFF from reference.
[05:44:34] Wrote 205 sequences to ref.fa
[05:44:34] Wrote 0 features to ref.gff
[05:44:34] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/8b/5bccd941c217f11cd3c953234dcf59/inputfiles/IE-0014_S8_L001-SPAdes.fasta into pseudo-reads
[05:44:38] Wrote 568534 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:44:38] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:44:38] Using BAM RG (Read Group) ID: IE-0014_S8_L001-SPAdes
[05:44:38] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:44:38] Running: bwa index reference/ref.fa 2>> snps.log
[05:44:41] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:44:41] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:44:41] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:44:41] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:44:41] Running: bwa mem  -Y -M -R '@RG\tID:IE-0014_S8_L001-SPAdes\tSM:IE-0014_S8_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 568534 sequences (142133500 bp)...
[M::mem_process_seqs] Processed 568534 reads in 67.010 CPU sec, 4.438 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0014_S8_L001-SPAdes\tSM:IE-0014_S8_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.741 sec; CPU: 68.270 sec
[samclip] Total SAM records 573848, removed 12313, allowed 8327, passed 561535
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:44:49] Running: samtools index snps.bam 2>> snps.log
[05:44:49] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:44:49] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:44:52] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 116
          no. right trimmed                     : 1339
          no. left and right trimmed            : 83
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1538

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1538
       total no. variants observed              : 20046
       total no. reference observed             : 0

Time elapsed: 0.21s

[05:44:52] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:44:52] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:44:53] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:44:53] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:44:53] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:44:53] Running: bcftools consensus --sample IE-0014_S8_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:44:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:44:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:44:54] Running: bcftools consensus --sample IE-0014_S8_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:44:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:44:55] Running: rm -f fake_reads\.fq 2>> snps.log
[05:44:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:45:02] Marked 4042 heterozygous sites with 'n'
[05:45:02] Creating extra output files: BED GFF CSV TXT HTML
[05:45:02] Identified 20046 variants.
[05:45:02] Result folder: snippy_work/IE-0014_S8_L001-SPAdes
[05:45:02] Result files:
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.aligned.fa
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.bam
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.bam.bai
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.bed
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.consensus.fa
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.consensus.subs.fa
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.csv
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.filt.vcf
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.gff
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.html
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.log
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.raw.vcf
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.subs.vcf
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.tab
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.txt
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.vcf
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.vcf.gz
[05:45:02] * snippy_work/IE-0014_S8_L001-SPAdes/snps.vcf.gz.csi
[05:45:02] Walltime used: 29 seconds
[05:45:02] Wishing you a life free of homopolymer errors.
[05:45:02] Done.
[05:45:02] This is snippy 4.6.0
[05:45:02] Written by Torsten Seemann
[05:45:02] Obtained from https://github.com/tseemann/snippy
[05:45:02] Detected operating system: linux
[05:45:02] Enabling bundled linux tools.
[05:45:02] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:45:02] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:45:02] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:45:02] Found java - /usr/bin/java
[05:45:02] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:45:02] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:45:02] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:45:02] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:45:02] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:45:02] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:45:02] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:45:02] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:45:02] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:45:02] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:45:02] Found gzip - /bin/gzip
[05:45:02] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:45:02] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:45:02] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:45:02] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:45:02] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:45:02] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:45:02] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:45:02] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:45:02] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:45:02] Treating reference as 'fasta' format.
[05:45:02] Will use 16 CPU cores.
[05:45:02] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/38/729fe8dfa40e32903d2c783a3ac201/inputfiles/IE-0015_S9_L001-SPAdes.fasta
[05:45:02] Creating folder: snippy_work/IE-0015_S9_L001-SPAdes
[05:45:02] Changing working directory: snippy_work/IE-0015_S9_L001-SPAdes
[05:45:02] Creating reference folder: reference
[05:45:02] Extracting FASTA and GFF from reference.
[05:45:02] Wrote 205 sequences to ref.fa
[05:45:02] Wrote 0 features to ref.gff
[05:45:02] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/38/729fe8dfa40e32903d2c783a3ac201/inputfiles/IE-0015_S9_L001-SPAdes.fasta into pseudo-reads
[05:45:07] Wrote 569240 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:45:07] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:45:07] Using BAM RG (Read Group) ID: IE-0015_S9_L001-SPAdes
[05:45:07] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:45:07] Running: bwa index reference/ref.fa 2>> snps.log
[05:45:09] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:45:09] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:45:09] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:45:09] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:45:09] Running: bwa mem  -Y -M -R '@RG\tID:IE-0015_S9_L001-SPAdes\tSM:IE-0015_S9_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 569240 sequences (142310000 bp)...
[M::mem_process_seqs] Processed 569240 reads in 53.171 CPU sec, 3.789 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0015_S9_L001-SPAdes\tSM:IE-0015_S9_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.923 sec; CPU: 54.337 sec
[samclip] Total SAM records 572396, removed 5735, allowed 7127, passed 566661
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:45:17] Running: samtools index snps.bam 2>> snps.log
[05:45:17] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:45:17] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:45:19] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 66
          no. right trimmed                     : 804
          no. left and right trimmed            : 59
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 929

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 929
       total no. variants observed              : 10575
       total no. reference observed             : 0

Time elapsed: 0.11s

[05:45:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:45:20] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:45:20] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:45:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:45:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:45:20] Running: bcftools consensus --sample IE-0015_S9_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:45:21] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:45:21] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:45:21] Running: bcftools consensus --sample IE-0015_S9_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:45:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:45:22] Running: rm -f fake_reads\.fq 2>> snps.log
[05:45:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:45:29] Marked 3772 heterozygous sites with 'n'
[05:45:29] Creating extra output files: BED GFF CSV TXT HTML
[05:45:29] Identified 10575 variants.
[05:45:29] Result folder: snippy_work/IE-0015_S9_L001-SPAdes
[05:45:29] Result files:
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.aligned.fa
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.bam
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.bam.bai
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.bed
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.consensus.fa
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.consensus.subs.fa
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.csv
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.filt.vcf
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.gff
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.html
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.log
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.raw.vcf
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.subs.vcf
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.tab
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.txt
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.vcf
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.vcf.gz
[05:45:29] * snippy_work/IE-0015_S9_L001-SPAdes/snps.vcf.gz.csi
[05:45:29] Walltime used: 27 seconds
[05:45:29] Questionable SNP? Try the --report option to see the alignments.
[05:45:29] Done.
[05:45:29] This is snippy 4.6.0
[05:45:29] Written by Torsten Seemann
[05:45:29] Obtained from https://github.com/tseemann/snippy
[05:45:29] Detected operating system: linux
[05:45:29] Enabling bundled linux tools.
[05:45:29] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:45:29] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:45:29] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:45:29] Found java - /usr/bin/java
[05:45:29] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:45:29] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:45:29] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:45:29] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:45:29] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:45:29] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:45:29] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:45:29] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:45:29] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:45:29] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:45:29] Found gzip - /bin/gzip
[05:45:29] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:45:29] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:45:29] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:45:29] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:45:29] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:45:29] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:45:29] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:45:29] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:45:29] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:45:29] Treating reference as 'fasta' format.
[05:45:29] Will use 16 CPU cores.
[05:45:29] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/a1/dedb4b13fa2a324e471e2c2fa7b0cb/inputfiles/IE-0016_S10_L001-SPAdes.fasta
[05:45:29] Creating folder: snippy_work/IE-0016_S10_L001-SPAdes
[05:45:29] Changing working directory: snippy_work/IE-0016_S10_L001-SPAdes
[05:45:29] Creating reference folder: reference
[05:45:29] Extracting FASTA and GFF from reference.
[05:45:29] Wrote 205 sequences to ref.fa
[05:45:29] Wrote 0 features to ref.gff
[05:45:29] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/a1/dedb4b13fa2a324e471e2c2fa7b0cb/inputfiles/IE-0016_S10_L001-SPAdes.fasta into pseudo-reads
[05:45:34] Wrote 574600 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:45:34] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:45:34] Using BAM RG (Read Group) ID: IE-0016_S10_L001-SPAdes
[05:45:34] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:45:34] Running: bwa index reference/ref.fa 2>> snps.log
[05:45:36] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:45:36] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:45:36] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:45:36] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:45:36] Running: bwa mem  -Y -M -R '@RG\tID:IE-0016_S10_L001-SPAdes\tSM:IE-0016_S10_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 574600 sequences (143650000 bp)...
[M::mem_process_seqs] Processed 574600 reads in 59.748 CPU sec, 3.968 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0016_S10_L001-SPAdes\tSM:IE-0016_S10_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.169 sec; CPU: 60.915 sec
[samclip] Total SAM records 579236, removed 10600, allowed 7951, passed 568636
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:45:44] Running: samtools index snps.bam 2>> snps.log
[05:45:44] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:45:44] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:45:47] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 98
          no. right trimmed                     : 1154
          no. left and right trimmed            : 63
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1315

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1315
       total no. variants observed              : 16760
       total no. reference observed             : 0

Time elapsed: 0.18s

[05:45:47] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:45:47] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:45:47] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:45:48] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:45:48] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:45:48] Running: bcftools consensus --sample IE-0016_S10_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:45:49] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:45:49] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:45:49] Running: bcftools consensus --sample IE-0016_S10_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:45:50] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:45:50] Running: rm -f fake_reads\.fq 2>> snps.log
[05:45:50] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:45:56] Marked 3993 heterozygous sites with 'n'
[05:45:56] Creating extra output files: BED GFF CSV TXT HTML
[05:45:57] Identified 16760 variants.
[05:45:57] Result folder: snippy_work/IE-0016_S10_L001-SPAdes
[05:45:57] Result files:
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.aligned.fa
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.bam
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.bam.bai
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.bed
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.consensus.fa
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.consensus.subs.fa
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.csv
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.filt.vcf
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.gff
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.html
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.log
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.raw.vcf
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.subs.vcf
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.tab
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.txt
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.vcf
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.vcf.gz
[05:45:57] * snippy_work/IE-0016_S10_L001-SPAdes/snps.vcf.gz.csi
[05:45:57] Walltime used: 28 seconds
[05:45:57] May the SNPs be with you.
[05:45:57] Done.
[05:45:57] This is snippy 4.6.0
[05:45:57] Written by Torsten Seemann
[05:45:57] Obtained from https://github.com/tseemann/snippy
[05:45:57] Detected operating system: linux
[05:45:57] Enabling bundled linux tools.
[05:45:57] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:45:57] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:45:57] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:45:57] Found java - /usr/bin/java
[05:45:57] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:45:57] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:45:57] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:45:57] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:45:57] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:45:57] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:45:57] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:45:57] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:45:57] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:45:57] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:45:57] Found gzip - /bin/gzip
[05:45:57] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:45:57] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:45:57] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:45:57] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:45:57] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:45:57] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:45:57] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:45:57] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:45:57] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:45:57] Treating reference as 'fasta' format.
[05:45:57] Will use 16 CPU cores.
[05:45:57] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/8c/480cbea9e5b87fc6cdb51480a12631/inputfiles/IE-0017_S11_L001-SPAdes.fasta
[05:45:57] Creating folder: snippy_work/IE-0017_S11_L001-SPAdes
[05:45:57] Changing working directory: snippy_work/IE-0017_S11_L001-SPAdes
[05:45:57] Creating reference folder: reference
[05:45:57] Extracting FASTA and GFF from reference.
[05:45:57] Wrote 205 sequences to ref.fa
[05:45:57] Wrote 0 features to ref.gff
[05:45:57] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/8c/480cbea9e5b87fc6cdb51480a12631/inputfiles/IE-0017_S11_L001-SPAdes.fasta into pseudo-reads
[05:46:01] Wrote 576208 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:46:01] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:46:01] Using BAM RG (Read Group) ID: IE-0017_S11_L001-SPAdes
[05:46:01] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:46:02] Running: bwa index reference/ref.fa 2>> snps.log
[05:46:04] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:46:04] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:46:04] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:46:04] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:46:04] Running: bwa mem  -Y -M -R '@RG\tID:IE-0017_S11_L001-SPAdes\tSM:IE-0017_S11_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 576208 sequences (144052000 bp)...
[M::mem_process_seqs] Processed 576208 reads in 62.256 CPU sec, 4.193 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0017_S11_L001-SPAdes\tSM:IE-0017_S11_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.533 sec; CPU: 63.513 sec
[samclip] Total SAM records 580732, removed 10743, allowed 7946, passed 569989
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:46:12] Running: samtools index snps.bam 2>> snps.log
[05:46:13] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:46:13] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:46:15] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 104
          no. right trimmed                     : 1211
          no. left and right trimmed            : 76
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1391

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1391
       total no. variants observed              : 17966
       total no. reference observed             : 0

Time elapsed: 0.19s

[05:46:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:46:15] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:46:16] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:46:16] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:46:16] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:46:16] Running: bcftools consensus --sample IE-0017_S11_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:46:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:46:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:46:17] Running: bcftools consensus --sample IE-0017_S11_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:46:18] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:46:18] Running: rm -f fake_reads\.fq 2>> snps.log
[05:46:19] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:46:25] Marked 3915 heterozygous sites with 'n'
[05:46:25] Creating extra output files: BED GFF CSV TXT HTML
[05:46:25] Identified 17966 variants.
[05:46:25] Result folder: snippy_work/IE-0017_S11_L001-SPAdes
[05:46:25] Result files:
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.aligned.fa
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.bam
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.bam.bai
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.bed
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.consensus.fa
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.consensus.subs.fa
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.csv
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.filt.vcf
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.gff
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.html
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.log
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.raw.vcf
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.subs.vcf
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.tab
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.txt
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.vcf
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.vcf.gz
[05:46:25] * snippy_work/IE-0017_S11_L001-SPAdes/snps.vcf.gz.csi
[05:46:25] Walltime used: 28 seconds
[05:46:25] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[05:46:25] Done.
[05:46:26] This is snippy 4.6.0
[05:46:26] Written by Torsten Seemann
[05:46:26] Obtained from https://github.com/tseemann/snippy
[05:46:26] Detected operating system: linux
[05:46:26] Enabling bundled linux tools.
[05:46:26] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:46:26] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:46:26] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:46:26] Found java - /usr/bin/java
[05:46:26] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:46:26] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:46:26] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:46:26] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:46:26] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:46:26] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:46:26] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:46:26] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:46:26] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:46:26] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:46:26] Found gzip - /bin/gzip
[05:46:26] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:46:26] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:46:26] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:46:26] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:46:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:46:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:46:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:46:26] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:46:26] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:46:26] Treating reference as 'fasta' format.
[05:46:26] Will use 16 CPU cores.
[05:46:26] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/f2/02fb828ac9599db89208dbb0398577/inputfiles/IE-0018_S12_L001-SPAdes.fasta
[05:46:26] Creating folder: snippy_work/IE-0018_S12_L001-SPAdes
[05:46:26] Changing working directory: snippy_work/IE-0018_S12_L001-SPAdes
[05:46:26] Creating reference folder: reference
[05:46:26] Extracting FASTA and GFF from reference.
[05:46:26] Wrote 205 sequences to ref.fa
[05:46:26] Wrote 0 features to ref.gff
[05:46:26] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/f2/02fb828ac9599db89208dbb0398577/inputfiles/IE-0018_S12_L001-SPAdes.fasta into pseudo-reads
[05:46:30] Wrote 576042 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:46:30] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:46:30] Using BAM RG (Read Group) ID: IE-0018_S12_L001-SPAdes
[05:46:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:46:30] Running: bwa index reference/ref.fa 2>> snps.log
[05:46:33] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:46:33] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:46:33] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:46:33] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:46:33] Running: bwa mem  -Y -M -R '@RG\tID:IE-0018_S12_L001-SPAdes\tSM:IE-0018_S12_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 576042 sequences (144010500 bp)...
[M::mem_process_seqs] Processed 576042 reads in 48.465 CPU sec, 3.392 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0018_S12_L001-SPAdes\tSM:IE-0018_S12_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.646 sec; CPU: 49.727 sec
[samclip] Total SAM records 580098, removed 9313, allowed 7364, passed 570785
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:46:40] Running: samtools index snps.bam 2>> snps.log
[05:46:41] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:46:41] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:46:43] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 74
          no. right trimmed                     : 900
          no. left and right trimmed            : 53
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1027

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1027
       total no. variants observed              : 11906
       total no. reference observed             : 0

Time elapsed: 0.12s

[05:46:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:46:43] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:46:43] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:46:43] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:46:43] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:46:43] Running: bcftools consensus --sample IE-0018_S12_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:46:44] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:46:45] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:46:45] Running: bcftools consensus --sample IE-0018_S12_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:46:45] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:46:46] Running: rm -f fake_reads\.fq 2>> snps.log
[05:46:46] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:46:52] Marked 3789 heterozygous sites with 'n'
[05:46:52] Creating extra output files: BED GFF CSV TXT HTML
[05:46:52] Identified 11906 variants.
[05:46:52] Result folder: snippy_work/IE-0018_S12_L001-SPAdes
[05:46:52] Result files:
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.aligned.fa
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.bam
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.bam.bai
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.bed
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.consensus.fa
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.consensus.subs.fa
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.csv
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.filt.vcf
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.gff
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.html
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.log
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.raw.vcf
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.subs.vcf
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.tab
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.txt
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.vcf
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.vcf.gz
[05:46:52] * snippy_work/IE-0018_S12_L001-SPAdes/snps.vcf.gz.csi
[05:46:52] Walltime used: 26 seconds
[05:46:52] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[05:46:52] Done.
[05:46:53] This is snippy 4.6.0
[05:46:53] Written by Torsten Seemann
[05:46:53] Obtained from https://github.com/tseemann/snippy
[05:46:53] Detected operating system: linux
[05:46:53] Enabling bundled linux tools.
[05:46:53] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:46:53] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:46:53] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:46:53] Found java - /usr/bin/java
[05:46:53] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:46:53] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:46:53] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:46:53] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:46:53] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:46:53] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:46:53] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:46:53] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:46:53] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:46:53] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:46:53] Found gzip - /bin/gzip
[05:46:53] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:46:53] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:46:53] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:46:53] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:46:53] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:46:53] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:46:53] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:46:53] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:46:53] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:46:53] Treating reference as 'fasta' format.
[05:46:53] Will use 16 CPU cores.
[05:46:53] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/2e/4ff4419d22b7710040ed068667bc51/inputfiles/IE-0019_S5-SPAdes.fasta
[05:46:53] Creating folder: snippy_work/IE-0019_S5-SPAdes
[05:46:53] Changing working directory: snippy_work/IE-0019_S5-SPAdes
[05:46:53] Creating reference folder: reference
[05:46:53] Extracting FASTA and GFF from reference.
[05:46:53] Wrote 205 sequences to ref.fa
[05:46:53] Wrote 0 features to ref.gff
[05:46:53] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/2e/4ff4419d22b7710040ed068667bc51/inputfiles/IE-0019_S5-SPAdes.fasta into pseudo-reads
[05:46:57] Wrote 573042 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:46:57] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:46:57] Using BAM RG (Read Group) ID: IE-0019_S5-SPAdes
[05:46:57] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:46:57] Running: bwa index reference/ref.fa 2>> snps.log
[05:47:00] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:47:00] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:47:00] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:47:00] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:47:00] Running: bwa mem  -Y -M -R '@RG\tID:IE-0019_S5-SPAdes\tSM:IE-0019_S5-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 573042 sequences (143260500 bp)...
[M::mem_process_seqs] Processed 573042 reads in 51.002 CPU sec, 3.488 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0019_S5-SPAdes\tSM:IE-0019_S5-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.672 sec; CPU: 52.207 sec
[samclip] Total SAM records 576207, removed 7364, allowed 6752, passed 568843
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:47:07] Running: samtools index snps.bam 2>> snps.log
[05:47:08] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:47:08] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:47:10] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 63
          no. right trimmed                     : 844
          no. left and right trimmed            : 45
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 952

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 952
       total no. variants observed              : 11216
       total no. reference observed             : 0

Time elapsed: 0.12s

[05:47:10] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:47:10] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:47:10] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:47:10] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:47:10] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:47:11] Running: bcftools consensus --sample IE-0019_S5-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:47:12] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:47:12] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:47:12] Running: bcftools consensus --sample IE-0019_S5-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:47:13] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:47:13] Running: rm -f fake_reads\.fq 2>> snps.log
[05:47:13] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:47:19] Marked 3823 heterozygous sites with 'n'
[05:47:19] Creating extra output files: BED GFF CSV TXT HTML
[05:47:19] Identified 11216 variants.
[05:47:19] Result folder: snippy_work/IE-0019_S5-SPAdes
[05:47:19] Result files:
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.aligned.fa
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.bam
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.bam.bai
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.bed
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.consensus.fa
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.consensus.subs.fa
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.csv
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.filt.vcf
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.gff
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.html
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.log
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.raw.vcf
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.subs.vcf
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.tab
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.txt
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.vcf
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.vcf.gz
[05:47:19] * snippy_work/IE-0019_S5-SPAdes/snps.vcf.gz.csi
[05:47:19] Walltime used: 26 seconds
[05:47:19] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[05:47:19] Done.
[05:47:19] This is snippy 4.6.0
[05:47:19] Written by Torsten Seemann
[05:47:19] Obtained from https://github.com/tseemann/snippy
[05:47:19] Detected operating system: linux
[05:47:19] Enabling bundled linux tools.
[05:47:19] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:47:19] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:47:19] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:47:19] Found java - /usr/bin/java
[05:47:19] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:47:19] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:47:20] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:47:20] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:47:20] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:47:20] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:47:20] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:47:20] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:47:20] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:47:20] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:47:20] Found gzip - /bin/gzip
[05:47:20] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:47:20] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:47:20] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:47:20] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:47:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:47:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:47:20] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:47:20] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:47:20] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:47:20] Treating reference as 'fasta' format.
[05:47:20] Will use 16 CPU cores.
[05:47:20] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/4b/dc171354f051d8b0ae1641e943a7e9/inputfiles/IE-0021_S7-SPAdes.fasta
[05:47:20] Creating folder: snippy_work/IE-0021_S7-SPAdes
[05:47:20] Changing working directory: snippy_work/IE-0021_S7-SPAdes
[05:47:20] Creating reference folder: reference
[05:47:20] Extracting FASTA and GFF from reference.
[05:47:20] Wrote 205 sequences to ref.fa
[05:47:20] Wrote 0 features to ref.gff
[05:47:20] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/4b/dc171354f051d8b0ae1641e943a7e9/inputfiles/IE-0021_S7-SPAdes.fasta into pseudo-reads
[05:47:25] Wrote 578000 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:47:25] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:47:25] Using BAM RG (Read Group) ID: IE-0021_S7-SPAdes
[05:47:25] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:47:25] Running: bwa index reference/ref.fa 2>> snps.log
[05:47:27] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:47:27] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:47:27] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:47:27] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:47:27] Running: bwa mem  -Y -M -R '@RG\tID:IE-0021_S7-SPAdes\tSM:IE-0021_S7-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 578000 sequences (144500000 bp)...
[M::mem_process_seqs] Processed 578000 reads in 58.963 CPU sec, 4.032 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0021_S7-SPAdes\tSM:IE-0021_S7-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.264 sec; CPU: 60.243 sec
[samclip] Total SAM records 582549, removed 12297, allowed 7347, passed 570252
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:47:35] Running: samtools index snps.bam 2>> snps.log
[05:47:35] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:47:35] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:47:38] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 99
          no. right trimmed                     : 1214
          no. left and right trimmed            : 70
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1383

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1383
       total no. variants observed              : 17203
       total no. reference observed             : 0

Time elapsed: 0.18s

[05:47:38] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:47:38] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:47:38] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:47:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:47:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:47:39] Running: bcftools consensus --sample IE-0021_S7-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:47:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:47:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:47:40] Running: bcftools consensus --sample IE-0021_S7-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:47:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:47:41] Running: rm -f fake_reads\.fq 2>> snps.log
[05:47:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:47:48] Marked 3363 heterozygous sites with 'n'
[05:47:48] Creating extra output files: BED GFF CSV TXT HTML
[05:47:48] Identified 17203 variants.
[05:47:48] Result folder: snippy_work/IE-0021_S7-SPAdes
[05:47:48] Result files:
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.aligned.fa
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.bam
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.bam.bai
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.bed
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.consensus.fa
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.consensus.subs.fa
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.csv
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.filt.vcf
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.gff
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.html
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.log
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.raw.vcf
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.subs.vcf
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.tab
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.txt
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.vcf
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.vcf.gz
[05:47:48] * snippy_work/IE-0021_S7-SPAdes/snps.vcf.gz.csi
[05:47:48] Walltime used: 29 seconds
[05:47:48] Questionable SNP? Try the --report option to see the alignments.
[05:47:48] Done.
[05:47:48] This is snippy 4.6.0
[05:47:48] Written by Torsten Seemann
[05:47:48] Obtained from https://github.com/tseemann/snippy
[05:47:48] Detected operating system: linux
[05:47:48] Enabling bundled linux tools.
[05:47:48] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:47:48] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:47:48] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:47:48] Found java - /usr/bin/java
[05:47:48] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:47:48] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:47:48] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:47:48] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:47:48] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:47:48] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:47:48] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:47:48] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:47:48] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:47:48] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:47:48] Found gzip - /bin/gzip
[05:47:48] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:47:48] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:47:48] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:47:48] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:47:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:47:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:47:48] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:47:48] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:47:48] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:47:48] Treating reference as 'fasta' format.
[05:47:48] Will use 16 CPU cores.
[05:47:48] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/cb/84fcfc41fc49d4487d08c003cd274f/inputfiles/IE-0022_S8-SPAdes.fasta
[05:47:48] Creating folder: snippy_work/IE-0022_S8-SPAdes
[05:47:48] Changing working directory: snippy_work/IE-0022_S8-SPAdes
[05:47:48] Creating reference folder: reference
[05:47:48] Extracting FASTA and GFF from reference.
[05:47:48] Wrote 205 sequences to ref.fa
[05:47:48] Wrote 0 features to ref.gff
[05:47:48] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/cb/84fcfc41fc49d4487d08c003cd274f/inputfiles/IE-0022_S8-SPAdes.fasta into pseudo-reads
[05:47:53] Wrote 571734 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:47:53] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:47:53] Using BAM RG (Read Group) ID: IE-0022_S8-SPAdes
[05:47:53] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:47:53] Running: bwa index reference/ref.fa 2>> snps.log
[05:47:56] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:47:56] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:47:56] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:47:56] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:47:56] Running: bwa mem  -Y -M -R '@RG\tID:IE-0022_S8-SPAdes\tSM:IE-0022_S8-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 571734 sequences (142933500 bp)...
[M::mem_process_seqs] Processed 571734 reads in 49.494 CPU sec, 3.491 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0022_S8-SPAdes\tSM:IE-0022_S8-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.612 sec; CPU: 50.665 sec
[samclip] Total SAM records 575388, removed 7745, allowed 7019, passed 567643
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:48:02] Running: samtools index snps.bam 2>> snps.log
[05:48:03] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:48:03] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:48:05] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 60
          no. right trimmed                     : 856
          no. left and right trimmed            : 48
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 964

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 964
       total no. variants observed              : 11279
       total no. reference observed             : 0

Time elapsed: 0.12s

[05:48:05] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:48:05] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:48:06] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:48:06] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:48:06] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:48:06] Running: bcftools consensus --sample IE-0022_S8-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:48:07] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:48:07] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:48:07] Running: bcftools consensus --sample IE-0022_S8-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:48:08] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:48:08] Running: rm -f fake_reads\.fq 2>> snps.log
[05:48:08] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:48:14] Marked 3892 heterozygous sites with 'n'
[05:48:14] Creating extra output files: BED GFF CSV TXT HTML
[05:48:15] Identified 11279 variants.
[05:48:15] Result folder: snippy_work/IE-0022_S8-SPAdes
[05:48:15] Result files:
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.aligned.fa
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.bam
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.bam.bai
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.bed
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.consensus.fa
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.consensus.subs.fa
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.csv
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.filt.vcf
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.gff
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.html
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.log
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.raw.vcf
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.subs.vcf
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.tab
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.txt
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.vcf
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.vcf.gz
[05:48:15] * snippy_work/IE-0022_S8-SPAdes/snps.vcf.gz.csi
[05:48:15] Walltime used: 27 seconds
[05:48:15] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[05:48:15] Done.
[05:48:15] This is snippy 4.6.0
[05:48:15] Written by Torsten Seemann
[05:48:15] Obtained from https://github.com/tseemann/snippy
[05:48:15] Detected operating system: linux
[05:48:15] Enabling bundled linux tools.
[05:48:15] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:48:15] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:48:15] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:48:15] Found java - /usr/bin/java
[05:48:15] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:48:15] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:48:15] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:48:15] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:48:15] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:48:15] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:48:15] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:48:15] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:48:15] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:48:15] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:48:15] Found gzip - /bin/gzip
[05:48:15] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:48:15] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:48:15] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:48:15] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:48:15] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:48:15] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:48:15] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:48:15] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:48:15] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:48:15] Treating reference as 'fasta' format.
[05:48:15] Will use 16 CPU cores.
[05:48:15] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/35/c984f3b75426f0c313cbad2ab49914/inputfiles/IE-0024_S10-SPAdes.fasta
[05:48:15] Creating folder: snippy_work/IE-0024_S10-SPAdes
[05:48:15] Changing working directory: snippy_work/IE-0024_S10-SPAdes
[05:48:15] Creating reference folder: reference
[05:48:15] Extracting FASTA and GFF from reference.
[05:48:15] Wrote 205 sequences to ref.fa
[05:48:15] Wrote 0 features to ref.gff
[05:48:15] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/35/c984f3b75426f0c313cbad2ab49914/inputfiles/IE-0024_S10-SPAdes.fasta into pseudo-reads
[05:48:19] Wrote 568786 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:48:19] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:48:19] Using BAM RG (Read Group) ID: IE-0024_S10-SPAdes
[05:48:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:48:19] Running: bwa index reference/ref.fa 2>> snps.log
[05:48:22] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:48:22] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:48:22] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:48:22] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:48:22] Running: bwa mem  -Y -M -R '@RG\tID:IE-0024_S10-SPAdes\tSM:IE-0024_S10-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 568786 sequences (142196500 bp)...
[M::mem_process_seqs] Processed 568786 reads in 59.577 CPU sec, 3.999 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0024_S10-SPAdes\tSM:IE-0024_S10-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.244 sec; CPU: 60.825 sec
[samclip] Total SAM records 574076, removed 13488, allowed 7358, passed 560588
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:48:29] Running: samtools index snps.bam 2>> snps.log
[05:48:30] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:48:30] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:48:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 120
          no. right trimmed                     : 1334
          no. left and right trimmed            : 68
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1522

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1522
       total no. variants observed              : 19984
       total no. reference observed             : 0

Time elapsed: 0.21s

[05:48:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:48:33] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:48:33] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:48:34] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:48:34] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:48:34] Running: bcftools consensus --sample IE-0024_S10-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:48:35] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:48:35] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:48:35] Running: bcftools consensus --sample IE-0024_S10-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:48:36] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:48:36] Running: rm -f fake_reads\.fq 2>> snps.log
[05:48:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:48:43] Marked 3401 heterozygous sites with 'n'
[05:48:43] Creating extra output files: BED GFF CSV TXT HTML
[05:48:43] Identified 19984 variants.
[05:48:43] Result folder: snippy_work/IE-0024_S10-SPAdes
[05:48:43] Result files:
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.aligned.fa
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.bam
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.bam.bai
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.bed
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.consensus.fa
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.consensus.subs.fa
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.csv
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.filt.vcf
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.gff
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.html
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.log
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.raw.vcf
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.subs.vcf
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.tab
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.txt
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.vcf
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.vcf.gz
[05:48:43] * snippy_work/IE-0024_S10-SPAdes/snps.vcf.gz.csi
[05:48:43] Walltime used: 28 seconds
[05:48:43] May the SNPs be with you.
[05:48:43] Done.
[05:48:43] This is snippy 4.6.0
[05:48:43] Written by Torsten Seemann
[05:48:43] Obtained from https://github.com/tseemann/snippy
[05:48:43] Detected operating system: linux
[05:48:43] Enabling bundled linux tools.
[05:48:43] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:48:43] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:48:43] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:48:43] Found java - /usr/bin/java
[05:48:43] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:48:43] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:48:43] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:48:43] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:48:43] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:48:43] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:48:43] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:48:43] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:48:43] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:48:43] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:48:43] Found gzip - /bin/gzip
[05:48:43] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:48:43] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:48:43] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:48:43] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:48:43] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:48:43] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:48:43] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:48:43] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:48:43] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:48:43] Treating reference as 'fasta' format.
[05:48:43] Will use 16 CPU cores.
[05:48:43] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/ae/ab87b34346c0c4a72708ad2ef0f9ca/inputfiles/IE-0026_S8-SPAdes.fasta
[05:48:43] Creating folder: snippy_work/IE-0026_S8-SPAdes
[05:48:43] Changing working directory: snippy_work/IE-0026_S8-SPAdes
[05:48:43] Creating reference folder: reference
[05:48:43] Extracting FASTA and GFF from reference.
[05:48:43] Wrote 205 sequences to ref.fa
[05:48:43] Wrote 0 features to ref.gff
[05:48:43] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/ae/ab87b34346c0c4a72708ad2ef0f9ca/inputfiles/IE-0026_S8-SPAdes.fasta into pseudo-reads
[05:48:48] Wrote 577402 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:48:48] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:48:48] Using BAM RG (Read Group) ID: IE-0026_S8-SPAdes
[05:48:48] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:48:48] Running: bwa index reference/ref.fa 2>> snps.log
[05:48:50] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:48:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:48:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:48:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:48:51] Running: bwa mem  -Y -M -R '@RG\tID:IE-0026_S8-SPAdes\tSM:IE-0026_S8-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 577402 sequences (144350500 bp)...
[M::mem_process_seqs] Processed 577402 reads in 43.872 CPU sec, 3.236 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IE-0026_S8-SPAdes\tSM:IE-0026_S8-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.484 sec; CPU: 45.364 sec
[samclip] Total SAM records 579513, removed 3784, allowed 6509, passed 575729
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:48:57] Running: samtools index snps.bam 2>> snps.log
[05:48:58] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:48:58] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:49:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 21
          no. right trimmed                     : 457
          no. left and right trimmed            : 24
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 502

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 502
       total no. variants observed              : 5517
       total no. reference observed             : 0

Time elapsed: 0.06s

[05:49:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:49:00] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:49:00] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:49:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:49:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:49:00] Running: bcftools consensus --sample IE-0026_S8-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:49:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:49:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:49:01] Running: bcftools consensus --sample IE-0026_S8-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:49:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:49:02] Running: rm -f fake_reads\.fq 2>> snps.log
[05:49:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:49:09] Marked 3917 heterozygous sites with 'n'
[05:49:09] Creating extra output files: BED GFF CSV TXT HTML
[05:49:09] Identified 5517 variants.
[05:49:09] Result folder: snippy_work/IE-0026_S8-SPAdes
[05:49:09] Result files:
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.aligned.fa
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.bam
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.bam.bai
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.bed
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.consensus.fa
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.consensus.subs.fa
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.csv
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.filt.vcf
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.gff
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.html
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.log
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.raw.vcf
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.subs.vcf
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.tab
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.txt
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.vcf
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.vcf.gz
[05:49:09] * snippy_work/IE-0026_S8-SPAdes/snps.vcf.gz.csi
[05:49:09] Walltime used: 26 seconds
[05:49:09] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[05:49:09] Done.
[05:49:09] This is snippy 4.6.0
[05:49:09] Written by Torsten Seemann
[05:49:09] Obtained from https://github.com/tseemann/snippy
[05:49:09] Detected operating system: linux
[05:49:09] Enabling bundled linux tools.
[05:49:09] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:49:09] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:49:09] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:49:09] Found java - /usr/bin/java
[05:49:09] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:49:09] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:49:09] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:49:09] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:49:09] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:49:09] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:49:09] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:49:09] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:49:09] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:49:09] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:49:09] Found gzip - /bin/gzip
[05:49:09] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:49:09] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:49:09] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:49:09] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:49:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:49:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:49:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:49:09] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:49:09] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:49:09] Treating reference as 'fasta' format.
[05:49:09] Will use 16 CPU cores.
[05:49:09] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/82/9a94c67f9d2cff0a1da32f6466f091/inputfiles/IP-0001-8_S1_L001-SPAdes.fasta
[05:49:09] Creating folder: snippy_work/IP-0001-8_S1_L001-SPAdes
[05:49:09] Changing working directory: snippy_work/IP-0001-8_S1_L001-SPAdes
[05:49:09] Creating reference folder: reference
[05:49:09] Extracting FASTA and GFF from reference.
[05:49:09] Wrote 205 sequences to ref.fa
[05:49:09] Wrote 0 features to ref.gff
[05:49:09] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/82/9a94c67f9d2cff0a1da32f6466f091/inputfiles/IP-0001-8_S1_L001-SPAdes.fasta into pseudo-reads
[05:49:14] Wrote 579052 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:49:14] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:49:14] Using BAM RG (Read Group) ID: IP-0001-8_S1_L001-SPAdes
[05:49:14] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:49:14] Running: bwa index reference/ref.fa 2>> snps.log
[05:49:17] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:49:17] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:49:17] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:49:17] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:49:17] Running: bwa mem  -Y -M -R '@RG\tID:IP-0001-8_S1_L001-SPAdes\tSM:IP-0001-8_S1_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 579052 sequences (144763000 bp)...
[M::mem_process_seqs] Processed 579052 reads in 59.738 CPU sec, 4.026 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0001-8_S1_L001-SPAdes\tSM:IP-0001-8_S1_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.243 sec; CPU: 60.964 sec
[samclip] Total SAM records 583556, removed 12286, allowed 7987, passed 571270
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:49:24] Running: samtools index snps.bam 2>> snps.log
[05:49:25] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:49:25] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:49:28] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 105
          no. right trimmed                     : 1331
          no. left and right trimmed            : 91
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1527

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1527
       total no. variants observed              : 20351
       total no. reference observed             : 0

Time elapsed: 0.21s

[05:49:28] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:49:28] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:49:29] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:49:29] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:49:29] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:49:29] Running: bcftools consensus --sample IP-0001-8_S1_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:49:30] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:49:30] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:49:30] Running: bcftools consensus --sample IP-0001-8_S1_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:49:31] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:49:31] Running: rm -f fake_reads\.fq 2>> snps.log
[05:49:32] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:49:38] Marked 4309 heterozygous sites with 'n'
[05:49:38] Creating extra output files: BED GFF CSV TXT HTML
[05:49:38] Identified 20351 variants.
[05:49:38] Result folder: snippy_work/IP-0001-8_S1_L001-SPAdes
[05:49:38] Result files:
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.aligned.fa
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.bam
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.bam.bai
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.bed
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.consensus.fa
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.consensus.subs.fa
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.csv
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.filt.vcf
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.gff
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.html
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.log
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.raw.vcf
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.subs.vcf
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.tab
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.txt
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.vcf
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.vcf.gz
[05:49:38] * snippy_work/IP-0001-8_S1_L001-SPAdes/snps.vcf.gz.csi
[05:49:38] Walltime used: 29 seconds
[05:49:38] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[05:49:38] Done.
[05:49:38] This is snippy 4.6.0
[05:49:38] Written by Torsten Seemann
[05:49:38] Obtained from https://github.com/tseemann/snippy
[05:49:38] Detected operating system: linux
[05:49:38] Enabling bundled linux tools.
[05:49:38] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:49:38] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:49:38] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:49:38] Found java - /usr/bin/java
[05:49:38] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:49:38] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:49:38] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:49:38] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:49:38] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:49:38] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:49:38] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:49:38] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:49:38] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:49:38] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:49:38] Found gzip - /bin/gzip
[05:49:38] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:49:38] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:49:38] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:49:38] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:49:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:49:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:49:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:49:39] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:49:39] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:49:39] Treating reference as 'fasta' format.
[05:49:39] Will use 16 CPU cores.
[05:49:39] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/7d/6a75d64022a9d3f89507c3d39242b1/inputfiles/IP-0002-6_S2_L001-SPAdes.fasta
[05:49:39] Creating folder: snippy_work/IP-0002-6_S2_L001-SPAdes
[05:49:39] Changing working directory: snippy_work/IP-0002-6_S2_L001-SPAdes
[05:49:39] Creating reference folder: reference
[05:49:39] Extracting FASTA and GFF from reference.
[05:49:39] Wrote 205 sequences to ref.fa
[05:49:39] Wrote 0 features to ref.gff
[05:49:39] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/7d/6a75d64022a9d3f89507c3d39242b1/inputfiles/IP-0002-6_S2_L001-SPAdes.fasta into pseudo-reads
[05:49:43] Wrote 565152 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:49:43] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:49:43] Using BAM RG (Read Group) ID: IP-0002-6_S2_L001-SPAdes
[05:49:43] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:49:43] Running: bwa index reference/ref.fa 2>> snps.log
[05:49:45] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:49:45] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:49:45] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:49:45] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:49:45] Running: bwa mem  -Y -M -R '@RG\tID:IP-0002-6_S2_L001-SPAdes\tSM:IP-0002-6_S2_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 565152 sequences (141288000 bp)...
[M::mem_process_seqs] Processed 565152 reads in 54.546 CPU sec, 3.681 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0002-6_S2_L001-SPAdes\tSM:IP-0002-6_S2_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.870 sec; CPU: 55.740 sec
[samclip] Total SAM records 569264, removed 12212, allowed 6219, passed 557052
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:49:53] Running: samtools index snps.bam 2>> snps.log
[05:49:53] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:49:53] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:49:56] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 112
          no. right trimmed                     : 1219
          no. left and right trimmed            : 80
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1411

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1411
       total no. variants observed              : 18588
       total no. reference observed             : 0

Time elapsed: 0.20s

[05:49:56] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:49:56] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:49:57] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:49:57] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:49:57] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:49:57] Running: bcftools consensus --sample IP-0002-6_S2_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:49:58] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:49:58] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:49:58] Running: bcftools consensus --sample IP-0002-6_S2_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:49:59] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:49:59] Running: rm -f fake_reads\.fq 2>> snps.log
[05:49:59] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:50:06] Marked 3854 heterozygous sites with 'n'
[05:50:06] Creating extra output files: BED GFF CSV TXT HTML
[05:50:06] Identified 18588 variants.
[05:50:06] Result folder: snippy_work/IP-0002-6_S2_L001-SPAdes
[05:50:06] Result files:
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.aligned.fa
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.bam
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.bam.bai
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.bed
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.consensus.fa
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.consensus.subs.fa
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.csv
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.filt.vcf
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.gff
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.html
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.log
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.raw.vcf
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.subs.vcf
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.tab
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.txt
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.vcf
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.vcf.gz
[05:50:06] * snippy_work/IP-0002-6_S2_L001-SPAdes/snps.vcf.gz.csi
[05:50:06] Walltime used: 28 seconds
[05:50:06] May the SNPs be with you.
[05:50:06] Done.
[05:50:06] This is snippy 4.6.0
[05:50:06] Written by Torsten Seemann
[05:50:06] Obtained from https://github.com/tseemann/snippy
[05:50:06] Detected operating system: linux
[05:50:06] Enabling bundled linux tools.
[05:50:06] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:50:06] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:50:06] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:50:06] Found java - /usr/bin/java
[05:50:06] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:50:06] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:50:06] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:50:06] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:50:06] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:50:06] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:50:06] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:50:06] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:50:06] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:50:06] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:50:06] Found gzip - /bin/gzip
[05:50:06] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:50:06] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:50:06] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:50:06] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:50:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:50:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:50:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:50:06] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:50:06] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:50:06] Treating reference as 'fasta' format.
[05:50:06] Will use 16 CPU cores.
[05:50:06] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/2d/0e0af9f129ecc47deb047870c56812/inputfiles/IP-0003-4_S3_L001-SPAdes.fasta
[05:50:06] Creating folder: snippy_work/IP-0003-4_S3_L001-SPAdes
[05:50:06] Changing working directory: snippy_work/IP-0003-4_S3_L001-SPAdes
[05:50:06] Creating reference folder: reference
[05:50:06] Extracting FASTA and GFF from reference.
[05:50:06] Wrote 205 sequences to ref.fa
[05:50:06] Wrote 0 features to ref.gff
[05:50:06] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/2d/0e0af9f129ecc47deb047870c56812/inputfiles/IP-0003-4_S3_L001-SPAdes.fasta into pseudo-reads
[05:50:11] Wrote 583352 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:50:11] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:50:11] Using BAM RG (Read Group) ID: IP-0003-4_S3_L001-SPAdes
[05:50:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:50:11] Running: bwa index reference/ref.fa 2>> snps.log
[05:50:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:50:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:50:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:50:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:50:13] Running: bwa mem  -Y -M -R '@RG\tID:IP-0003-4_S3_L001-SPAdes\tSM:IP-0003-4_S3_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 583352 sequences (145838000 bp)...
[M::mem_process_seqs] Processed 583352 reads in 56.162 CPU sec, 3.711 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0003-4_S3_L001-SPAdes\tSM:IP-0003-4_S3_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.964 sec; CPU: 57.362 sec
[samclip] Total SAM records 588401, removed 13245, allowed 8198, passed 575156
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:50:20] Running: samtools index snps.bam 2>> snps.log
[05:50:21] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:50:21] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:50:24] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 113
          no. right trimmed                     : 1377
          no. left and right trimmed            : 72
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1562

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1562
       total no. variants observed              : 19920
       total no. reference observed             : 0

Time elapsed: 0.21s

[05:50:24] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:50:24] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:50:24] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:50:25] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:50:25] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:50:25] Running: bcftools consensus --sample IP-0003-4_S3_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:50:26] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:50:26] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:50:26] Running: bcftools consensus --sample IP-0003-4_S3_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:50:27] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:50:27] Running: rm -f fake_reads\.fq 2>> snps.log
[05:50:27] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:50:33] Marked 4452 heterozygous sites with 'n'
[05:50:33] Creating extra output files: BED GFF CSV TXT HTML
[05:50:34] Identified 19920 variants.
[05:50:34] Result folder: snippy_work/IP-0003-4_S3_L001-SPAdes
[05:50:34] Result files:
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.aligned.fa
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.bam
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.bam.bai
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.bed
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.consensus.fa
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.consensus.subs.fa
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.csv
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.filt.vcf
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.gff
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.html
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.log
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.raw.vcf
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.subs.vcf
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.tab
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.txt
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.vcf
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.vcf.gz
[05:50:34] * snippy_work/IP-0003-4_S3_L001-SPAdes/snps.vcf.gz.csi
[05:50:34] Walltime used: 28 seconds
[05:50:34] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[05:50:34] Done.
[05:50:34] This is snippy 4.6.0
[05:50:34] Written by Torsten Seemann
[05:50:34] Obtained from https://github.com/tseemann/snippy
[05:50:34] Detected operating system: linux
[05:50:34] Enabling bundled linux tools.
[05:50:34] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:50:34] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:50:34] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:50:34] Found java - /usr/bin/java
[05:50:34] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:50:34] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:50:34] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:50:34] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:50:34] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:50:34] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:50:34] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:50:34] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:50:34] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:50:34] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:50:34] Found gzip - /bin/gzip
[05:50:34] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:50:34] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:50:34] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:50:34] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:50:34] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:50:34] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:50:34] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:50:34] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:50:34] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:50:34] Treating reference as 'fasta' format.
[05:50:34] Will use 16 CPU cores.
[05:50:34] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/3d/8f5de40b4dbb1071498cc0398a4316/inputfiles/IP-0004-2_S4_L001-SPAdes.fasta
[05:50:34] Creating folder: snippy_work/IP-0004-2_S4_L001-SPAdes
[05:50:34] Changing working directory: snippy_work/IP-0004-2_S4_L001-SPAdes
[05:50:34] Creating reference folder: reference
[05:50:34] Extracting FASTA and GFF from reference.
[05:50:34] Wrote 205 sequences to ref.fa
[05:50:34] Wrote 0 features to ref.gff
[05:50:34] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/3d/8f5de40b4dbb1071498cc0398a4316/inputfiles/IP-0004-2_S4_L001-SPAdes.fasta into pseudo-reads
[05:50:38] Wrote 578694 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:50:38] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:50:38] Using BAM RG (Read Group) ID: IP-0004-2_S4_L001-SPAdes
[05:50:38] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:50:39] Running: bwa index reference/ref.fa 2>> snps.log
[05:50:41] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:50:41] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:50:41] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:50:41] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:50:41] Running: bwa mem  -Y -M -R '@RG\tID:IP-0004-2_S4_L001-SPAdes\tSM:IP-0004-2_S4_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 578694 sequences (144673500 bp)...
[M::mem_process_seqs] Processed 578694 reads in 56.997 CPU sec, 3.799 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0004-2_S4_L001-SPAdes\tSM:IP-0004-2_S4_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.085 sec; CPU: 58.297 sec
[samclip] Total SAM records 583311, removed 12504, allowed 7609, passed 570807
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:50:49] Running: samtools index snps.bam 2>> snps.log
[05:50:49] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:50:49] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:50:52] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 107
          no. right trimmed                     : 1306
          no. left and right trimmed            : 78
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1491

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1491
       total no. variants observed              : 20229
       total no. reference observed             : 0

Time elapsed: 0.21s

[05:50:52] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:50:52] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:50:52] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:50:53] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:50:53] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:50:53] Running: bcftools consensus --sample IP-0004-2_S4_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:50:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:50:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:50:54] Running: bcftools consensus --sample IP-0004-2_S4_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:50:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:50:55] Running: rm -f fake_reads\.fq 2>> snps.log
[05:50:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:51:02] Marked 3271 heterozygous sites with 'n'
[05:51:02] Creating extra output files: BED GFF CSV TXT HTML
[05:51:02] Identified 20229 variants.
[05:51:02] Result folder: snippy_work/IP-0004-2_S4_L001-SPAdes
[05:51:02] Result files:
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.aligned.fa
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.bam
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.bam.bai
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.bed
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.consensus.fa
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.consensus.subs.fa
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.csv
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.filt.vcf
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.gff
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.html
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.log
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.raw.vcf
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.subs.vcf
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.tab
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.txt
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.vcf
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.vcf.gz
[05:51:02] * snippy_work/IP-0004-2_S4_L001-SPAdes/snps.vcf.gz.csi
[05:51:02] Walltime used: 28 seconds
[05:51:02] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[05:51:02] Done.
[05:51:02] This is snippy 4.6.0
[05:51:02] Written by Torsten Seemann
[05:51:02] Obtained from https://github.com/tseemann/snippy
[05:51:02] Detected operating system: linux
[05:51:02] Enabling bundled linux tools.
[05:51:02] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:51:02] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:51:02] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:51:02] Found java - /usr/bin/java
[05:51:02] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:51:02] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:51:02] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:51:02] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:51:02] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:51:02] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:51:02] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:51:02] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:51:02] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:51:02] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:51:02] Found gzip - /bin/gzip
[05:51:02] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:51:02] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:51:02] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:51:02] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:51:02] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:51:02] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:51:02] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:51:02] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:51:02] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:51:02] Treating reference as 'fasta' format.
[05:51:02] Will use 16 CPU cores.
[05:51:02] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/b8/7e74716e8ab7c3e2b458e0be461006/inputfiles/IP-0005-9_S5_L001-SPAdes.fasta
[05:51:02] Creating folder: snippy_work/IP-0005-9_S5_L001-SPAdes
[05:51:02] Changing working directory: snippy_work/IP-0005-9_S5_L001-SPAdes
[05:51:02] Creating reference folder: reference
[05:51:02] Extracting FASTA and GFF from reference.
[05:51:02] Wrote 205 sequences to ref.fa
[05:51:02] Wrote 0 features to ref.gff
[05:51:02] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/b8/7e74716e8ab7c3e2b458e0be461006/inputfiles/IP-0005-9_S5_L001-SPAdes.fasta into pseudo-reads
[05:51:07] Wrote 582016 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:51:07] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:51:07] Using BAM RG (Read Group) ID: IP-0005-9_S5_L001-SPAdes
[05:51:07] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:51:07] Running: bwa index reference/ref.fa 2>> snps.log
[05:51:09] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:51:09] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:51:09] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:51:09] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:51:09] Running: bwa mem  -Y -M -R '@RG\tID:IP-0005-9_S5_L001-SPAdes\tSM:IP-0005-9_S5_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 582016 sequences (145504000 bp)...
[M::mem_process_seqs] Processed 582016 reads in 42.886 CPU sec, 3.237 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0005-9_S5_L001-SPAdes\tSM:IP-0005-9_S5_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.464 sec; CPU: 44.247 sec
[samclip] Total SAM records 583948, removed 3643, allowed 5871, passed 580305
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:51:16] Running: samtools index snps.bam 2>> snps.log
[05:51:16] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:51:16] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:51:18] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 12
          no. right trimmed                     : 326
          no. left and right trimmed            : 19
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 357

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 357
       total no. variants observed              : 3418
       total no. reference observed             : 0

Time elapsed: 0.04s

[05:51:18] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:51:18] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:51:18] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:51:18] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:51:19] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:51:19] Running: bcftools consensus --sample IP-0005-9_S5_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:51:19] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:51:19] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:51:19] Running: bcftools consensus --sample IP-0005-9_S5_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:51:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:51:20] Running: rm -f fake_reads\.fq 2>> snps.log
[05:51:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:51:26] Marked 3612 heterozygous sites with 'n'
[05:51:26] Creating extra output files: BED GFF CSV TXT HTML
[05:51:26] Identified 3418 variants.
[05:51:26] Result folder: snippy_work/IP-0005-9_S5_L001-SPAdes
[05:51:26] Result files:
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.aligned.fa
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.bam
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.bam.bai
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.bed
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.consensus.fa
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.consensus.subs.fa
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.csv
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.filt.vcf
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.gff
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.html
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.log
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.raw.vcf
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.subs.vcf
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.tab
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.txt
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.vcf
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.vcf.gz
[05:51:26] * snippy_work/IP-0005-9_S5_L001-SPAdes/snps.vcf.gz.csi
[05:51:26] Walltime used: 24 seconds
[05:51:26] Questionable SNP? Try the --report option to see the alignments.
[05:51:26] Done.
[05:51:27] This is snippy 4.6.0
[05:51:27] Written by Torsten Seemann
[05:51:27] Obtained from https://github.com/tseemann/snippy
[05:51:27] Detected operating system: linux
[05:51:27] Enabling bundled linux tools.
[05:51:27] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:51:27] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:51:27] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:51:27] Found java - /usr/bin/java
[05:51:27] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:51:27] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:51:27] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:51:27] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:51:27] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:51:27] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:51:27] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:51:27] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:51:27] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:51:27] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:51:27] Found gzip - /bin/gzip
[05:51:27] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:51:27] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:51:27] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:51:27] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:51:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:51:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:51:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:51:27] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:51:27] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:51:27] Treating reference as 'fasta' format.
[05:51:27] Will use 16 CPU cores.
[05:51:27] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/fb/0cfc61a92cc6239356034de3910d84/inputfiles/IP-0006-7_S6_L001-SPAdes.fasta
[05:51:27] Creating folder: snippy_work/IP-0006-7_S6_L001-SPAdes
[05:51:27] Changing working directory: snippy_work/IP-0006-7_S6_L001-SPAdes
[05:51:27] Creating reference folder: reference
[05:51:27] Extracting FASTA and GFF from reference.
[05:51:27] Wrote 205 sequences to ref.fa
[05:51:27] Wrote 0 features to ref.gff
[05:51:27] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/fb/0cfc61a92cc6239356034de3910d84/inputfiles/IP-0006-7_S6_L001-SPAdes.fasta into pseudo-reads
[05:51:31] Wrote 576828 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:51:31] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:51:31] Using BAM RG (Read Group) ID: IP-0006-7_S6_L001-SPAdes
[05:51:31] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:51:31] Running: bwa index reference/ref.fa 2>> snps.log
[05:51:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:51:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:51:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:51:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:51:35] Running: bwa mem  -Y -M -R '@RG\tID:IP-0006-7_S6_L001-SPAdes\tSM:IP-0006-7_S6_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 576828 sequences (144207000 bp)...
[M::mem_process_seqs] Processed 576828 reads in 56.151 CPU sec, 3.701 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0006-7_S6_L001-SPAdes\tSM:IP-0006-7_S6_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.865 sec; CPU: 57.315 sec
[samclip] Total SAM records 581129, removed 11941, allowed 7135, passed 569188
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:51:42] Running: samtools index snps.bam 2>> snps.log
[05:51:42] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:51:42] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:51:45] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 113
          no. right trimmed                     : 1225
          no. left and right trimmed            : 83
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1421

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1421
       total no. variants observed              : 19132
       total no. reference observed             : 0

Time elapsed: 0.20s

[05:51:45] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:51:45] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:51:45] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:51:46] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:51:46] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:51:46] Running: bcftools consensus --sample IP-0006-7_S6_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:51:47] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:51:47] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:51:47] Running: bcftools consensus --sample IP-0006-7_S6_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:51:48] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:51:48] Running: rm -f fake_reads\.fq 2>> snps.log
[05:51:48] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:51:55] Marked 3615 heterozygous sites with 'n'
[05:51:55] Creating extra output files: BED GFF CSV TXT HTML
[05:51:55] Identified 19132 variants.
[05:51:55] Result folder: snippy_work/IP-0006-7_S6_L001-SPAdes
[05:51:55] Result files:
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.aligned.fa
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.bam
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.bam.bai
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.bed
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.consensus.fa
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.consensus.subs.fa
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.csv
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.filt.vcf
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.gff
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.html
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.log
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.raw.vcf
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.subs.vcf
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.tab
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.txt
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.vcf
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.vcf.gz
[05:51:55] * snippy_work/IP-0006-7_S6_L001-SPAdes/snps.vcf.gz.csi
[05:51:55] Walltime used: 28 seconds
[05:51:55] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[05:51:55] Done.
[05:51:55] This is snippy 4.6.0
[05:51:55] Written by Torsten Seemann
[05:51:55] Obtained from https://github.com/tseemann/snippy
[05:51:55] Detected operating system: linux
[05:51:55] Enabling bundled linux tools.
[05:51:55] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:51:55] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:51:55] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:51:55] Found java - /usr/bin/java
[05:51:55] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:51:55] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:51:55] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:51:55] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:51:55] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:51:55] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:51:55] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:51:55] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:51:55] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:51:55] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:51:55] Found gzip - /bin/gzip
[05:51:55] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:51:55] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:51:55] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:51:55] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:51:55] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:51:55] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:51:55] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:51:55] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:51:55] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:51:55] Treating reference as 'fasta' format.
[05:51:55] Will use 16 CPU cores.
[05:51:55] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/b8/51643c847df97a47fc46d2baf69085/inputfiles/IP-0007-5_S7_L001-SPAdes.fasta
[05:51:55] Creating folder: snippy_work/IP-0007-5_S7_L001-SPAdes
[05:51:55] Changing working directory: snippy_work/IP-0007-5_S7_L001-SPAdes
[05:51:55] Creating reference folder: reference
[05:51:55] Extracting FASTA and GFF from reference.
[05:51:56] Wrote 205 sequences to ref.fa
[05:51:56] Wrote 0 features to ref.gff
[05:51:56] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/b8/51643c847df97a47fc46d2baf69085/inputfiles/IP-0007-5_S7_L001-SPAdes.fasta into pseudo-reads
[05:52:00] Wrote 572826 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:52:00] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:52:00] Using BAM RG (Read Group) ID: IP-0007-5_S7_L001-SPAdes
[05:52:00] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:52:00] Running: bwa index reference/ref.fa 2>> snps.log
[05:52:02] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:52:02] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:52:02] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:52:02] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:52:02] Running: bwa mem  -Y -M -R '@RG\tID:IP-0007-5_S7_L001-SPAdes\tSM:IP-0007-5_S7_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 572826 sequences (143206500 bp)...
[M::mem_process_seqs] Processed 572826 reads in 59.255 CPU sec, 3.952 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0007-5_S7_L001-SPAdes\tSM:IP-0007-5_S7_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.155 sec; CPU: 60.459 sec
[samclip] Total SAM records 577667, removed 12940, allowed 7966, passed 564727
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:52:10] Running: samtools index snps.bam 2>> snps.log
[05:52:10] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:52:10] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:52:13] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 107
          no. right trimmed                     : 1321
          no. left and right trimmed            : 97
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1525

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1525
       total no. variants observed              : 20368
       total no. reference observed             : 0

Time elapsed: 0.21s

[05:52:13] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:52:13] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:52:14] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:52:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:52:14] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:52:14] Running: bcftools consensus --sample IP-0007-5_S7_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:52:15] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:52:15] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:52:15] Running: bcftools consensus --sample IP-0007-5_S7_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:52:16] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:52:16] Running: rm -f fake_reads\.fq 2>> snps.log
[05:52:17] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:52:23] Marked 4254 heterozygous sites with 'n'
[05:52:23] Creating extra output files: BED GFF CSV TXT HTML
[05:52:23] Identified 20368 variants.
[05:52:23] Result folder: snippy_work/IP-0007-5_S7_L001-SPAdes
[05:52:23] Result files:
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.aligned.fa
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.bam
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.bam.bai
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.bed
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.consensus.fa
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.consensus.subs.fa
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.csv
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.filt.vcf
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.gff
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.html
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.log
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.raw.vcf
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.subs.vcf
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.tab
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.txt
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.vcf
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.vcf.gz
[05:52:23] * snippy_work/IP-0007-5_S7_L001-SPAdes/snps.vcf.gz.csi
[05:52:23] Walltime used: 28 seconds
[05:52:23] Wishing you a life free of homopolymer errors.
[05:52:23] Done.
[05:52:23] This is snippy 4.6.0
[05:52:23] Written by Torsten Seemann
[05:52:23] Obtained from https://github.com/tseemann/snippy
[05:52:23] Detected operating system: linux
[05:52:23] Enabling bundled linux tools.
[05:52:23] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:52:23] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:52:23] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:52:23] Found java - /usr/bin/java
[05:52:23] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:52:23] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:52:23] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:52:23] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:52:23] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:52:23] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:52:23] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:52:23] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:52:23] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:52:23] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:52:23] Found gzip - /bin/gzip
[05:52:24] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:52:24] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:52:24] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:52:24] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:52:24] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:52:24] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:52:24] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:52:24] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:52:24] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:52:24] Treating reference as 'fasta' format.
[05:52:24] Will use 16 CPU cores.
[05:52:24] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/67/1659a30f001048200f4940a91a1205/inputfiles/IP-0008-3_S8_L001-SPAdes.fasta
[05:52:24] Creating folder: snippy_work/IP-0008-3_S8_L001-SPAdes
[05:52:24] Changing working directory: snippy_work/IP-0008-3_S8_L001-SPAdes
[05:52:24] Creating reference folder: reference
[05:52:24] Extracting FASTA and GFF from reference.
[05:52:24] Wrote 205 sequences to ref.fa
[05:52:24] Wrote 0 features to ref.gff
[05:52:24] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/67/1659a30f001048200f4940a91a1205/inputfiles/IP-0008-3_S8_L001-SPAdes.fasta into pseudo-reads
[05:52:28] Wrote 567932 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:52:28] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:52:28] Using BAM RG (Read Group) ID: IP-0008-3_S8_L001-SPAdes
[05:52:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:52:28] Running: bwa index reference/ref.fa 2>> snps.log
[05:52:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:52:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:52:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:52:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:52:31] Running: bwa mem  -Y -M -R '@RG\tID:IP-0008-3_S8_L001-SPAdes\tSM:IP-0008-3_S8_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 567932 sequences (141983000 bp)...
[M::mem_process_seqs] Processed 567932 reads in 58.246 CPU sec, 3.821 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0008-3_S8_L001-SPAdes\tSM:IP-0008-3_S8_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.963 sec; CPU: 59.398 sec
[samclip] Total SAM records 572753, removed 11790, allowed 8526, passed 560963
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:52:38] Running: samtools index snps.bam 2>> snps.log
[05:52:39] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:52:39] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:52:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 116
          no. right trimmed                     : 1294
          no. left and right trimmed            : 73
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1483

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1483
       total no. variants observed              : 19150
       total no. reference observed             : 0

Time elapsed: 0.20s

[05:52:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:52:41] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:52:42] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:52:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:52:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:52:42] Running: bcftools consensus --sample IP-0008-3_S8_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:52:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:52:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:52:43] Running: bcftools consensus --sample IP-0008-3_S8_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:52:44] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:52:44] Running: rm -f fake_reads\.fq 2>> snps.log
[05:52:45] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:52:51] Marked 3605 heterozygous sites with 'n'
[05:52:51] Creating extra output files: BED GFF CSV TXT HTML
[05:52:51] Identified 19150 variants.
[05:52:51] Result folder: snippy_work/IP-0008-3_S8_L001-SPAdes
[05:52:51] Result files:
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.aligned.fa
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.bam
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.bam.bai
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.bed
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.consensus.fa
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.consensus.subs.fa
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.csv
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.filt.vcf
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.gff
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.html
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.log
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.raw.vcf
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.subs.vcf
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.tab
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.txt
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.vcf
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.vcf.gz
[05:52:51] * snippy_work/IP-0008-3_S8_L001-SPAdes/snps.vcf.gz.csi
[05:52:51] Walltime used: 28 seconds
[05:52:51] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[05:52:51] Done.
[05:52:51] This is snippy 4.6.0
[05:52:51] Written by Torsten Seemann
[05:52:51] Obtained from https://github.com/tseemann/snippy
[05:52:51] Detected operating system: linux
[05:52:51] Enabling bundled linux tools.
[05:52:51] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:52:51] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:52:51] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:52:51] Found java - /usr/bin/java
[05:52:51] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:52:51] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:52:51] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:52:51] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:52:51] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:52:51] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:52:51] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:52:51] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:52:51] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:52:51] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:52:51] Found gzip - /bin/gzip
[05:52:51] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:52:51] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:52:51] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:52:51] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:52:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:52:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:52:52] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:52:52] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:52:52] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:52:52] Treating reference as 'fasta' format.
[05:52:52] Will use 16 CPU cores.
[05:52:52] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/01/4eb0fda51b0cdad28747ccc22c3f7f/inputfiles/IP-0009-1_S9_L001-SPAdes.fasta
[05:52:52] Creating folder: snippy_work/IP-0009-1_S9_L001-SPAdes
[05:52:52] Changing working directory: snippy_work/IP-0009-1_S9_L001-SPAdes
[05:52:52] Creating reference folder: reference
[05:52:52] Extracting FASTA and GFF from reference.
[05:52:52] Wrote 205 sequences to ref.fa
[05:52:52] Wrote 0 features to ref.gff
[05:52:52] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/01/4eb0fda51b0cdad28747ccc22c3f7f/inputfiles/IP-0009-1_S9_L001-SPAdes.fasta into pseudo-reads
[05:52:56] Wrote 564048 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:52:56] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:52:56] Using BAM RG (Read Group) ID: IP-0009-1_S9_L001-SPAdes
[05:52:56] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:52:56] Running: bwa index reference/ref.fa 2>> snps.log
[05:52:59] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:52:59] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:52:59] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:52:59] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:52:59] Running: bwa mem  -Y -M -R '@RG\tID:IP-0009-1_S9_L001-SPAdes\tSM:IP-0009-1_S9_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 564048 sequences (141012000 bp)...
[M::mem_process_seqs] Processed 564048 reads in 54.961 CPU sec, 3.641 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0009-1_S9_L001-SPAdes\tSM:IP-0009-1_S9_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.776 sec; CPU: 56.146 sec
[samclip] Total SAM records 567112, removed 10023, allowed 5587, passed 557089
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:53:06] Running: samtools index snps.bam 2>> snps.log
[05:53:06] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:53:07] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:53:09] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 93
          no. right trimmed                     : 1235
          no. left and right trimmed            : 71
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1399

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1399
       total no. variants observed              : 17981
       total no. reference observed             : 0

Time elapsed: 0.19s

[05:53:09] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:53:09] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:53:10] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:53:10] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:53:10] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:53:10] Running: bcftools consensus --sample IP-0009-1_S9_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:53:11] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:53:11] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:53:11] Running: bcftools consensus --sample IP-0009-1_S9_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:53:12] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:53:12] Running: rm -f fake_reads\.fq 2>> snps.log
[05:53:12] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:53:19] Marked 3498 heterozygous sites with 'n'
[05:53:19] Creating extra output files: BED GFF CSV TXT HTML
[05:53:19] Identified 17981 variants.
[05:53:19] Result folder: snippy_work/IP-0009-1_S9_L001-SPAdes
[05:53:19] Result files:
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.aligned.fa
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.bam
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.bam.bai
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.bed
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.consensus.fa
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.consensus.subs.fa
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.csv
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.filt.vcf
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.gff
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.html
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.log
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.raw.vcf
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.subs.vcf
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.tab
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.txt
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.vcf
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.vcf.gz
[05:53:19] * snippy_work/IP-0009-1_S9_L001-SPAdes/snps.vcf.gz.csi
[05:53:19] Walltime used: 28 seconds
[05:53:19] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[05:53:19] Done.
[05:53:19] This is snippy 4.6.0
[05:53:19] Written by Torsten Seemann
[05:53:19] Obtained from https://github.com/tseemann/snippy
[05:53:19] Detected operating system: linux
[05:53:19] Enabling bundled linux tools.
[05:53:19] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:53:19] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:53:19] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:53:19] Found java - /usr/bin/java
[05:53:19] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:53:19] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:53:19] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:53:19] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:53:19] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:53:19] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:53:19] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:53:19] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:53:19] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:53:19] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:53:19] Found gzip - /bin/gzip
[05:53:19] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:53:19] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:53:19] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:53:19] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:53:19] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:53:19] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:53:19] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:53:19] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:53:19] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:53:19] Treating reference as 'fasta' format.
[05:53:19] Will use 16 CPU cores.
[05:53:19] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/0e/e676086405e2f38e5266f6ad469e95/inputfiles/IP-0010-9_S10_L001-SPAdes.fasta
[05:53:19] Creating folder: snippy_work/IP-0010-9_S10_L001-SPAdes
[05:53:19] Changing working directory: snippy_work/IP-0010-9_S10_L001-SPAdes
[05:53:19] Creating reference folder: reference
[05:53:19] Extracting FASTA and GFF from reference.
[05:53:19] Wrote 205 sequences to ref.fa
[05:53:19] Wrote 0 features to ref.gff
[05:53:19] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/0e/e676086405e2f38e5266f6ad469e95/inputfiles/IP-0010-9_S10_L001-SPAdes.fasta into pseudo-reads
[05:53:24] Wrote 582832 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:53:24] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:53:24] Using BAM RG (Read Group) ID: IP-0010-9_S10_L001-SPAdes
[05:53:24] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:53:24] Running: bwa index reference/ref.fa 2>> snps.log
[05:53:26] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:53:27] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:53:27] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:53:27] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:53:27] Running: bwa mem  -Y -M -R '@RG\tID:IP-0010-9_S10_L001-SPAdes\tSM:IP-0010-9_S10_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 582832 sequences (145708000 bp)...
[M::mem_process_seqs] Processed 582832 reads in 58.659 CPU sec, 3.899 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0010-9_S10_L001-SPAdes\tSM:IP-0010-9_S10_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq[samclip] Total SAM records 587289, removed 13378, allowed 6830, passed 573911

[main] Real time: 6.200 sec; CPU: 59.937 sec
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:53:34] Running: samtools index snps.bam 2>> snps.log
[05:53:35] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:53:35] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:53:37] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 101
          no. right trimmed                     : 1275
          no. left and right trimmed            : 89
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1465

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1465
       total no. variants observed              : 20097
       total no. reference observed             : 0

Time elapsed: 0.21s

[05:53:38] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:53:38] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:53:38] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:53:38] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:53:38] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:53:38] Running: bcftools consensus --sample IP-0010-9_S10_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:53:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:53:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:53:40] Running: bcftools consensus --sample IP-0010-9_S10_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:53:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:53:41] Running: rm -f fake_reads\.fq 2>> snps.log
[05:53:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:53:47] Marked 4203 heterozygous sites with 'n'
[05:53:47] Creating extra output files: BED GFF CSV TXT HTML
[05:53:47] Identified 20097 variants.
[05:53:47] Result folder: snippy_work/IP-0010-9_S10_L001-SPAdes
[05:53:47] Result files:
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.aligned.fa
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.bam
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.bam.bai
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.bed
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.consensus.fa
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.consensus.subs.fa
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.csv
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.filt.vcf
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.gff
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.html
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.log
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.raw.vcf
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.subs.vcf
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.tab
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.txt
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.vcf
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.vcf.gz
[05:53:47] * snippy_work/IP-0010-9_S10_L001-SPAdes/snps.vcf.gz.csi
[05:53:47] Walltime used: 28 seconds
[05:53:47] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[05:53:47] Done.
[05:53:48] This is snippy 4.6.0
[05:53:48] Written by Torsten Seemann
[05:53:48] Obtained from https://github.com/tseemann/snippy
[05:53:48] Detected operating system: linux
[05:53:48] Enabling bundled linux tools.
[05:53:48] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:53:48] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:53:48] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:53:48] Found java - /usr/bin/java
[05:53:48] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:53:48] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:53:48] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:53:48] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:53:48] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:53:48] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:53:48] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:53:48] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:53:48] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:53:48] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:53:48] Found gzip - /bin/gzip
[05:53:48] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:53:48] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:53:48] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:53:48] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:53:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:53:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:53:48] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:53:48] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:53:48] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:53:48] Treating reference as 'fasta' format.
[05:53:48] Will use 16 CPU cores.
[05:53:48] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/72/0fa4c65b5d50f1fda75f4db0bef824/inputfiles/IP-0011-7_S2_L001-SPAdes.fasta
[05:53:48] Creating folder: snippy_work/IP-0011-7_S2_L001-SPAdes
[05:53:48] Changing working directory: snippy_work/IP-0011-7_S2_L001-SPAdes
[05:53:48] Creating reference folder: reference
[05:53:48] Extracting FASTA and GFF from reference.
[05:53:48] Wrote 205 sequences to ref.fa
[05:53:48] Wrote 0 features to ref.gff
[05:53:48] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/72/0fa4c65b5d50f1fda75f4db0bef824/inputfiles/IP-0011-7_S2_L001-SPAdes.fasta into pseudo-reads
[05:53:52] Wrote 575776 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:53:52] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:53:52] Using BAM RG (Read Group) ID: IP-0011-7_S2_L001-SPAdes
[05:53:52] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:53:52] Running: bwa index reference/ref.fa 2>> snps.log
[05:53:55] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:53:55] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:53:55] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:53:55] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:53:55] Running: bwa mem  -Y -M -R '@RG\tID:IP-0011-7_S2_L001-SPAdes\tSM:IP-0011-7_S2_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 575776 sequences (143944000 bp)...
[M::mem_process_seqs] Processed 575776 reads in 51.730 CPU sec, 3.590 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0011-7_S2_L001-SPAdes\tSM:IP-0011-7_S2_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.757 sec; CPU: 52.908 sec
[samclip] Total SAM records 579703, removed 9922, allowed 6663, passed 569781
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:54:02] Running: samtools index snps.bam 2>> snps.log
[05:54:02] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:54:02] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:54:05] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 70
          no. right trimmed                     : 1018
          no. left and right trimmed            : 61
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1149

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1149
       total no. variants observed              : 14347
       total no. reference observed             : 0

Time elapsed: 0.15s

[05:54:05] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:54:05] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:54:05] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:54:06] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:54:06] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:54:06] Running: bcftools consensus --sample IP-0011-7_S2_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:54:07] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:54:07] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:54:07] Running: bcftools consensus --sample IP-0011-7_S2_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:54:08] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:54:08] Running: rm -f fake_reads\.fq 2>> snps.log
[05:54:08] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:54:14] Marked 4370 heterozygous sites with 'n'
[05:54:14] Creating extra output files: BED GFF CSV TXT HTML
[05:54:15] Identified 14347 variants.
[05:54:15] Result folder: snippy_work/IP-0011-7_S2_L001-SPAdes
[05:54:15] Result files:
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.aligned.fa
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.bam
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.bam.bai
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.bed
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.consensus.fa
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.consensus.subs.fa
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.csv
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.filt.vcf
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.gff
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.html
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.log
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.raw.vcf
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.subs.vcf
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.tab
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.txt
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.vcf
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.vcf.gz
[05:54:15] * snippy_work/IP-0011-7_S2_L001-SPAdes/snps.vcf.gz.csi
[05:54:15] Walltime used: 27 seconds
[05:54:15] Questionable SNP? Try the --report option to see the alignments.
[05:54:15] Done.
[05:54:15] This is snippy 4.6.0
[05:54:15] Written by Torsten Seemann
[05:54:15] Obtained from https://github.com/tseemann/snippy
[05:54:15] Detected operating system: linux
[05:54:15] Enabling bundled linux tools.
[05:54:15] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:54:15] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:54:15] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:54:15] Found java - /usr/bin/java
[05:54:15] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:54:15] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:54:15] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:54:15] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:54:15] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:54:15] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:54:15] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:54:15] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:54:15] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:54:15] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:54:15] Found gzip - /bin/gzip
[05:54:15] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:54:15] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:54:15] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:54:15] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:54:15] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:54:15] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:54:15] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:54:15] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:54:15] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:54:15] Treating reference as 'fasta' format.
[05:54:15] Will use 16 CPU cores.
[05:54:15] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/de/3e99bb9ed45aca73e87e411e9cfc5a/inputfiles/IP-0012-5_S3_L001-SPAdes.fasta
[05:54:15] Creating folder: snippy_work/IP-0012-5_S3_L001-SPAdes
[05:54:15] Changing working directory: snippy_work/IP-0012-5_S3_L001-SPAdes
[05:54:15] Creating reference folder: reference
[05:54:15] Extracting FASTA and GFF from reference.
[05:54:15] Wrote 205 sequences to ref.fa
[05:54:15] Wrote 0 features to ref.gff
[05:54:15] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/de/3e99bb9ed45aca73e87e411e9cfc5a/inputfiles/IP-0012-5_S3_L001-SPAdes.fasta into pseudo-reads
[05:54:20] Wrote 574208 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:54:20] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:54:20] Using BAM RG (Read Group) ID: IP-0012-5_S3_L001-SPAdes
[05:54:20] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:54:20] Running: bwa index reference/ref.fa 2>> snps.log
[05:54:23] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:54:23] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:54:23] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:54:23] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:54:23] Running: bwa mem  -Y -M -R '@RG\tID:IP-0012-5_S3_L001-SPAdes\tSM:IP-0012-5_S3_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 574208 sequences (143552000 bp)...
[M::mem_process_seqs] Processed 574208 reads in 54.547 CPU sec, 3.717 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0012-5_S3_L001-SPAdes\tSM:IP-0012-5_S3_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.940 sec; CPU: 55.767 sec
[samclip] Total SAM records 578273, removed 10646, allowed 7741, passed 567627
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:54:30] Running: samtools index snps.bam 2>> snps.log
[05:54:30] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:54:30] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:54:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 102
          no. right trimmed                     : 1125
          no. left and right trimmed            : 58
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1285

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1285
       total no. variants observed              : 15858
       total no. reference observed             : 0

Time elapsed: 0.19s

[05:54:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:54:33] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:54:33] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:54:34] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:54:34] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:54:34] Running: bcftools consensus --sample IP-0012-5_S3_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:54:35] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:54:35] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:54:35] Running: bcftools consensus --sample IP-0012-5_S3_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:54:36] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:54:36] Running: rm -f fake_reads\.fq 2>> snps.log
[05:54:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:54:42] Marked 4685 heterozygous sites with 'n'
[05:54:42] Creating extra output files: BED GFF CSV TXT HTML
[05:54:42] Identified 15858 variants.
[05:54:42] Result folder: snippy_work/IP-0012-5_S3_L001-SPAdes
[05:54:42] Result files:
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.aligned.fa
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.bam
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.bam.bai
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.bed
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.consensus.fa
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.consensus.subs.fa
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.csv
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.filt.vcf
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.gff
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.html
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.log
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.raw.vcf
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.subs.vcf
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.tab
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.txt
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.vcf
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.vcf.gz
[05:54:42] * snippy_work/IP-0012-5_S3_L001-SPAdes/snps.vcf.gz.csi
[05:54:42] Walltime used: 27 seconds
[05:54:42] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[05:54:42] Done.
[05:54:43] This is snippy 4.6.0
[05:54:43] Written by Torsten Seemann
[05:54:43] Obtained from https://github.com/tseemann/snippy
[05:54:43] Detected operating system: linux
[05:54:43] Enabling bundled linux tools.
[05:54:43] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:54:43] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:54:43] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:54:43] Found java - /usr/bin/java
[05:54:43] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:54:43] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:54:43] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:54:43] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:54:43] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:54:43] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:54:43] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:54:43] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:54:43] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:54:43] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:54:43] Found gzip - /bin/gzip
[05:54:43] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:54:43] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:54:43] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:54:43] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:54:43] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:54:43] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:54:43] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:54:43] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:54:43] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:54:43] Treating reference as 'fasta' format.
[05:54:43] Will use 16 CPU cores.
[05:54:43] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/30/94a13715ce0fb3736ebe565887b6df/inputfiles/IP-0013-3_S4_L001-SPAdes.fasta
[05:54:43] Creating folder: snippy_work/IP-0013-3_S4_L001-SPAdes
[05:54:43] Changing working directory: snippy_work/IP-0013-3_S4_L001-SPAdes
[05:54:43] Creating reference folder: reference
[05:54:43] Extracting FASTA and GFF from reference.
[05:54:43] Wrote 205 sequences to ref.fa
[05:54:43] Wrote 0 features to ref.gff
[05:54:43] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/30/94a13715ce0fb3736ebe565887b6df/inputfiles/IP-0013-3_S4_L001-SPAdes.fasta into pseudo-reads
[05:54:47] Wrote 578700 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:54:47] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:54:47] Using BAM RG (Read Group) ID: IP-0013-3_S4_L001-SPAdes
[05:54:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:54:47] Running: bwa index reference/ref.fa 2>> snps.log
[05:54:50] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:54:50] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:54:50] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:54:50] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:54:50] Running: bwa mem  -Y -M -R '@RG\tID:IP-0013-3_S4_L001-SPAdes\tSM:IP-0013-3_S4_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 578700 sequences (144675000 bp)...
[M::mem_process_seqs] Processed 578700 reads in 52.888 CPU sec, 3.530 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0013-3_S4_L001-SPAdes\tSM:IP-0013-3_S4_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.750 sec; CPU: 54.112 sec
[samclip] Total SAM records 582934, removed 10932, allowed 7471, passed 572002
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:54:57] Running: samtools index snps.bam 2>> snps.log
[05:54:57] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:54:57] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:55:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 86
          no. right trimmed                     : 1075
          no. left and right trimmed            : 63
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1224

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1224
       total no. variants observed              : 16847
       total no. reference observed             : 0

Time elapsed: 0.18s

[05:55:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:55:00] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:55:01] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:55:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:55:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:55:01] Running: bcftools consensus --sample IP-0013-3_S4_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:55:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:55:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:55:02] Running: bcftools consensus --sample IP-0013-3_S4_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:55:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:55:03] Running: rm -f fake_reads\.fq 2>> snps.log
[05:55:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:55:10] Marked 3903 heterozygous sites with 'n'
[05:55:10] Creating extra output files: BED GFF CSV TXT HTML
[05:55:10] Identified 16847 variants.
[05:55:10] Result folder: snippy_work/IP-0013-3_S4_L001-SPAdes
[05:55:10] Result files:
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.aligned.fa
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.bam
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.bam.bai
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.bed
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.consensus.fa
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.consensus.subs.fa
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.csv
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.filt.vcf
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.gff
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.html
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.log
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.raw.vcf
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.subs.vcf
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.tab
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.txt
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.vcf
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.vcf.gz
[05:55:10] * snippy_work/IP-0013-3_S4_L001-SPAdes/snps.vcf.gz.csi
[05:55:10] Walltime used: 27 seconds
[05:55:10] Wishing you a life free of homopolymer errors.
[05:55:10] Done.
[05:55:10] This is snippy 4.6.0
[05:55:10] Written by Torsten Seemann
[05:55:10] Obtained from https://github.com/tseemann/snippy
[05:55:10] Detected operating system: linux
[05:55:10] Enabling bundled linux tools.
[05:55:10] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:55:10] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:55:10] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:55:10] Found java - /usr/bin/java
[05:55:10] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:55:10] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:55:10] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:55:10] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:55:10] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:55:10] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:55:10] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:55:10] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:55:10] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:55:10] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:55:10] Found gzip - /bin/gzip
[05:55:10] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:55:10] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:55:10] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:55:10] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:55:10] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:55:10] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:55:10] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:55:10] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:55:10] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:55:10] Treating reference as 'fasta' format.
[05:55:10] Will use 16 CPU cores.
[05:55:10] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/6a/0c7e4ec0de21311621601aeb66f1f1/inputfiles/IP-0014-1_S5_L001-SPAdes.fasta
[05:55:10] Creating folder: snippy_work/IP-0014-1_S5_L001-SPAdes
[05:55:10] Changing working directory: snippy_work/IP-0014-1_S5_L001-SPAdes
[05:55:10] Creating reference folder: reference
[05:55:10] Extracting FASTA and GFF from reference.
[05:55:11] Wrote 205 sequences to ref.fa
[05:55:11] Wrote 0 features to ref.gff
[05:55:11] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/6a/0c7e4ec0de21311621601aeb66f1f1/inputfiles/IP-0014-1_S5_L001-SPAdes.fasta into pseudo-reads
[05:55:15] Wrote 573356 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:55:15] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:55:15] Using BAM RG (Read Group) ID: IP-0014-1_S5_L001-SPAdes
[05:55:15] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:55:15] Running: bwa index reference/ref.fa 2>> snps.log
[05:55:17] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:55:17] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:55:17] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:55:17] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:55:17] Running: bwa mem  -Y -M -R '@RG\tID:IP-0014-1_S5_L001-SPAdes\tSM:IP-0014-1_S5_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 573356 sequences (143339000 bp)...
[M::mem_process_seqs] Processed 573356 reads in 46.270 CPU sec, 3.196 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0014-1_S5_L001-SPAdes\tSM:IP-0014-1_S5_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.524 sec; CPU: 47.572 sec
[samclip] Total SAM records 576548, removed 8023, allowed 6864, passed 568525
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:55:24] Running: samtools index snps.bam 2>> snps.log
[05:55:24] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:55:24] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:55:27] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 65
          no. right trimmed                     : 807
          no. left and right trimmed            : 55
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 927

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 927
       total no. variants observed              : 11075
       total no. reference observed             : 0

Time elapsed: 0.12s

[05:55:27] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:55:27] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:55:27] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:55:27] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:55:27] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:55:27] Running: bcftools consensus --sample IP-0014-1_S5_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:55:28] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:55:28] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:55:28] Running: bcftools consensus --sample IP-0014-1_S5_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:55:29] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:55:29] Running: rm -f fake_reads\.fq 2>> snps.log
[05:55:29] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:55:36] Marked 3356 heterozygous sites with 'n'
[05:55:36] Creating extra output files: BED GFF CSV TXT HTML
[05:55:36] Identified 11075 variants.
[05:55:36] Result folder: snippy_work/IP-0014-1_S5_L001-SPAdes
[05:55:36] Result files:
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.aligned.fa
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.bam
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.bam.bai
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.bed
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.consensus.fa
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.consensus.subs.fa
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.csv
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.filt.vcf
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.gff
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.html
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.log
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.raw.vcf
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.subs.vcf
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.tab
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.txt
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.vcf
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.vcf.gz
[05:55:36] * snippy_work/IP-0014-1_S5_L001-SPAdes/snps.vcf.gz.csi
[05:55:36] Walltime used: 26 seconds
[05:55:36] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[05:55:36] Done.
[05:55:36] This is snippy 4.6.0
[05:55:36] Written by Torsten Seemann
[05:55:36] Obtained from https://github.com/tseemann/snippy
[05:55:36] Detected operating system: linux
[05:55:36] Enabling bundled linux tools.
[05:55:36] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:55:36] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:55:36] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:55:36] Found java - /usr/bin/java
[05:55:36] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:55:36] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:55:36] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:55:36] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:55:36] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:55:36] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:55:36] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:55:36] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:55:36] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:55:36] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:55:36] Found gzip - /bin/gzip
[05:55:36] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:55:36] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:55:36] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:55:36] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:55:36] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:55:36] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:55:36] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:55:36] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:55:36] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:55:36] Treating reference as 'fasta' format.
[05:55:36] Will use 16 CPU cores.
[05:55:36] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/d9/bcb4f9be4a01ddb794c1c69be4a9d5/inputfiles/IP-0015-8_S6_L001-SPAdes.fasta
[05:55:36] Creating folder: snippy_work/IP-0015-8_S6_L001-SPAdes
[05:55:36] Changing working directory: snippy_work/IP-0015-8_S6_L001-SPAdes
[05:55:36] Creating reference folder: reference
[05:55:36] Extracting FASTA and GFF from reference.
[05:55:37] Wrote 205 sequences to ref.fa
[05:55:37] Wrote 0 features to ref.gff
[05:55:37] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/d9/bcb4f9be4a01ddb794c1c69be4a9d5/inputfiles/IP-0015-8_S6_L001-SPAdes.fasta into pseudo-reads
[05:55:41] Wrote 575036 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:55:41] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:55:41] Using BAM RG (Read Group) ID: IP-0015-8_S6_L001-SPAdes
[05:55:41] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:55:41] Running: bwa index reference/ref.fa 2>> snps.log
[05:55:43] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:55:43] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:55:43] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:55:43] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:55:43] Running: bwa mem  -Y -M -R '@RG\tID:IP-0015-8_S6_L001-SPAdes\tSM:IP-0015-8_S6_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 575036 sequences (143759000 bp)...
[M::mem_process_seqs] Processed 575036 reads in 46.998 CPU sec, 3.218 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0015-8_S6_L001-SPAdes\tSM:IP-0015-8_S6_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.415 sec; CPU: 48.194 sec
[samclip] Total SAM records 578765, removed 8550, allowed 7131, passed 570215
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:55:50] Running: samtools index snps.bam 2>> snps.log
[05:55:51] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:55:51] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:55:53] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 58
          no. right trimmed                     : 891
          no. left and right trimmed            : 64
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1013

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1013
       total no. variants observed              : 12207
       total no. reference observed             : 0

Time elapsed: 0.13s

[05:55:53] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:55:53] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:55:53] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:55:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:55:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:55:54] Running: bcftools consensus --sample IP-0015-8_S6_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:55:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:55:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:55:55] Running: bcftools consensus --sample IP-0015-8_S6_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:55:56] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:55:56] Running: rm -f fake_reads\.fq 2>> snps.log
[05:55:56] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:56:02] Marked 3743 heterozygous sites with 'n'
[05:56:02] Creating extra output files: BED GFF CSV TXT HTML
[05:56:02] Identified 12207 variants.
[05:56:02] Result folder: snippy_work/IP-0015-8_S6_L001-SPAdes
[05:56:02] Result files:
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.aligned.fa
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.bam
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.bam.bai
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.bed
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.consensus.fa
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.consensus.subs.fa
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.csv
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.filt.vcf
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.gff
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.html
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.log
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.raw.vcf
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.subs.vcf
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.tab
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.txt
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.vcf
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.vcf.gz
[05:56:02] * snippy_work/IP-0015-8_S6_L001-SPAdes/snps.vcf.gz.csi
[05:56:02] Walltime used: 26 seconds
[05:56:02] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[05:56:02] Done.
[05:56:03] This is snippy 4.6.0
[05:56:03] Written by Torsten Seemann
[05:56:03] Obtained from https://github.com/tseemann/snippy
[05:56:03] Detected operating system: linux
[05:56:03] Enabling bundled linux tools.
[05:56:03] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:56:03] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:56:03] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:56:03] Found java - /usr/bin/java
[05:56:03] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:56:03] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:56:03] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:56:03] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:56:03] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:56:03] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:56:03] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:56:03] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:56:03] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:56:03] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:56:03] Found gzip - /bin/gzip
[05:56:03] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:56:03] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:56:03] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:56:03] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:56:03] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:56:03] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:56:03] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:56:03] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:56:03] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:56:03] Treating reference as 'fasta' format.
[05:56:03] Will use 16 CPU cores.
[05:56:03] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/23/97a4e7b2a03330b5e53585c97c42d1/inputfiles/IP-0016-6_S7_L001-SPAdes.fasta
[05:56:03] Creating folder: snippy_work/IP-0016-6_S7_L001-SPAdes
[05:56:03] Changing working directory: snippy_work/IP-0016-6_S7_L001-SPAdes
[05:56:03] Creating reference folder: reference
[05:56:03] Extracting FASTA and GFF from reference.
[05:56:03] Wrote 205 sequences to ref.fa
[05:56:03] Wrote 0 features to ref.gff
[05:56:03] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/23/97a4e7b2a03330b5e53585c97c42d1/inputfiles/IP-0016-6_S7_L001-SPAdes.fasta into pseudo-reads
[05:56:07] Wrote 581548 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:56:07] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:56:07] Using BAM RG (Read Group) ID: IP-0016-6_S7_L001-SPAdes
[05:56:07] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:56:07] Running: bwa index reference/ref.fa 2>> snps.log
[05:56:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:56:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:56:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:56:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:56:10] Running: bwa mem  -Y -M -R '@RG\tID:IP-0016-6_S7_L001-SPAdes\tSM:IP-0016-6_S7_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 581548 sequences (145387000 bp)...
[M::mem_process_seqs] Processed 581548 reads in 52.290 CPU sec, 3.494 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0016-6_S7_L001-SPAdes\tSM:IP-0016-6_S7_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.678 sec; CPU: 53.457 sec
[samclip] Total SAM records 586489, removed 11856, allowed 8047, passed 574633
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:56:17] Running: samtools index snps.bam 2>> snps.log
[05:56:17] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:56:17] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:56:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 83
          no. right trimmed                     : 1126
          no. left and right trimmed            : 80
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1289

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1289
       total no. variants observed              : 16653
       total no. reference observed             : 0

Time elapsed: 0.18s

[05:56:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:56:20] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:56:21] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:56:21] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:56:21] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:56:21] Running: bcftools consensus --sample IP-0016-6_S7_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:56:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:56:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:56:22] Running: bcftools consensus --sample IP-0016-6_S7_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:56:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:56:23] Running: rm -f fake_reads\.fq 2>> snps.log
[05:56:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:56:30] Marked 4758 heterozygous sites with 'n'
[05:56:30] Creating extra output files: BED GFF CSV TXT HTML
[05:56:30] Identified 16653 variants.
[05:56:30] Result folder: snippy_work/IP-0016-6_S7_L001-SPAdes
[05:56:30] Result files:
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.aligned.fa
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.bam
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.bam.bai
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.bed
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.consensus.fa
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.consensus.subs.fa
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.csv
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.filt.vcf
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.gff
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.html
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.log
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.raw.vcf
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.subs.vcf
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.tab
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.txt
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.vcf
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.vcf.gz
[05:56:30] * snippy_work/IP-0016-6_S7_L001-SPAdes/snps.vcf.gz.csi
[05:56:30] Walltime used: 27 seconds
[05:56:30] May the SNPs be with you.
[05:56:30] Done.
[05:56:30] This is snippy 4.6.0
[05:56:30] Written by Torsten Seemann
[05:56:30] Obtained from https://github.com/tseemann/snippy
[05:56:30] Detected operating system: linux
[05:56:30] Enabling bundled linux tools.
[05:56:30] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:56:30] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:56:30] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:56:30] Found java - /usr/bin/java
[05:56:30] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:56:30] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:56:30] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:56:30] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:56:30] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:56:30] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:56:30] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:56:30] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:56:30] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:56:30] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:56:30] Found gzip - /bin/gzip
[05:56:30] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:56:30] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:56:30] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:56:30] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:56:30] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:56:30] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:56:30] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:56:30] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:56:30] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:56:30] Treating reference as 'fasta' format.
[05:56:30] Will use 16 CPU cores.
[05:56:30] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/8e/4ee00781df8673370f9d5a6343faf3/inputfiles/IP-0017-4_S8_L001-SPAdes.fasta
[05:56:30] Creating folder: snippy_work/IP-0017-4_S8_L001-SPAdes
[05:56:30] Changing working directory: snippy_work/IP-0017-4_S8_L001-SPAdes
[05:56:30] Creating reference folder: reference
[05:56:30] Extracting FASTA and GFF from reference.
[05:56:30] Wrote 205 sequences to ref.fa
[05:56:30] Wrote 0 features to ref.gff
[05:56:30] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/8e/4ee00781df8673370f9d5a6343faf3/inputfiles/IP-0017-4_S8_L001-SPAdes.fasta into pseudo-reads
[05:56:35] Wrote 580862 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:56:35] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:56:35] Using BAM RG (Read Group) ID: IP-0017-4_S8_L001-SPAdes
[05:56:35] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:56:35] Running: bwa index reference/ref.fa 2>> snps.log
[05:56:37] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:56:37] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:56:37] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:56:37] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:56:37] Running: bwa mem  -Y -M -R '@RG\tID:IP-0017-4_S8_L001-SPAdes\tSM:IP-0017-4_S8_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 580862 sequences (145215500 bp)...
[M::mem_process_seqs] Processed 580862 reads in 53.479 CPU sec, 3.605 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0017-4_S8_L001-SPAdes\tSM:IP-0017-4_S8_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.052 sec; CPU: 54.924 sec
[samclip] Total SAM records 584595, removed 11187, allowed 7032, passed 573408
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:56:45] Running: samtools index snps.bam 2>> snps.log
[05:56:45] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:56:45] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:56:48] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 97
          no. right trimmed                     : 1251
          no. left and right trimmed            : 75
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1423

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1423
       total no. variants observed              : 17905
       total no. reference observed             : 0

Time elapsed: 0.20s

[05:56:48] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:56:48] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:56:48] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:56:49] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:56:49] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:56:49] Running: bcftools consensus --sample IP-0017-4_S8_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:56:50] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:56:50] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:56:50] Running: bcftools consensus --sample IP-0017-4_S8_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:56:51] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:56:51] Running: rm -f fake_reads\.fq 2>> snps.log
[05:56:51] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:56:58] Marked 4343 heterozygous sites with 'n'
[05:56:58] Creating extra output files: BED GFF CSV TXT HTML
[05:56:58] Identified 17905 variants.
[05:56:58] Result folder: snippy_work/IP-0017-4_S8_L001-SPAdes
[05:56:58] Result files:
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.aligned.fa
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.bam
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.bam.bai
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.bed
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.consensus.fa
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.consensus.subs.fa
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.csv
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.filt.vcf
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.gff
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.html
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.log
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.raw.vcf
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.subs.vcf
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.tab
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.txt
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.vcf
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.vcf.gz
[05:56:58] * snippy_work/IP-0017-4_S8_L001-SPAdes/snps.vcf.gz.csi
[05:56:58] Walltime used: 28 seconds
[05:56:58] May the SNPs be with you.
[05:56:58] Done.
[05:56:58] This is snippy 4.6.0
[05:56:58] Written by Torsten Seemann
[05:56:58] Obtained from https://github.com/tseemann/snippy
[05:56:58] Detected operating system: linux
[05:56:58] Enabling bundled linux tools.
[05:56:58] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:56:58] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:56:58] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:56:58] Found java - /usr/bin/java
[05:56:58] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:56:58] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:56:58] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:56:58] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:56:58] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:56:58] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:56:58] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:56:58] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:56:58] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:56:58] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:56:58] Found gzip - /bin/gzip
[05:56:58] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:56:58] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:56:58] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:56:58] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:56:58] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:56:58] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:56:58] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:56:58] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:56:58] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:56:58] Treating reference as 'fasta' format.
[05:56:58] Will use 16 CPU cores.
[05:56:58] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/05/0b2fa1d981220231323db8d7157441/inputfiles/IP-0018-2_S9_L001-SPAdes.fasta
[05:56:58] Creating folder: snippy_work/IP-0018-2_S9_L001-SPAdes
[05:56:58] Changing working directory: snippy_work/IP-0018-2_S9_L001-SPAdes
[05:56:58] Creating reference folder: reference
[05:56:58] Extracting FASTA and GFF from reference.
[05:56:58] Wrote 205 sequences to ref.fa
[05:56:58] Wrote 0 features to ref.gff
[05:56:58] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/05/0b2fa1d981220231323db8d7157441/inputfiles/IP-0018-2_S9_L001-SPAdes.fasta into pseudo-reads
[05:57:03] Wrote 574298 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:57:03] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:57:03] Using BAM RG (Read Group) ID: IP-0018-2_S9_L001-SPAdes
[05:57:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:57:03] Running: bwa index reference/ref.fa 2>> snps.log
[05:57:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:57:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:57:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:57:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:57:05] Running: bwa mem  -Y -M -R '@RG\tID:IP-0018-2_S9_L001-SPAdes\tSM:IP-0018-2_S9_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 574298 sequences (143574500 bp)...
[M::mem_process_seqs] Processed 574298 reads in 45.879 CPU sec, 3.330 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0018-2_S9_L001-SPAdes\tSM:IP-0018-2_S9_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.658 sec; CPU: 47.307 sec
[samclip] Total SAM records 576753, removed 5640, allowed 6403, passed 571113
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:57:12] Running: samtools index snps.bam 2>> snps.log
[05:57:13] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:57:13] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:57:15] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 71
          no. right trimmed                     : 783
          no. left and right trimmed            : 51
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 905

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 905
       total no. variants observed              : 10435
       total no. reference observed             : 0

Time elapsed: 0.11s

[05:57:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:57:15] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:57:15] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:57:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:57:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:57:15] Running: bcftools consensus --sample IP-0018-2_S9_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:57:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:57:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:57:16] Running: bcftools consensus --sample IP-0018-2_S9_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:57:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:57:17] Running: rm -f fake_reads\.fq 2>> snps.log
[05:57:18] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:57:24] Marked 4031 heterozygous sites with 'n'
[05:57:24] Creating extra output files: BED GFF CSV TXT HTML
[05:57:24] Identified 10435 variants.
[05:57:24] Result folder: snippy_work/IP-0018-2_S9_L001-SPAdes
[05:57:24] Result files:
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.aligned.fa
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.bam
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.bam.bai
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.bed
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.consensus.fa
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.consensus.subs.fa
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.csv
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.filt.vcf
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.gff
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.html
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.log
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.raw.vcf
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.subs.vcf
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.tab
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.txt
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.vcf
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.vcf.gz
[05:57:24] * snippy_work/IP-0018-2_S9_L001-SPAdes/snps.vcf.gz.csi
[05:57:24] Walltime used: 26 seconds
[05:57:24] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[05:57:24] Done.
[05:57:24] This is snippy 4.6.0
[05:57:24] Written by Torsten Seemann
[05:57:24] Obtained from https://github.com/tseemann/snippy
[05:57:24] Detected operating system: linux
[05:57:24] Enabling bundled linux tools.
[05:57:24] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:57:24] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:57:24] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:57:24] Found java - /usr/bin/java
[05:57:24] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:57:24] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:57:24] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:57:24] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:57:24] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:57:24] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:57:24] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:57:24] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:57:24] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:57:24] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:57:24] Found gzip - /bin/gzip
[05:57:24] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:57:24] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:57:24] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:57:24] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:57:24] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:57:24] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:57:24] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:57:24] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:57:24] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:57:24] Treating reference as 'fasta' format.
[05:57:24] Will use 16 CPU cores.
[05:57:24] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/ae/ffc0496754d720fd65e57f80bfd302/inputfiles/IP-0019-0_S10_L001-SPAdes.fasta
[05:57:24] Creating folder: snippy_work/IP-0019-0_S10_L001-SPAdes
[05:57:24] Changing working directory: snippy_work/IP-0019-0_S10_L001-SPAdes
[05:57:24] Creating reference folder: reference
[05:57:24] Extracting FASTA and GFF from reference.
[05:57:25] Wrote 205 sequences to ref.fa
[05:57:25] Wrote 0 features to ref.gff
[05:57:25] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/ae/ffc0496754d720fd65e57f80bfd302/inputfiles/IP-0019-0_S10_L001-SPAdes.fasta into pseudo-reads
[05:57:29] Wrote 563734 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:57:29] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:57:29] Using BAM RG (Read Group) ID: IP-0019-0_S10_L001-SPAdes
[05:57:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:57:29] Running: bwa index reference/ref.fa 2>> snps.log
[05:57:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:57:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:57:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:57:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:57:31] Running: bwa mem  -Y -M -R '@RG\tID:IP-0019-0_S10_L001-SPAdes\tSM:IP-0019-0_S10_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 563734 sequences (140933500 bp)...
[M::mem_process_seqs] Processed 563734 reads in 43.446 CPU sec, 2.939 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0019-0_S10_L001-SPAdes\tSM:IP-0019-0_S10_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.002 sec; CPU: 44.557 sec
[samclip] Total SAM records 565583, removed 4257, allowed 4988, passed 561326
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:57:37] Running: samtools index snps.bam 2>> snps.log
[05:57:38] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:57:38] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:57:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 36
          no. right trimmed                     : 525
          no. left and right trimmed            : 32
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 593

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 593
       total no. variants observed              : 6900
       total no. reference observed             : 0

Time elapsed: 0.07s

[05:57:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:57:40] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:57:40] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:57:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:57:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:57:40] Running: bcftools consensus --sample IP-0019-0_S10_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:57:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:57:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:57:41] Running: bcftools consensus --sample IP-0019-0_S10_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:57:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:57:42] Running: rm -f fake_reads\.fq 2>> snps.log
[05:57:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:57:48] Marked 3477 heterozygous sites with 'n'
[05:57:48] Creating extra output files: BED GFF CSV TXT HTML
[05:57:48] Identified 6900 variants.
[05:57:48] Result folder: snippy_work/IP-0019-0_S10_L001-SPAdes
[05:57:48] Result files:
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.aligned.fa
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.bam
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.bam.bai
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.bed
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.consensus.fa
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.consensus.subs.fa
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.csv
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.filt.vcf
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.gff
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.html
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.log
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.raw.vcf
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.subs.vcf
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.tab
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.txt
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.vcf
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.vcf.gz
[05:57:48] * snippy_work/IP-0019-0_S10_L001-SPAdes/snps.vcf.gz.csi
[05:57:48] Walltime used: 24 seconds
[05:57:48] May the SNPs be with you.
[05:57:48] Done.
[05:57:49] This is snippy 4.6.0
[05:57:49] Written by Torsten Seemann
[05:57:49] Obtained from https://github.com/tseemann/snippy
[05:57:49] Detected operating system: linux
[05:57:49] Enabling bundled linux tools.
[05:57:49] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:57:49] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:57:49] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:57:49] Found java - /usr/bin/java
[05:57:49] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:57:49] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:57:49] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:57:49] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:57:49] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:57:49] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:57:49] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:57:49] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:57:49] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:57:49] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:57:49] Found gzip - /bin/gzip
[05:57:49] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:57:49] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:57:49] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:57:49] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:57:49] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:57:49] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:57:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:57:49] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:57:49] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:57:49] Treating reference as 'fasta' format.
[05:57:49] Will use 16 CPU cores.
[05:57:49] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/98/018617d97cb20053c191501b42e5c0/inputfiles/IP-0020-8_S11_L001-SPAdes.fasta
[05:57:49] Creating folder: snippy_work/IP-0020-8_S11_L001-SPAdes
[05:57:49] Changing working directory: snippy_work/IP-0020-8_S11_L001-SPAdes
[05:57:49] Creating reference folder: reference
[05:57:49] Extracting FASTA and GFF from reference.
[05:57:49] Wrote 205 sequences to ref.fa
[05:57:49] Wrote 0 features to ref.gff
[05:57:49] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/98/018617d97cb20053c191501b42e5c0/inputfiles/IP-0020-8_S11_L001-SPAdes.fasta into pseudo-reads
[05:57:53] Wrote 582208 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:57:53] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:57:53] Using BAM RG (Read Group) ID: IP-0020-8_S11_L001-SPAdes
[05:57:53] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:57:53] Running: bwa index reference/ref.fa 2>> snps.log
[05:57:56] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:57:56] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:57:56] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:57:56] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:57:56] Running: bwa mem  -Y -M -R '@RG\tID:IP-0020-8_S11_L001-SPAdes\tSM:IP-0020-8_S11_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 582208 sequences (145552000 bp)...
[M::mem_process_seqs] Processed 582208 reads in 53.246 CPU sec, 3.502 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0020-8_S11_L001-SPAdes\tSM:IP-0020-8_S11_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.719 sec; CPU: 54.452 sec
[samclip] Total SAM records 585994, removed 11004, allowed 7625, passed 574990
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:58:03] Running: samtools index snps.bam 2>> snps.log
[05:58:04] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:58:04] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:58:06] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 87
          no. right trimmed                     : 1162
          no. left and right trimmed            : 74
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1323

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1323
       total no. variants observed              : 17282
       total no. reference observed             : 0

Time elapsed: 0.18s

[05:58:06] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:58:06] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:58:07] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:58:07] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:58:07] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:58:07] Running: bcftools consensus --sample IP-0020-8_S11_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:58:08] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:58:08] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:58:08] Running: bcftools consensus --sample IP-0020-8_S11_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:58:09] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:58:09] Running: rm -f fake_reads\.fq 2>> snps.log
[05:58:10] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:58:16] Marked 3444 heterozygous sites with 'n'
[05:58:16] Creating extra output files: BED GFF CSV TXT HTML
[05:58:16] Identified 17282 variants.
[05:58:16] Result folder: snippy_work/IP-0020-8_S11_L001-SPAdes
[05:58:16] Result files:
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.aligned.fa
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.bam
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.bam.bai
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.bed
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.consensus.fa
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.consensus.subs.fa
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.csv
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.filt.vcf
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.gff
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.html
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.log
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.raw.vcf
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.subs.vcf
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.tab
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.txt
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.vcf
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.vcf.gz
[05:58:16] * snippy_work/IP-0020-8_S11_L001-SPAdes/snps.vcf.gz.csi
[05:58:16] Walltime used: 27 seconds
[05:58:16] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[05:58:16] Done.
[05:58:16] This is snippy 4.6.0
[05:58:16] Written by Torsten Seemann
[05:58:16] Obtained from https://github.com/tseemann/snippy
[05:58:16] Detected operating system: linux
[05:58:16] Enabling bundled linux tools.
[05:58:16] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:58:16] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:58:16] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:58:16] Found java - /usr/bin/java
[05:58:16] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:58:16] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:58:16] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:58:16] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:58:16] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:58:16] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:58:16] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:58:16] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:58:16] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:58:16] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:58:16] Found gzip - /bin/gzip
[05:58:16] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:58:16] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:58:16] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:58:16] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:58:16] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:58:16] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:58:16] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:58:16] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:58:16] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:58:16] Treating reference as 'fasta' format.
[05:58:16] Will use 16 CPU cores.
[05:58:16] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/37/38c6edb81c673ca15eafb83af5eb40/inputfiles/IP-0021-6_S1_L001-SPAdes.fasta
[05:58:16] Creating folder: snippy_work/IP-0021-6_S1_L001-SPAdes
[05:58:16] Changing working directory: snippy_work/IP-0021-6_S1_L001-SPAdes
[05:58:16] Creating reference folder: reference
[05:58:16] Extracting FASTA and GFF from reference.
[05:58:17] Wrote 205 sequences to ref.fa
[05:58:17] Wrote 0 features to ref.gff
[05:58:17] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/37/38c6edb81c673ca15eafb83af5eb40/inputfiles/IP-0021-6_S1_L001-SPAdes.fasta into pseudo-reads
[05:58:21] Wrote 572422 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:58:21] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:58:21] Using BAM RG (Read Group) ID: IP-0021-6_S1_L001-SPAdes
[05:58:21] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:58:21] Running: bwa index reference/ref.fa 2>> snps.log
[05:58:23] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:58:24] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:58:24] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:58:24] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:58:24] Running: bwa mem  -Y -M -R '@RG\tID:IP-0021-6_S1_L001-SPAdes\tSM:IP-0021-6_S1_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 572422 sequences (143105500 bp)...
[M::mem_process_seqs] Processed 572422 reads in 44.189 CPU sec, 2.993 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0021-6_S1_L001-SPAdes\tSM:IP-0021-6_S1_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq[samclip] Total SAM records 575185, removed 5917, allowed 6765, passed 569268

[main] Real time: 5.142 sec; CPU: 45.381 sec
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:58:30] Running: samtools index snps.bam 2>> snps.log
[05:58:31] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:58:31] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:58:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 77
          no. right trimmed                     : 798
          no. left and right trimmed            : 56
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 931

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 931
       total no. variants observed              : 10744
       total no. reference observed             : 0

Time elapsed: 0.11s

[05:58:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:58:33] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:58:33] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:58:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:58:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:58:33] Running: bcftools consensus --sample IP-0021-6_S1_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:58:34] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:58:34] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:58:34] Running: bcftools consensus --sample IP-0021-6_S1_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:58:35] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:58:35] Running: rm -f fake_reads\.fq 2>> snps.log
[05:58:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:58:42] Marked 3842 heterozygous sites with 'n'
[05:58:42] Creating extra output files: BED GFF CSV TXT HTML
[05:58:42] Identified 10744 variants.
[05:58:42] Result folder: snippy_work/IP-0021-6_S1_L001-SPAdes
[05:58:42] Result files:
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.aligned.fa
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.bam
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.bam.bai
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.bed
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.consensus.fa
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.consensus.subs.fa
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.csv
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.filt.vcf
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.gff
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.html
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.log
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.raw.vcf
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.subs.vcf
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.tab
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.txt
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.vcf
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.vcf.gz
[05:58:42] * snippy_work/IP-0021-6_S1_L001-SPAdes/snps.vcf.gz.csi
[05:58:42] Walltime used: 26 seconds
[05:58:42] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[05:58:42] Done.
[05:58:42] This is snippy 4.6.0
[05:58:42] Written by Torsten Seemann
[05:58:42] Obtained from https://github.com/tseemann/snippy
[05:58:42] Detected operating system: linux
[05:58:42] Enabling bundled linux tools.
[05:58:42] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:58:42] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:58:42] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:58:42] Found java - /usr/bin/java
[05:58:42] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:58:42] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:58:42] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:58:42] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:58:42] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:58:42] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:58:42] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:58:42] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:58:42] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:58:42] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:58:42] Found gzip - /bin/gzip
[05:58:42] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:58:42] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:58:42] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:58:42] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:58:42] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:58:42] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:58:42] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:58:42] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:58:42] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:58:42] Treating reference as 'fasta' format.
[05:58:42] Will use 16 CPU cores.
[05:58:42] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/07/38efd7d1beafcd5b2875b8e9cd3550/inputfiles/IP-0022-4_S2_L001-SPAdes.fasta
[05:58:42] Creating folder: snippy_work/IP-0022-4_S2_L001-SPAdes
[05:58:42] Changing working directory: snippy_work/IP-0022-4_S2_L001-SPAdes
[05:58:42] Creating reference folder: reference
[05:58:42] Extracting FASTA and GFF from reference.
[05:58:43] Wrote 205 sequences to ref.fa
[05:58:43] Wrote 0 features to ref.gff
[05:58:43] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/07/38efd7d1beafcd5b2875b8e9cd3550/inputfiles/IP-0022-4_S2_L001-SPAdes.fasta into pseudo-reads
[05:58:47] Wrote 587842 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:58:47] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:58:47] Using BAM RG (Read Group) ID: IP-0022-4_S2_L001-SPAdes
[05:58:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:58:47] Running: bwa index reference/ref.fa 2>> snps.log
[05:58:49] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:58:49] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:58:49] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:58:49] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:58:49] Running: bwa mem  -Y -M -R '@RG\tID:IP-0022-4_S2_L001-SPAdes\tSM:IP-0022-4_S2_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 587842 sequences (146960500 bp)...
[M::mem_process_seqs] Processed 587842 reads in 52.644 CPU sec, 3.475 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0022-4_S2_L001-SPAdes\tSM:IP-0022-4_S2_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.767 sec; CPU: 53.862 sec
[samclip] Total SAM records 592141, removed 12309, allowed 7646, passed 579832
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:58:57] Running: samtools index snps.bam 2>> snps.log
[05:58:57] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:58:57] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:59:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 87
          no. right trimmed                     : 1070
          no. left and right trimmed            : 71
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1228

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1228
       total no. variants observed              : 16260
       total no. reference observed             : 0

Time elapsed: 0.17s

[05:59:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:59:00] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:59:00] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:59:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:59:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:59:01] Running: bcftools consensus --sample IP-0022-4_S2_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:59:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:59:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:59:02] Running: bcftools consensus --sample IP-0022-4_S2_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:59:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:59:03] Running: rm -f fake_reads\.fq 2>> snps.log
[05:59:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:59:09] Marked 4224 heterozygous sites with 'n'
[05:59:09] Creating extra output files: BED GFF CSV TXT HTML
[05:59:09] Identified 16260 variants.
[05:59:09] Result folder: snippy_work/IP-0022-4_S2_L001-SPAdes
[05:59:09] Result files:
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.aligned.fa
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.bam
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.bam.bai
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.bed
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.consensus.fa
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.consensus.subs.fa
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.csv
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.filt.vcf
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.gff
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.html
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.log
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.raw.vcf
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.subs.vcf
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.tab
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.txt
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.vcf
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.vcf.gz
[05:59:09] * snippy_work/IP-0022-4_S2_L001-SPAdes/snps.vcf.gz.csi
[05:59:09] Walltime used: 27 seconds
[05:59:09] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[05:59:09] Done.
[05:59:10] This is snippy 4.6.0
[05:59:10] Written by Torsten Seemann
[05:59:10] Obtained from https://github.com/tseemann/snippy
[05:59:10] Detected operating system: linux
[05:59:10] Enabling bundled linux tools.
[05:59:10] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:59:10] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:59:10] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:59:10] Found java - /usr/bin/java
[05:59:10] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:59:10] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:59:10] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:59:10] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:59:10] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:59:10] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:59:10] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:59:10] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:59:10] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:59:10] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:59:10] Found gzip - /bin/gzip
[05:59:10] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:59:10] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:59:10] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:59:10] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:59:10] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:59:10] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:59:10] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:59:10] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:59:10] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:59:10] Treating reference as 'fasta' format.
[05:59:10] Will use 16 CPU cores.
[05:59:10] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/ad/a114a009df91fd292412f29d80a4c1/inputfiles/IP-0023-2_S3_L001-SPAdes.fasta
[05:59:10] Creating folder: snippy_work/IP-0023-2_S3_L001-SPAdes
[05:59:10] Changing working directory: snippy_work/IP-0023-2_S3_L001-SPAdes
[05:59:10] Creating reference folder: reference
[05:59:10] Extracting FASTA and GFF from reference.
[05:59:10] Wrote 205 sequences to ref.fa
[05:59:10] Wrote 0 features to ref.gff
[05:59:10] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/ad/a114a009df91fd292412f29d80a4c1/inputfiles/IP-0023-2_S3_L001-SPAdes.fasta into pseudo-reads
[05:59:14] Wrote 573262 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:59:14] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:59:14] Using BAM RG (Read Group) ID: IP-0023-2_S3_L001-SPAdes
[05:59:14] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:59:14] Running: bwa index reference/ref.fa 2>> snps.log
[05:59:17] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:59:17] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:59:17] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:59:17] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:59:17] Running: bwa mem  -Y -M -R '@RG\tID:IP-0023-2_S3_L001-SPAdes\tSM:IP-0023-2_S3_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 573262 sequences (143315500 bp)...
[M::mem_process_seqs] Processed 573262 reads in 55.320 CPU sec, 3.549 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0023-2_S3_L001-SPAdes\tSM:IP-0023-2_S3_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.733 sec; CPU: 56.504 sec
[samclip] Total SAM records 577530, removed 11449, allowed 8201, passed 566081
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:59:24] Running: samtools index snps.bam 2>> snps.log
[05:59:24] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:59:24] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:59:27] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 96
          no. right trimmed                     : 1173
          no. left and right trimmed            : 84
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1353

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1353
       total no. variants observed              : 18337
       total no. reference observed             : 0

Time elapsed: 0.19s

[05:59:27] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:59:27] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:59:27] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:59:28] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:59:28] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:59:28] Running: bcftools consensus --sample IP-0023-2_S3_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:59:29] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:59:29] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:59:29] Running: bcftools consensus --sample IP-0023-2_S3_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:59:30] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:59:30] Running: rm -f fake_reads\.fq 2>> snps.log
[05:59:30] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[05:59:37] Marked 4177 heterozygous sites with 'n'
[05:59:37] Creating extra output files: BED GFF CSV TXT HTML
[05:59:37] Identified 18337 variants.
[05:59:37] Result folder: snippy_work/IP-0023-2_S3_L001-SPAdes
[05:59:37] Result files:
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.aligned.fa
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.bam
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.bam.bai
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.bed
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.consensus.fa
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.consensus.subs.fa
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.csv
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.filt.vcf
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.gff
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.html
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.log
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.raw.vcf
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.subs.vcf
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.tab
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.txt
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.vcf
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.vcf.gz
[05:59:37] * snippy_work/IP-0023-2_S3_L001-SPAdes/snps.vcf.gz.csi
[05:59:37] Walltime used: 27 seconds
[05:59:37] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[05:59:37] Done.
[05:59:37] This is snippy 4.6.0
[05:59:37] Written by Torsten Seemann
[05:59:37] Obtained from https://github.com/tseemann/snippy
[05:59:37] Detected operating system: linux
[05:59:37] Enabling bundled linux tools.
[05:59:37] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[05:59:37] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[05:59:37] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[05:59:37] Found java - /usr/bin/java
[05:59:37] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[05:59:37] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[05:59:37] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[05:59:37] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[05:59:37] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[05:59:37] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[05:59:37] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[05:59:37] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[05:59:37] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[05:59:37] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[05:59:37] Found gzip - /bin/gzip
[05:59:37] Found vt - /snippy-4.6.0/binaries/linux/vt
[05:59:37] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[05:59:37] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[05:59:37] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[05:59:37] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[05:59:37] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[05:59:37] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[05:59:37] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[05:59:37] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[05:59:37] Treating reference as 'fasta' format.
[05:59:37] Will use 16 CPU cores.
[05:59:37] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/11/3249c3fba89a4e5ead4804c843c93b/inputfiles/IP-0024-0_S4_L001-SPAdes.fasta
[05:59:37] Creating folder: snippy_work/IP-0024-0_S4_L001-SPAdes
[05:59:37] Changing working directory: snippy_work/IP-0024-0_S4_L001-SPAdes
[05:59:37] Creating reference folder: reference
[05:59:37] Extracting FASTA and GFF from reference.
[05:59:37] Wrote 205 sequences to ref.fa
[05:59:37] Wrote 0 features to ref.gff
[05:59:37] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/11/3249c3fba89a4e5ead4804c843c93b/inputfiles/IP-0024-0_S4_L001-SPAdes.fasta into pseudo-reads
[05:59:42] Wrote 582740 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[05:59:42] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[05:59:42] Using BAM RG (Read Group) ID: IP-0024-0_S4_L001-SPAdes
[05:59:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[05:59:42] Running: bwa index reference/ref.fa 2>> snps.log
[05:59:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[05:59:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[05:59:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[05:59:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[05:59:44] Running: bwa mem  -Y -M -R '@RG\tID:IP-0024-0_S4_L001-SPAdes\tSM:IP-0024-0_S4_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 582740 sequences (145685000 bp)...
[M::mem_process_seqs] Processed 582740 reads in 60.052 CPU sec, 4.031 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0024-0_S4_L001-SPAdes\tSM:IP-0024-0_S4_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.248 sec; CPU: 61.301 sec
[samclip] Total SAM records 587610, removed 13553, allowed 8088, passed 574057
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[05:59:52] Running: samtools index snps.bam 2>> snps.log
[05:59:52] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[05:59:52] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[05:59:55] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 105
          no. right trimmed                     : 1326
          no. left and right trimmed            : 98
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1529

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1529
       total no. variants observed              : 20643
       total no. reference observed             : 0

Time elapsed: 0.21s

[05:59:55] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[05:59:55] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[05:59:56] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[05:59:56] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[05:59:56] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[05:59:56] Running: bcftools consensus --sample IP-0024-0_S4_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[05:59:57] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[05:59:57] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[05:59:57] Running: bcftools consensus --sample IP-0024-0_S4_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[05:59:58] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[05:59:58] Running: rm -f fake_reads\.fq 2>> snps.log
[05:59:59] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[06:00:05] Marked 4449 heterozygous sites with 'n'
[06:00:05] Creating extra output files: BED GFF CSV TXT HTML
[06:00:05] Identified 20643 variants.
[06:00:05] Result folder: snippy_work/IP-0024-0_S4_L001-SPAdes
[06:00:05] Result files:
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.aligned.fa
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.bam
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.bam.bai
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.bed
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.consensus.fa
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.consensus.subs.fa
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.csv
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.filt.vcf
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.gff
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.html
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.log
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.raw.vcf
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.subs.vcf
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.tab
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.txt
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.vcf
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.vcf.gz
[06:00:05] * snippy_work/IP-0024-0_S4_L001-SPAdes/snps.vcf.gz.csi
[06:00:05] Walltime used: 28 seconds
[06:00:05] Wishing you a life free of homopolymer errors.
[06:00:05] Done.
[06:00:05] This is snippy 4.6.0
[06:00:05] Written by Torsten Seemann
[06:00:05] Obtained from https://github.com/tseemann/snippy
[06:00:05] Detected operating system: linux
[06:00:05] Enabling bundled linux tools.
[06:00:05] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[06:00:05] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[06:00:05] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[06:00:05] Found java - /usr/bin/java
[06:00:05] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[06:00:05] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[06:00:05] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[06:00:05] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[06:00:05] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[06:00:05] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[06:00:05] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[06:00:05] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[06:00:05] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[06:00:05] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[06:00:05] Found gzip - /bin/gzip
[06:00:05] Found vt - /snippy-4.6.0/binaries/linux/vt
[06:00:05] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[06:00:05] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[06:00:05] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[06:00:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[06:00:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[06:00:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[06:00:06] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[06:00:06] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[06:00:06] Treating reference as 'fasta' format.
[06:00:06] Will use 16 CPU cores.
[06:00:06] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/2a/311e50a7550cd2e10acdef5a2a54ff/inputfiles/IP-0025-7_S5_L001-SPAdes.fasta
[06:00:06] Creating folder: snippy_work/IP-0025-7_S5_L001-SPAdes
[06:00:06] Changing working directory: snippy_work/IP-0025-7_S5_L001-SPAdes
[06:00:06] Creating reference folder: reference
[06:00:06] Extracting FASTA and GFF from reference.
[06:00:06] Wrote 205 sequences to ref.fa
[06:00:06] Wrote 0 features to ref.gff
[06:00:06] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/2a/311e50a7550cd2e10acdef5a2a54ff/inputfiles/IP-0025-7_S5_L001-SPAdes.fasta into pseudo-reads
[06:00:10] Wrote 583260 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[06:00:10] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[06:00:10] Using BAM RG (Read Group) ID: IP-0025-7_S5_L001-SPAdes
[06:00:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[06:00:10] Running: bwa index reference/ref.fa 2>> snps.log
[06:00:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[06:00:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[06:00:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[06:00:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[06:00:13] Running: bwa mem  -Y -M -R '@RG\tID:IP-0025-7_S5_L001-SPAdes\tSM:IP-0025-7_S5_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 583260 sequences (145815000 bp)...
[M::mem_process_seqs] Processed 583260 reads in 56.309 CPU sec, 3.691 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0025-7_S5_L001-SPAdes\tSM:IP-0025-7_S5_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq[samclip] Total SAM records 587453, removed 11709, allowed 7460, passed 575744
[samclip] Header contained 207 lines
[samclip] Done.

[main] Real time: 5.869 sec; CPU: 57.529 sec
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[06:00:20] Running: samtools index snps.bam 2>> snps.log
[06:00:21] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[06:00:21] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[06:00:24] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 81
          no. right trimmed                     : 1137
          no. left and right trimmed            : 74
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1292

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1292
       total no. variants observed              : 17042
       total no. reference observed             : 0

Time elapsed: 0.18s

[06:00:24] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[06:00:24] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[06:00:24] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[06:00:24] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[06:00:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[06:00:25] Running: bcftools consensus --sample IP-0025-7_S5_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[06:00:26] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[06:00:26] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[06:00:26] Running: bcftools consensus --sample IP-0025-7_S5_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[06:00:27] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[06:00:27] Running: rm -f fake_reads\.fq 2>> snps.log
[06:00:27] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[06:00:33] Marked 3738 heterozygous sites with 'n'
[06:00:33] Creating extra output files: BED GFF CSV TXT HTML
[06:00:33] Identified 17042 variants.
[06:00:33] Result folder: snippy_work/IP-0025-7_S5_L001-SPAdes
[06:00:33] Result files:
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.aligned.fa
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.bam
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.bam.bai
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.bed
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.consensus.fa
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.consensus.subs.fa
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.csv
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.filt.vcf
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.gff
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.html
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.log
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.raw.vcf
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.subs.vcf
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.tab
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.txt
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.vcf
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.vcf.gz
[06:00:33] * snippy_work/IP-0025-7_S5_L001-SPAdes/snps.vcf.gz.csi
[06:00:33] Walltime used: 28 seconds
[06:00:33] Wishing you a life free of homopolymer errors.
[06:00:33] Done.
[06:00:34] This is snippy 4.6.0
[06:00:34] Written by Torsten Seemann
[06:00:34] Obtained from https://github.com/tseemann/snippy
[06:00:34] Detected operating system: linux
[06:00:34] Enabling bundled linux tools.
[06:00:34] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[06:00:34] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[06:00:34] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[06:00:34] Found java - /usr/bin/java
[06:00:34] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[06:00:34] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[06:00:34] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[06:00:34] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[06:00:34] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[06:00:34] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[06:00:34] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[06:00:34] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[06:00:34] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[06:00:34] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[06:00:34] Found gzip - /bin/gzip
[06:00:34] Found vt - /snippy-4.6.0/binaries/linux/vt
[06:00:34] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[06:00:34] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[06:00:34] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[06:00:34] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[06:00:34] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[06:00:34] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[06:00:34] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[06:00:34] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[06:00:34] Treating reference as 'fasta' format.
[06:00:34] Will use 16 CPU cores.
[06:00:34] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/54/6b713d197fc1420b67040d74947dbf/inputfiles/IP-0026-5_S6_L001-SPAdes.fasta
[06:00:34] Creating folder: snippy_work/IP-0026-5_S6_L001-SPAdes
[06:00:34] Changing working directory: snippy_work/IP-0026-5_S6_L001-SPAdes
[06:00:34] Creating reference folder: reference
[06:00:34] Extracting FASTA and GFF from reference.
[06:00:34] Wrote 205 sequences to ref.fa
[06:00:34] Wrote 0 features to ref.gff
[06:00:34] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/54/6b713d197fc1420b67040d74947dbf/inputfiles/IP-0026-5_S6_L001-SPAdes.fasta into pseudo-reads
[06:00:38] Wrote 572406 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[06:00:38] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[06:00:38] Using BAM RG (Read Group) ID: IP-0026-5_S6_L001-SPAdes
[06:00:38] Running: samtools faidx reference/ref.fa 2>> snps.log
[06:00:38] Running: bwa index reference/ref.fa 2>> snps.log
[06:00:41] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[06:00:41] Running: ln -sf reference/ref.fa . 2>> snps.log
[06:00:41] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[06:00:41] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[06:00:41] Running: bwa mem  -Y -M -R '@RG\tID:IP-0026-5_S6_L001-SPAdes\tSM:IP-0026-5_S6_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 572406 sequences (143101500 bp)...
[M::mem_process_seqs] Processed 572406 reads in 58.469 CPU sec, 3.780 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0026-5_S6_L001-SPAdes\tSM:IP-0026-5_S6_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.937 sec; CPU: 59.619 sec
[samclip] Total SAM records 576751, removed 12105, allowed 7394, passed 564646
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[06:00:48] Running: samtools index snps.bam 2>> snps.log
[06:00:49] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[06:00:49] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[06:00:52] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 115
          no. right trimmed                     : 1321
          no. left and right trimmed            : 87
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1523

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1523
       total no. variants observed              : 20321
       total no. reference observed             : 0

Time elapsed: 0.21s

[06:00:52] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[06:00:52] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[06:00:52] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[06:00:53] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[06:00:53] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[06:00:53] Running: bcftools consensus --sample IP-0026-5_S6_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[06:00:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[06:00:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[06:00:54] Running: bcftools consensus --sample IP-0026-5_S6_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[06:00:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[06:00:55] Running: rm -f fake_reads\.fq 2>> snps.log
[06:00:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[06:01:01] Marked 4385 heterozygous sites with 'n'
[06:01:01] Creating extra output files: BED GFF CSV TXT HTML
[06:01:02] Identified 20321 variants.
[06:01:02] Result folder: snippy_work/IP-0026-5_S6_L001-SPAdes
[06:01:02] Result files:
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.aligned.fa
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.bam
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.bam.bai
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.bed
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.consensus.fa
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.consensus.subs.fa
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.csv
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.filt.vcf
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.gff
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.html
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.log
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.raw.vcf
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.subs.vcf
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.tab
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.txt
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.vcf
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.vcf.gz
[06:01:02] * snippy_work/IP-0026-5_S6_L001-SPAdes/snps.vcf.gz.csi
[06:01:02] Walltime used: 28 seconds
[06:01:02] Questionable SNP? Try the --report option to see the alignments.
[06:01:02] Done.
[06:01:02] This is snippy 4.6.0
[06:01:02] Written by Torsten Seemann
[06:01:02] Obtained from https://github.com/tseemann/snippy
[06:01:02] Detected operating system: linux
[06:01:02] Enabling bundled linux tools.
[06:01:02] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[06:01:02] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[06:01:02] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[06:01:02] Found java - /usr/bin/java
[06:01:02] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[06:01:02] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[06:01:02] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[06:01:02] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[06:01:02] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[06:01:02] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[06:01:02] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[06:01:02] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[06:01:02] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[06:01:02] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[06:01:02] Found gzip - /bin/gzip
[06:01:02] Found vt - /snippy-4.6.0/binaries/linux/vt
[06:01:02] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[06:01:02] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[06:01:02] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[06:01:02] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[06:01:02] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[06:01:02] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[06:01:02] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[06:01:02] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[06:01:02] Treating reference as 'fasta' format.
[06:01:02] Will use 16 CPU cores.
[06:01:02] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/cc/1b36bf19b948b098a126e80a3acf52/inputfiles/IP-0027-3_S7_L001-SPAdes.fasta
[06:01:02] Creating folder: snippy_work/IP-0027-3_S7_L001-SPAdes
[06:01:02] Changing working directory: snippy_work/IP-0027-3_S7_L001-SPAdes
[06:01:02] Creating reference folder: reference
[06:01:02] Extracting FASTA and GFF from reference.
[06:01:02] Wrote 205 sequences to ref.fa
[06:01:02] Wrote 0 features to ref.gff
[06:01:02] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/cc/1b36bf19b948b098a126e80a3acf52/inputfiles/IP-0027-3_S7_L001-SPAdes.fasta into pseudo-reads
[06:01:07] Wrote 582474 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[06:01:07] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[06:01:07] Using BAM RG (Read Group) ID: IP-0027-3_S7_L001-SPAdes
[06:01:07] Running: samtools faidx reference/ref.fa 2>> snps.log
[06:01:07] Running: bwa index reference/ref.fa 2>> snps.log
[06:01:09] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[06:01:09] Running: ln -sf reference/ref.fa . 2>> snps.log
[06:01:09] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[06:01:09] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[06:01:09] Running: bwa mem  -Y -M -R '@RG\tID:IP-0027-3_S7_L001-SPAdes\tSM:IP-0027-3_S7_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 582474 sequences (145618500 bp)...
[M::mem_process_seqs] Processed 582474 reads in 61.855 CPU sec, 4.096 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0027-3_S7_L001-SPAdes\tSM:IP-0027-3_S7_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 6.388 sec; CPU: 63.086 sec
[samclip] Total SAM records 586520, removed 11557, allowed 7324, passed 574963
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[06:01:17] Running: samtools index snps.bam 2>> snps.log
[06:01:17] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[06:01:17] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[06:01:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 99
          no. right trimmed                     : 1273
          no. left and right trimmed            : 74
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1446

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1446
       total no. variants observed              : 18039
       total no. reference observed             : 0

Time elapsed: 0.19s

[06:01:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[06:01:20] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[06:01:21] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[06:01:21] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[06:01:21] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[06:01:21] Running: bcftools consensus --sample IP-0027-3_S7_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[06:01:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[06:01:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[06:01:22] Running: bcftools consensus --sample IP-0027-3_S7_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[06:01:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[06:01:23] Running: rm -f fake_reads\.fq 2>> snps.log
[06:01:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[06:01:30] Marked 4748 heterozygous sites with 'n'
[06:01:30] Creating extra output files: BED GFF CSV TXT HTML
[06:01:30] Identified 18039 variants.
[06:01:30] Result folder: snippy_work/IP-0027-3_S7_L001-SPAdes
[06:01:30] Result files:
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.aligned.fa
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.bam
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.bam.bai
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.bed
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.consensus.fa
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.consensus.subs.fa
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.csv
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.filt.vcf
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.gff
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.html
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.log
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.raw.vcf
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.subs.vcf
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.tab
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.txt
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.vcf
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.vcf.gz
[06:01:30] * snippy_work/IP-0027-3_S7_L001-SPAdes/snps.vcf.gz.csi
[06:01:30] Walltime used: 28 seconds
[06:01:30] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[06:01:30] Done.
[06:01:30] This is snippy 4.6.0
[06:01:30] Written by Torsten Seemann
[06:01:30] Obtained from https://github.com/tseemann/snippy
[06:01:30] Detected operating system: linux
[06:01:30] Enabling bundled linux tools.
[06:01:30] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[06:01:30] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[06:01:30] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[06:01:30] Found java - /usr/bin/java
[06:01:30] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[06:01:30] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[06:01:30] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[06:01:30] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[06:01:30] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[06:01:30] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[06:01:30] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[06:01:30] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[06:01:30] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[06:01:30] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[06:01:30] Found gzip - /bin/gzip
[06:01:30] Found vt - /snippy-4.6.0/binaries/linux/vt
[06:01:30] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[06:01:30] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[06:01:30] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[06:01:30] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[06:01:30] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[06:01:30] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[06:01:30] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[06:01:30] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[06:01:30] Treating reference as 'fasta' format.
[06:01:30] Will use 16 CPU cores.
[06:01:30] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/c3/475032286e70ad7d2cddc1d21640d3/inputfiles/IP-0028-1_S8_L001-SPAdes.fasta
[06:01:30] Creating folder: snippy_work/IP-0028-1_S8_L001-SPAdes
[06:01:30] Changing working directory: snippy_work/IP-0028-1_S8_L001-SPAdes
[06:01:30] Creating reference folder: reference
[06:01:30] Extracting FASTA and GFF from reference.
[06:01:31] Wrote 205 sequences to ref.fa
[06:01:31] Wrote 0 features to ref.gff
[06:01:31] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/c3/475032286e70ad7d2cddc1d21640d3/inputfiles/IP-0028-1_S8_L001-SPAdes.fasta into pseudo-reads
[06:01:35] Wrote 585358 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[06:01:35] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[06:01:35] Using BAM RG (Read Group) ID: IP-0028-1_S8_L001-SPAdes
[06:01:35] Running: samtools faidx reference/ref.fa 2>> snps.log
[06:01:35] Running: bwa index reference/ref.fa 2>> snps.log
[06:01:37] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[06:01:37] Running: ln -sf reference/ref.fa . 2>> snps.log
[06:01:37] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[06:01:37] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[06:01:37] Running: bwa mem  -Y -M -R '@RG\tID:IP-0028-1_S8_L001-SPAdes\tSM:IP-0028-1_S8_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 585358 sequences (146339500 bp)...
[M::mem_process_seqs] Processed 585358 reads in 54.756 CPU sec, 3.710 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0028-1_S8_L001-SPAdes\tSM:IP-0028-1_S8_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.894 sec; CPU: 55.961 sec
[samclip] Total SAM records 590009, removed 12310, allowed 7706, passed 577699
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[06:01:44] Running: samtools index snps.bam 2>> snps.log
[06:01:45] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[06:01:45] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[06:01:48] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 80
          no. right trimmed                     : 1168
          no. left and right trimmed            : 74
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1322

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1322
       total no. variants observed              : 17601
       total no. reference observed             : 0

Time elapsed: 0.18s

[06:01:48] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[06:01:48] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[06:01:48] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[06:01:48] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[06:01:49] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[06:01:49] Running: bcftools consensus --sample IP-0028-1_S8_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[06:01:50] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[06:01:50] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[06:01:50] Running: bcftools consensus --sample IP-0028-1_S8_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[06:01:51] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[06:01:51] Running: rm -f fake_reads\.fq 2>> snps.log
[06:01:51] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[06:01:57] Marked 3715 heterozygous sites with 'n'
[06:01:57] Creating extra output files: BED GFF CSV TXT HTML
[06:01:57] Identified 17601 variants.
[06:01:57] Result folder: snippy_work/IP-0028-1_S8_L001-SPAdes
[06:01:57] Result files:
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.aligned.fa
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.bam
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.bam.bai
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.bed
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.consensus.fa
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.consensus.subs.fa
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.csv
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.filt.vcf
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.gff
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.html
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.log
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.raw.vcf
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.subs.vcf
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.tab
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.txt
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.vcf
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.vcf.gz
[06:01:57] * snippy_work/IP-0028-1_S8_L001-SPAdes/snps.vcf.gz.csi
[06:01:57] Walltime used: 27 seconds
[06:01:57] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[06:01:57] Done.
[06:01:58] This is snippy 4.6.0
[06:01:58] Written by Torsten Seemann
[06:01:58] Obtained from https://github.com/tseemann/snippy
[06:01:58] Detected operating system: linux
[06:01:58] Enabling bundled linux tools.
[06:01:58] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[06:01:58] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[06:01:58] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[06:01:58] Found java - /usr/bin/java
[06:01:58] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[06:01:58] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[06:01:58] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[06:01:58] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[06:01:58] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[06:01:58] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[06:01:58] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[06:01:58] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[06:01:58] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[06:01:58] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[06:01:58] Found gzip - /bin/gzip
[06:01:58] Found vt - /snippy-4.6.0/binaries/linux/vt
[06:01:58] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[06:01:58] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[06:01:58] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[06:01:58] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[06:01:58] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[06:01:58] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[06:01:58] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[06:01:58] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[06:01:58] Treating reference as 'fasta' format.
[06:01:58] Will use 16 CPU cores.
[06:01:58] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/92/9b434f875dfd585233f8c01dee01ca/inputfiles/IP-0029-9_S9_L001-SPAdes.fasta
[06:01:58] Creating folder: snippy_work/IP-0029-9_S9_L001-SPAdes
[06:01:58] Changing working directory: snippy_work/IP-0029-9_S9_L001-SPAdes
[06:01:58] Creating reference folder: reference
[06:01:58] Extracting FASTA and GFF from reference.
[06:01:58] Wrote 205 sequences to ref.fa
[06:01:58] Wrote 0 features to ref.gff
[06:01:58] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/92/9b434f875dfd585233f8c01dee01ca/inputfiles/IP-0029-9_S9_L001-SPAdes.fasta into pseudo-reads
[06:02:02] Wrote 574516 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[06:02:02] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[06:02:02] Using BAM RG (Read Group) ID: IP-0029-9_S9_L001-SPAdes
[06:02:02] Running: samtools faidx reference/ref.fa 2>> snps.log
[06:02:02] Running: bwa index reference/ref.fa 2>> snps.log
[06:02:04] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[06:02:04] Running: ln -sf reference/ref.fa . 2>> snps.log
[06:02:04] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[06:02:04] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[06:02:04] Running: bwa mem  -Y -M -R '@RG\tID:IP-0029-9_S9_L001-SPAdes\tSM:IP-0029-9_S9_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 574516 sequences (143629000 bp)...
[M::mem_process_seqs] Processed 574516 reads in 56.215 CPU sec, 3.673 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0029-9_S9_L001-SPAdes\tSM:IP-0029-9_S9_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq
[main] Real time: 5.804 sec; CPU: 57.337 sec
[samclip] Total SAM records 579492, removed 12777, allowed 7994, passed 566715
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[06:02:11] Running: samtools index snps.bam 2>> snps.log
[06:02:12] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[06:02:12] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[06:02:15] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 119
          no. right trimmed                     : 1363
          no. left and right trimmed            : 79
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1561

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1561
       total no. variants observed              : 19708
       total no. reference observed             : 0

Time elapsed: 0.20s

[06:02:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[06:02:15] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[06:02:15] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[06:02:16] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[06:02:16] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[06:02:16] Running: bcftools consensus --sample IP-0029-9_S9_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[06:02:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[06:02:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[06:02:17] Running: bcftools consensus --sample IP-0029-9_S9_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[06:02:18] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[06:02:18] Running: rm -f fake_reads\.fq 2>> snps.log
[06:02:18] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[06:02:24] Marked 3844 heterozygous sites with 'n'
[06:02:24] Creating extra output files: BED GFF CSV TXT HTML
[06:02:24] Identified 19708 variants.
[06:02:24] Result folder: snippy_work/IP-0029-9_S9_L001-SPAdes
[06:02:24] Result files:
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.aligned.fa
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.bam
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.bam.bai
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.bed
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.consensus.fa
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.consensus.subs.fa
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.csv
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.filt.vcf
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.gff
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.html
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.log
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.raw.vcf
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.subs.vcf
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.tab
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.txt
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.vcf
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.vcf.gz
[06:02:24] * snippy_work/IP-0029-9_S9_L001-SPAdes/snps.vcf.gz.csi
[06:02:24] Walltime used: 26 seconds
[06:02:24] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[06:02:24] Done.
[06:02:24] This is snippy 4.6.0
[06:02:24] Written by Torsten Seemann
[06:02:24] Obtained from https://github.com/tseemann/snippy
[06:02:24] Detected operating system: linux
[06:02:24] Enabling bundled linux tools.
[06:02:24] Found bwa - /snippy-4.6.0/binaries/linux/bwa
[06:02:24] Found bcftools - /snippy-4.6.0/binaries/linux/bcftools
[06:02:24] Found samtools - /snippy-4.6.0/binaries/linux/samtools
[06:02:24] Found java - /usr/bin/java
[06:02:24] Found snpEff - /snippy-4.6.0/binaries/noarch/snpEff
[06:02:24] Found samclip - /snippy-4.6.0/binaries/noarch/samclip
[06:02:24] Found seqtk - /snippy-4.6.0/binaries/linux/seqtk
[06:02:24] Found parallel - /snippy-4.6.0/binaries/noarch/parallel
[06:02:24] Found freebayes - /snippy-4.6.0/binaries/linux/freebayes
[06:02:24] Found freebayes-parallel - /snippy-4.6.0/binaries/noarch/freebayes-parallel
[06:02:24] Found fasta_generate_regions.py - /snippy-4.6.0/binaries/noarch/fasta_generate_regions.py
[06:02:24] Found vcfstreamsort - /snippy-4.6.0/binaries/linux/vcfstreamsort
[06:02:24] Found vcfuniq - /snippy-4.6.0/binaries/linux/vcfuniq
[06:02:24] Found vcffirstheader - /snippy-4.6.0/binaries/noarch/vcffirstheader
[06:02:24] Found gzip - /bin/gzip
[06:02:24] Found vt - /snippy-4.6.0/binaries/linux/vt
[06:02:24] Found snippy-vcf_to_tab - /snippy-4.6.0/bin/snippy-vcf_to_tab
[06:02:24] Found snippy-vcf_report - /snippy-4.6.0/bin/snippy-vcf_report
[06:02:24] Checking version: samtools --version is >= 1.7 - ok, have 1.10
[06:02:24] Checking version: bcftools --version is >= 1.7 - ok, have 1.10
[06:02:24] Checking version: freebayes --version is >= 1.1 - ok, have 1.3.1
[06:02:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[06:02:25] Checking version: bwa is >= 0.7.12 - ok, have 0.7.17
[06:02:25] Using reference: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[06:02:25] Treating reference as 'fasta' format.
[06:02:25] Will use 16 CPU cores.
[06:02:25] Using read file: /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa
[06:02:25] Creating folder: snippy_work/IP-0030-7_S10_L001-SPAdes
[06:02:25] Changing working directory: snippy_work/IP-0030-7_S10_L001-SPAdes
[06:02:25] Creating reference folder: reference
[06:02:25] Extracting FASTA and GFF from reference.
[06:02:25] Wrote 205 sequences to ref.fa
[06:02:25] Wrote 0 features to ref.gff
[06:02:25] Shredding /home/cdcadmin/wf-assembly-snps-mod/work/73/b0327fbf73b6cd89fc5ddc3daa9725/IP-0030-7_S10_L001-SPAdes.fa into pseudo-reads
[06:02:29] Wrote 574932 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[06:02:29] Freebayes will process 31 chunks of 232459 bp, 16 chunks at a time.
[06:02:29] Using BAM RG (Read Group) ID: IP-0030-7_S10_L001-SPAdes
[06:02:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[06:02:29] Running: bwa index reference/ref.fa 2>> snps.log
[06:02:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[06:02:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[06:02:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[06:02:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[06:02:31] Running: bwa mem  -Y -M -R '@RG\tID:IP-0030-7_S10_L001-SPAdes\tSM:IP-0030-7_S10_L001-SPAdes' -t 16 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 7 -m 1000M | samtools fixmate -m --threads 7 - - | samtools sort -l 0 -T /tmp --threads 7 -m 1000M | samtools markdup -T /tmp --threads 7 -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.4.0 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 205 sequences in reference/ref.fa.fai
[M::process] read 574932 sequences (143733000 bp)...
[M::mem_process_seqs] Processed 574932 reads in 33.732 CPU sec, 2.356 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 500000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:IP-0030-7_S10_L001-SPAdes\tSM:IP-0030-7_S10_L001-SPAdes -t 16 reference/ref.fa fake_reads.fq[samclip] Total SAM records 574932, removed 0, allowed 0, passed 574932

[main] Real time: 4.535 sec; CPU: 34.940 sec
[samclip] Header contained 207 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[bam_sort_core] merging from 0 files and 7 in-memory blocks...
[06:02:37] Running: samtools index snps.bam 2>> snps.log
[06:02:38] Running: fasta_generate_regions.py reference/ref.fa.fai 232459 > reference/ref.txt 2>> snps.log
[06:02:38] Running: freebayes-parallel reference/ref.txt 16 -p 2 -P 0 -C 2 -F 0.05 --min-coverage 10 --min-repeat-entropy 1.0 -q 13 -m 60 --strict-vcf   -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[06:02:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [m] no fail on masked reference inconsistency       false
         [n] no fail on reference inconsistency              false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 0

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 0
       total no. variants observed              : 0
       total no. reference observed             : 0

Time elapsed: 0.00s

[06:02:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[06:02:39] Running: /snippy-4.6.0/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[06:02:39] Running: /snippy-4.6.0/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[06:02:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[06:02:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[06:02:39] Running: bcftools consensus --sample IP-0030-7_S10_L001-SPAdes -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[06:02:39] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[06:02:39] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[06:02:39] Running: bcftools consensus --sample IP-0030-7_S10_L001-SPAdes -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[06:02:39] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[06:02:39] Running: rm -f fake_reads\.fq 2>> snps.log
[06:02:40] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[06:02:46] Marked 0 heterozygous sites with 'n'
[06:02:46] Creating extra output files: BED GFF CSV TXT HTML
[06:02:46] Identified 0 variants.
[06:02:46] Result folder: snippy_work/IP-0030-7_S10_L001-SPAdes
[06:02:46] Result files:
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.aligned.fa
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.bam
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.bam.bai
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.bed
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.consensus.fa
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.consensus.subs.fa
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.csv
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.filt.vcf
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.gff
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.html
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.log
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.raw.vcf
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.subs.vcf
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.tab
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.txt
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.vcf
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.vcf.gz
[06:02:46] * snippy_work/IP-0030-7_S10_L001-SPAdes/snps.vcf.gz.csi
[06:02:46] Walltime used: 22 seconds
[06:02:46] May the SNPs be with you.
[06:02:46] Done.
This is snippy-core 4.6.0
Obtained from http://github.com/tseemann/snippy
Enabling bundled tools for linux
Found any2fasta - /snippy-4.6.0/binaries/noarch/any2fasta
Found samtools - /snippy-4.6.0/binaries/linux/samtools
Found minimap2 - /snippy-4.6.0/binaries/linux/minimap2
Found bedtools - /snippy-4.6.0/binaries/linux/bedtools
Found snp-sites - /snippy-4.6.0/binaries/linux/snp-sites
Saving reference FASTA: cluster_2.ref.fa
This is any2fasta 0.4.2
Opening 'IP-0030-7_S10_L001-SPAdes.fa'
Detected FASTA format
Read 88828 lines from 'IP-0030-7_S10_L001-SPAdes.fa'
Wrote 205 sequences from FASTA file.
Processed 1 files.
Done.
Loaded 205 sequences totalling 7081864 bp.
Will mask 0 regions totalling 0 bp ~ 0.00%
0	IE-0003_S8_L001-SPAdes	snp=20503	del=7449	ins=5420	het=4543	unaligned=286227
1	IE-0004_S9_L001-SPAdes	snp=15953	del=6164	ins=4310	het=3836	unaligned=336917
2	IE-0005_S10_L001-SPAdes	snp=17973	del=5970	ins=4908	het=3788	unaligned=257004
3	IE-0006_S11_L001-SPAdes	snp=19332	del=6674	ins=5025	het=3616	unaligned=262373
4	IE-0007_S1_L001-SPAdes	snp=19446	del=7034	ins=5297	het=3383	unaligned=271702
5	IE-0009_S3_L001-SPAdes	snp=18496	del=6402	ins=5528	het=3583	unaligned=286956
6	IE-0010_S4_L001-SPAdes	snp=17390	del=6082	ins=4830	het=3204	unaligned=252112
7	IE-0011_S5_L001-SPAdes	snp=19916	del=7344	ins=5126	het=3946	unaligned=268637
8	IE-0012_S6_L001-SPAdes	snp=20179	del=7259	ins=5381	het=3727	unaligned=241792
9	IE-0013_S7_L001-SPAdes	snp=10715	del=4578	ins=3401	het=4040	unaligned=97240
10	IE-0014_S8_L001-SPAdes	snp=20164	del=7097	ins=5256	het=4042	unaligned=242518
11	IE-0015_S9_L001-SPAdes	snp=10489	del=4782	ins=3304	het=3772	unaligned=167614
12	IE-0016_S10_L001-SPAdes	snp=16752	del=6371	ins=4416	het=3993	unaligned=191724
13	IE-0017_S11_L001-SPAdes	snp=17996	del=6182	ins=5046	het=3915	unaligned=255026
14	IE-0018_S12_L001-SPAdes	snp=11880	del=5013	ins=3914	het=3789	unaligned=151832
15	IE-0019_S5-SPAdes	snp=11123	del=4669	ins=3295	het=3823	unaligned=174294
16	IE-0021_S7-SPAdes	snp=17290	del=6098	ins=4665	het=3363	unaligned=241492
17	IE-0022_S8-SPAdes	snp=11177	del=4754	ins=3457	het=3892	unaligned=173028
18	IE-0024_S10-SPAdes	snp=20071	del=7104	ins=5247	het=3401	unaligned=245029
19	IE-0026_S8-SPAdes	snp=5412	del=2663	ins=1964	het=3917	unaligned=53195
20	IP-0001-8_S1_L001-SPAdes	snp=20365	del=7676	ins=5017	het=4309	unaligned=292554
21	IP-0002-6_S2_L001-SPAdes	snp=18627	del=6787	ins=5180	het=3854	unaligned=467543
22	IP-0003-4_S3_L001-SPAdes	snp=19950	del=7276	ins=5399	het=4452	unaligned=243234
23	IP-0004-2_S4_L001-SPAdes	snp=20255	del=7085	ins=5307	het=3271	unaligned=255807
24	IP-0005-9_S5_L001-SPAdes	snp=3357	del=1980	ins=1285	het=3612	unaligned=77008
25	IP-0006-7_S6_L001-SPAdes	snp=19294	del=6544	ins=4706	het=3615	unaligned=284819
26	IP-0007-5_S7_L001-SPAdes	snp=20420	del=7516	ins=5262	het=4254	unaligned=286738
27	IP-0008-3_S8_L001-SPAdes	snp=19182	del=6883	ins=5080	het=3605	unaligned=269069
28	IP-0009-1_S9_L001-SPAdes	snp=17945	del=6595	ins=4848	het=3498	unaligned=429171
29	IP-0010-9_S10_L001-SPAdes	snp=20147	del=7123	ins=5006	het=4203	unaligned=305816
30	IP-0011-7_S2_L001-SPAdes	snp=14357	del=5521	ins=4085	het=4370	unaligned=177255
31	IP-0012-5_S3_L001-SPAdes	snp=15865	del=6052	ins=4609	het=4685	unaligned=250496
32	IP-0013-3_S4_L001-SPAdes	snp=16981	del=6229	ins=4106	het=3903	unaligned=176218
33	IP-0014-1_S5_L001-SPAdes	snp=10994	del=4620	ins=3280	het=3356	unaligned=99273
34	IP-0015-8_S6_L001-SPAdes	snp=12127	del=5262	ins=3715	het=3743	unaligned=163645
35	IP-0016-6_S7_L001-SPAdes	snp=16666	del=6146	ins=4492	het=4758	unaligned=183758
36	IP-0017-4_S8_L001-SPAdes	snp=17902	del=6481	ins=4967	het=4343	unaligned=219847
37	IP-0018-2_S9_L001-SPAdes	snp=10412	del=4267	ins=3064	het=4031	unaligned=99399
38	IP-0019-0_S10_L001-SPAdes	snp=6829	del=3008	ins=2011	het=3477	unaligned=244142
39	IP-0020-8_S11_L001-SPAdes	snp=17430	del=6557	ins=4700	het=3444	unaligned=234596
40	IP-0021-6_S1_L001-SPAdes	snp=10741	del=4360	ins=3182	het=3842	unaligned=98449
41	IP-0022-4_S2_L001-SPAdes	snp=16371	del=6385	ins=4164	het=4224	unaligned=236698
42	IP-0023-2_S3_L001-SPAdes	snp=18479	del=5888	ins=4654	het=4177	unaligned=233841
43	IP-0024-0_S4_L001-SPAdes	snp=20764	del=7604	ins=5134	het=4449	unaligned=259246
44	IP-0025-7_S5_L001-SPAdes	snp=17170	del=6417	ins=4454	het=3738	unaligned=232160
45	IP-0026-5_S6_L001-SPAdes	snp=20341	del=7544	ins=5370	het=4385	unaligned=293360
46	IP-0027-3_S7_L001-SPAdes	snp=18019	del=6747	ins=4945	het=4748	unaligned=213819
47	IP-0028-1_S8_L001-SPAdes	snp=17788	del=6294	ins=4790	het=3715	unaligned=201804
48	IP-0029-9_S9_L001-SPAdes	snp=19660	del=7332	ins=5511	het=3844	unaligned=268647
49	IP-0030-7_S10_L001-SPAdes	snp=0	del=0	ins=0	het=0	unaligned=9077
Opening: cluster_2.tab
Opening: cluster_2.vcf
Processing contig: IP-0030-7_S10_L001-SPAdes_1
Processing contig: IP-0030-7_S10_L001-SPAdes_2
Processing contig: IP-0030-7_S10_L001-SPAdes_3
Processing contig: IP-0030-7_S10_L001-SPAdes_4
Processing contig: IP-0030-7_S10_L001-SPAdes_5
Processing contig: IP-0030-7_S10_L001-SPAdes_6
Processing contig: IP-0030-7_S10_L001-SPAdes_7
Processing contig: IP-0030-7_S10_L001-SPAdes_8
Processing contig: IP-0030-7_S10_L001-SPAdes_9
Processing contig: IP-0030-7_S10_L001-SPAdes_10
Processing contig: IP-0030-7_S10_L001-SPAdes_11
Processing contig: IP-0030-7_S10_L001-SPAdes_12
Processing contig: IP-0030-7_S10_L001-SPAdes_13
Processing contig: IP-0030-7_S10_L001-SPAdes_14
Processing contig: IP-0030-7_S10_L001-SPAdes_15
Processing contig: IP-0030-7_S10_L001-SPAdes_16
Processing contig: IP-0030-7_S10_L001-SPAdes_17
Processing contig: IP-0030-7_S10_L001-SPAdes_18
Processing contig: IP-0030-7_S10_L001-SPAdes_19
Processing contig: IP-0030-7_S10_L001-SPAdes_20
Processing contig: IP-0030-7_S10_L001-SPAdes_21
Processing contig: IP-0030-7_S10_L001-SPAdes_22
Processing contig: IP-0030-7_S10_L001-SPAdes_23
Processing contig: IP-0030-7_S10_L001-SPAdes_24
Processing contig: IP-0030-7_S10_L001-SPAdes_25
Processing contig: IP-0030-7_S10_L001-SPAdes_26
Processing contig: IP-0030-7_S10_L001-SPAdes_27
Processing contig: IP-0030-7_S10_L001-SPAdes_28
Processing contig: IP-0030-7_S10_L001-SPAdes_29
Processing contig: IP-0030-7_S10_L001-SPAdes_30
Processing contig: IP-0030-7_S10_L001-SPAdes_31
Processing contig: IP-0030-7_S10_L001-SPAdes_32
Processing contig: IP-0030-7_S10_L001-SPAdes_33
Processing contig: IP-0030-7_S10_L001-SPAdes_34
Processing contig: IP-0030-7_S10_L001-SPAdes_35
Processing contig: IP-0030-7_S10_L001-SPAdes_36
Processing contig: IP-0030-7_S10_L001-SPAdes_37
Processing contig: IP-0030-7_S10_L001-SPAdes_38
Processing contig: IP-0030-7_S10_L001-SPAdes_39
Processing contig: IP-0030-7_S10_L001-SPAdes_40
Processing contig: IP-0030-7_S10_L001-SPAdes_41
Processing contig: IP-0030-7_S10_L001-SPAdes_42
Processing contig: IP-0030-7_S10_L001-SPAdes_43
Processing contig: IP-0030-7_S10_L001-SPAdes_44
Processing contig: IP-0030-7_S10_L001-SPAdes_45
Processing contig: IP-0030-7_S10_L001-SPAdes_46
Processing contig: IP-0030-7_S10_L001-SPAdes_47
Processing contig: IP-0030-7_S10_L001-SPAdes_48
Processing contig: IP-0030-7_S10_L001-SPAdes_49
Processing contig: IP-0030-7_S10_L001-SPAdes_50
Processing contig: IP-0030-7_S10_L001-SPAdes_51
Processing contig: IP-0030-7_S10_L001-SPAdes_52
Processing contig: IP-0030-7_S10_L001-SPAdes_53
Processing contig: IP-0030-7_S10_L001-SPAdes_54
Processing contig: IP-0030-7_S10_L001-SPAdes_55
Processing contig: IP-0030-7_S10_L001-SPAdes_56
Processing contig: IP-0030-7_S10_L001-SPAdes_57
Processing contig: IP-0030-7_S10_L001-SPAdes_58
Processing contig: IP-0030-7_S10_L001-SPAdes_59
Processing contig: IP-0030-7_S10_L001-SPAdes_60
Processing contig: IP-0030-7_S10_L001-SPAdes_61
Processing contig: IP-0030-7_S10_L001-SPAdes_62
Processing contig: IP-0030-7_S10_L001-SPAdes_63
Processing contig: IP-0030-7_S10_L001-SPAdes_64
Processing contig: IP-0030-7_S10_L001-SPAdes_65
Processing contig: IP-0030-7_S10_L001-SPAdes_66
Processing contig: IP-0030-7_S10_L001-SPAdes_67
Processing contig: IP-0030-7_S10_L001-SPAdes_68
Processing contig: IP-0030-7_S10_L001-SPAdes_69
Processing contig: IP-0030-7_S10_L001-SPAdes_70
Processing contig: IP-0030-7_S10_L001-SPAdes_71
Processing contig: IP-0030-7_S10_L001-SPAdes_72
Processing contig: IP-0030-7_S10_L001-SPAdes_73
Processing contig: IP-0030-7_S10_L001-SPAdes_74
Processing contig: IP-0030-7_S10_L001-SPAdes_75
Processing contig: IP-0030-7_S10_L001-SPAdes_76
Processing contig: IP-0030-7_S10_L001-SPAdes_77
Processing contig: IP-0030-7_S10_L001-SPAdes_78
Processing contig: IP-0030-7_S10_L001-SPAdes_79
Processing contig: IP-0030-7_S10_L001-SPAdes_80
Processing contig: IP-0030-7_S10_L001-SPAdes_81
Processing contig: IP-0030-7_S10_L001-SPAdes_82
Processing contig: IP-0030-7_S10_L001-SPAdes_83
Processing contig: IP-0030-7_S10_L001-SPAdes_84
Processing contig: IP-0030-7_S10_L001-SPAdes_85
Processing contig: IP-0030-7_S10_L001-SPAdes_86
Processing contig: IP-0030-7_S10_L001-SPAdes_87
Processing contig: IP-0030-7_S10_L001-SPAdes_88
Processing contig: IP-0030-7_S10_L001-SPAdes_89
Processing contig: IP-0030-7_S10_L001-SPAdes_90
Processing contig: IP-0030-7_S10_L001-SPAdes_91
Processing contig: IP-0030-7_S10_L001-SPAdes_92
Processing contig: IP-0030-7_S10_L001-SPAdes_93
Processing contig: IP-0030-7_S10_L001-SPAdes_94
Processing contig: IP-0030-7_S10_L001-SPAdes_95
Processing contig: IP-0030-7_S10_L001-SPAdes_96
Processing contig: IP-0030-7_S10_L001-SPAdes_97
Processing contig: IP-0030-7_S10_L001-SPAdes_98
Processing contig: IP-0030-7_S10_L001-SPAdes_99
Processing contig: IP-0030-7_S10_L001-SPAdes_100
Processing contig: IP-0030-7_S10_L001-SPAdes_101
Processing contig: IP-0030-7_S10_L001-SPAdes_102
Processing contig: IP-0030-7_S10_L001-SPAdes_103
Processing contig: IP-0030-7_S10_L001-SPAdes_104
Processing contig: IP-0030-7_S10_L001-SPAdes_105
Processing contig: IP-0030-7_S10_L001-SPAdes_106
Processing contig: IP-0030-7_S10_L001-SPAdes_107
Processing contig: IP-0030-7_S10_L001-SPAdes_108
Processing contig: IP-0030-7_S10_L001-SPAdes_109
Processing contig: IP-0030-7_S10_L001-SPAdes_110
Processing contig: IP-0030-7_S10_L001-SPAdes_111
Processing contig: IP-0030-7_S10_L001-SPAdes_112
Processing contig: IP-0030-7_S10_L001-SPAdes_113
Processing contig: IP-0030-7_S10_L001-SPAdes_114
Processing contig: IP-0030-7_S10_L001-SPAdes_115
Processing contig: IP-0030-7_S10_L001-SPAdes_116
Processing contig: IP-0030-7_S10_L001-SPAdes_117
Processing contig: IP-0030-7_S10_L001-SPAdes_118
Processing contig: IP-0030-7_S10_L001-SPAdes_119
Processing contig: IP-0030-7_S10_L001-SPAdes_120
Processing contig: IP-0030-7_S10_L001-SPAdes_121
Processing contig: IP-0030-7_S10_L001-SPAdes_122
Processing contig: IP-0030-7_S10_L001-SPAdes_123
Processing contig: IP-0030-7_S10_L001-SPAdes_124
Processing contig: IP-0030-7_S10_L001-SPAdes_125
Processing contig: IP-0030-7_S10_L001-SPAdes_126
Processing contig: IP-0030-7_S10_L001-SPAdes_127
Processing contig: IP-0030-7_S10_L001-SPAdes_128
Processing contig: IP-0030-7_S10_L001-SPAdes_129
Processing contig: IP-0030-7_S10_L001-SPAdes_130
Processing contig: IP-0030-7_S10_L001-SPAdes_131
Processing contig: IP-0030-7_S10_L001-SPAdes_132
Processing contig: IP-0030-7_S10_L001-SPAdes_133
Processing contig: IP-0030-7_S10_L001-SPAdes_134
Processing contig: IP-0030-7_S10_L001-SPAdes_135
Processing contig: IP-0030-7_S10_L001-SPAdes_136
Processing contig: IP-0030-7_S10_L001-SPAdes_137
Processing contig: IP-0030-7_S10_L001-SPAdes_138
Processing contig: IP-0030-7_S10_L001-SPAdes_139
Processing contig: IP-0030-7_S10_L001-SPAdes_140
Processing contig: IP-0030-7_S10_L001-SPAdes_141
Processing contig: IP-0030-7_S10_L001-SPAdes_142
Processing contig: IP-0030-7_S10_L001-SPAdes_143
Processing contig: IP-0030-7_S10_L001-SPAdes_144
Processing contig: IP-0030-7_S10_L001-SPAdes_145
Processing contig: IP-0030-7_S10_L001-SPAdes_146
Processing contig: IP-0030-7_S10_L001-SPAdes_147
Processing contig: IP-0030-7_S10_L001-SPAdes_148
Processing contig: IP-0030-7_S10_L001-SPAdes_149
Processing contig: IP-0030-7_S10_L001-SPAdes_150
Processing contig: IP-0030-7_S10_L001-SPAdes_151
Processing contig: IP-0030-7_S10_L001-SPAdes_152
Processing contig: IP-0030-7_S10_L001-SPAdes_153
Processing contig: IP-0030-7_S10_L001-SPAdes_154
Processing contig: IP-0030-7_S10_L001-SPAdes_155
Processing contig: IP-0030-7_S10_L001-SPAdes_156
Processing contig: IP-0030-7_S10_L001-SPAdes_157
Processing contig: IP-0030-7_S10_L001-SPAdes_158
Processing contig: IP-0030-7_S10_L001-SPAdes_159
Processing contig: IP-0030-7_S10_L001-SPAdes_160
Processing contig: IP-0030-7_S10_L001-SPAdes_161
Processing contig: IP-0030-7_S10_L001-SPAdes_162
Processing contig: IP-0030-7_S10_L001-SPAdes_163
Processing contig: IP-0030-7_S10_L001-SPAdes_164
Processing contig: IP-0030-7_S10_L001-SPAdes_165
Processing contig: IP-0030-7_S10_L001-SPAdes_166
Processing contig: IP-0030-7_S10_L001-SPAdes_167
Processing contig: IP-0030-7_S10_L001-SPAdes_168
Processing contig: IP-0030-7_S10_L001-SPAdes_169
Processing contig: IP-0030-7_S10_L001-SPAdes_170
Processing contig: IP-0030-7_S10_L001-SPAdes_171
Processing contig: IP-0030-7_S10_L001-SPAdes_172
Processing contig: IP-0030-7_S10_L001-SPAdes_173
Processing contig: IP-0030-7_S10_L001-SPAdes_174
Processing contig: IP-0030-7_S10_L001-SPAdes_175
Processing contig: IP-0030-7_S10_L001-SPAdes_176
Processing contig: IP-0030-7_S10_L001-SPAdes_177
Processing contig: IP-0030-7_S10_L001-SPAdes_178
Processing contig: IP-0030-7_S10_L001-SPAdes_179
Processing contig: IP-0030-7_S10_L001-SPAdes_180
Processing contig: IP-0030-7_S10_L001-SPAdes_181
Processing contig: IP-0030-7_S10_L001-SPAdes_182
Processing contig: IP-0030-7_S10_L001-SPAdes_183
Processing contig: IP-0030-7_S10_L001-SPAdes_184
Processing contig: IP-0030-7_S10_L001-SPAdes_185
Processing contig: IP-0030-7_S10_L001-SPAdes_186
Processing contig: IP-0030-7_S10_L001-SPAdes_187
Processing contig: IP-0030-7_S10_L001-SPAdes_188
Processing contig: IP-0030-7_S10_L001-SPAdes_189
Processing contig: IP-0030-7_S10_L001-SPAdes_190
Processing contig: IP-0030-7_S10_L001-SPAdes_191
Processing contig: IP-0030-7_S10_L001-SPAdes_192
Processing contig: IP-0030-7_S10_L001-SPAdes_193
Processing contig: IP-0030-7_S10_L001-SPAdes_194
Processing contig: IP-0030-7_S10_L001-SPAdes_195
Processing contig: IP-0030-7_S10_L001-SPAdes_196
Processing contig: IP-0030-7_S10_L001-SPAdes_197
Processing contig: IP-0030-7_S10_L001-SPAdes_198
Processing contig: IP-0030-7_S10_L001-SPAdes_199
Processing contig: IP-0030-7_S10_L001-SPAdes_200
Processing contig: IP-0030-7_S10_L001-SPAdes_201
Processing contig: IP-0030-7_S10_L001-SPAdes_202
Processing contig: IP-0030-7_S10_L001-SPAdes_203
Processing contig: IP-0030-7_S10_L001-SPAdes_204
Processing contig: IP-0030-7_S10_L001-SPAdes_205
Generating cluster_2.full.aln
Creating TSV file: cluster_2.txt
Running: snp-sites -c -o cluster_2.aln cluster_2.full.aln
The Snippy manual is at http://github.com/tseemann/snippy/blob/master/README.md
Done.
bash: line 85: warning: here-document at line 81 delimited by end-of-file (wanted `END_VERSIONS')
